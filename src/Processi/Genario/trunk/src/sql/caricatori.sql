/* Query di Utility CARICATORE GENARIO 44444*/
/*SQL_DWH_IS_DROP_SOGG=SELECT scp.processid FROM sit_correlazione_processid scp WHERE scp.id_ente_sorg =? \
					AND data_agg_sogg IS NOT null AND scp.processid NOT IN (SELECT DISTINCT(seu.processid) from $TAB seu)

SQL_DWH_IS_DROP_OGG=SELECT scp.processid FROM sit_correlazione_processid scp WHERE scp.id_ente_sorg =? \
					AND data_agg_ogg IS NOT null AND scp.processid NOT IN (SELECT DISTINCT(seu.processid) from $TAB seu)
			
SQL_DWH_IS_DROP_CIV=SELECT scp.processid FROM sit_correlazione_processid scp WHERE scp.id_ente_sorg =? \
					AND data_agg_civico IS NOT null AND scp.processid NOT IN (SELECT DISTINCT(seu.processid) from $TAB seu)

SQL_DWH_IS_DROP_VIA=SELECT scp.processid FROM sit_correlazione_processid scp WHERE scp.id_ente_sorg =? \
					AND data_agg_via IS NOT null AND scp.processid NOT IN (SELECT DISTINCT(seu.processid) from $TAB seu)*/


SQL_DWH_IS_DROP_SOGG=SELECT DISTINCT(seu.processid) from $TAB seu \
					 WHERE seu.processid not in (SELECT scp.processid FROM sit_correlazione_processid scp \
					 WHERE scp.id_ente_sorg =? AND scp.PROG_ES = ? AND data_agg_sogg IS NOT null)

SQL_DWH_IS_DROP_OGG=SELECT DISTINCT(seu.processid) from $TAB seu \
					 WHERE seu.processid not in (SELECT scp.processid FROM sit_correlazione_processid scp \
					 WHERE scp.id_ente_sorg =? AND scp.PROG_ES = ? AND data_agg_ogg IS NOT null)					 
		
SQL_DWH_IS_DROP_CIV=SELECT DISTINCT(seu.processid) from $TAB seu \
					 WHERE seu.processid not in (SELECT scp.processid FROM sit_correlazione_processid scp \
					 WHERE scp.id_ente_sorg =? AND scp.PROG_ES = ? AND data_agg_civico IS NOT null)					 
					 
SQL_DWH_IS_DROP_VIA=SELECT DISTINCT(seu.processid) from $TAB seu \
					 WHERE seu.processid not in (SELECT scp.processid FROM sit_correlazione_processid scp \
					 WHERE scp.id_ente_sorg =? AND scp.PROG_ES = ? AND data_agg_via IS NOT null)
					 
SQL_DWH_IS_DROP_FABB=SELECT DISTINCT(seu.processid) from $TAB seu \
					 WHERE seu.processid not in (SELECT scp.processid FROM sit_correlazione_processid scp \
					 WHERE scp.id_ente_sorg =? AND scp.PROG_ES = ? AND data_agg_fabb IS NOT null)					 
					 

					
SQL_GET_ALL_PID_DWH=select distinct(PROCESSID) as prID from

/*SQL_INSERT_PID_SOGG=INSERT INTO SIT_CORRELAZIONE_PROCESSID \
					(PROCESSID, ID_ENTE_SORG, DATA_AGG_SOGG) VALUES (?,?,?)

SQL_INSERT_PID_OGG=INSERT INTO SIT_CORRELAZIONE_PROCESSID \
					(PROCESSID, ID_ENTE_SORG, DATA_AGG_OGG) VALUES (?,?,?)

SQL_INSERT_PID_CIV=INSERT INTO SIT_CORRELAZIONE_PROCESSID \
					(PROCESSID, ID_ENTE_SORG, DATA_AGG_CIVICO) VALUES (?,?,?)

SQL_INSERT_PID_VIA=INSERT INTO SIT_CORRELAZIONE_PROCESSID \
					(PROCESSID, ID_ENTE_SORG, DATA_AGG_VIA) VALUES (?,?,?)

					
SQL_UPDATE_PID_SOGG=UPDATE SIT_CORRELAZIONE_PROCESSID SET DATA_AGG_SOGG = ? WHERE PROCESSID = ?

SQL_UPDATE_PID_OGG=UPDATE SIT_CORRELAZIONE_PROCESSID SET DATA_AGG_OGG = ? WHERE PROCESSID = ?

SQL_UPDATE_PID_CIV=UPDATE SIT_CORRELAZIONE_PROCESSID SET DATA_AGG_CIVICO = ? WHERE PROCESSID = ?

SQL_UPDATE_PID_VIA=UPDATE SIT_CORRELAZIONE_PROCESSID SET DATA_AGG_VIA = ? WHERE PROCESSID = ?*/

SQL_INSERT_PID_SOGG=INSERT INTO SIT_CORRELAZIONE_PROCESSID \
					(PROCESSID, ID_ENTE_SORG, DATA_AGG_SOGG, PROG_ES) VALUES (?,?,?,?)

SQL_INSERT_PID_OGG=INSERT INTO SIT_CORRELAZIONE_PROCESSID \
					(PROCESSID, ID_ENTE_SORG, DATA_AGG_OGG, PROG_ES) VALUES (?,?,?,?)

SQL_INSERT_PID_CIV=INSERT INTO SIT_CORRELAZIONE_PROCESSID \
					(PROCESSID, ID_ENTE_SORG, DATA_AGG_CIVICO, PROG_ES) VALUES (?,?,?,?)

SQL_INSERT_PID_VIA=INSERT INTO SIT_CORRELAZIONE_PROCESSID \
					(PROCESSID, ID_ENTE_SORG, DATA_AGG_VIA, PROG_ES) VALUES (?,?,?,?)
					
SQL_INSERT_PID_FABB=INSERT INTO SIT_CORRELAZIONE_PROCESSID \
					(PROCESSID, ID_ENTE_SORG, DATA_AGG_FABB, PROG_ES) VALUES (?,?,?,?)					

					
SQL_UPDATE_PID_SOGG=UPDATE SIT_CORRELAZIONE_PROCESSID SET DATA_AGG_SOGG = ? WHERE PROCESSID = ? AND ID_ENTE_SORG = ? AND PROG_ES = ?

SQL_UPDATE_PID_OGG=UPDATE SIT_CORRELAZIONE_PROCESSID SET DATA_AGG_OGG = ? WHERE PROCESSID = ? AND ID_ENTE_SORG = ? AND PROG_ES = ?

SQL_UPDATE_PID_CIV=UPDATE SIT_CORRELAZIONE_PROCESSID SET DATA_AGG_CIVICO = ? WHERE PROCESSID = ? AND ID_ENTE_SORG = ? AND PROG_ES = ?

SQL_UPDATE_PID_VIA=UPDATE SIT_CORRELAZIONE_PROCESSID SET DATA_AGG_VIA = ? WHERE PROCESSID = ? AND ID_ENTE_SORG = ? AND PROG_ES = ?

SQL_UPDATE_PID_FABB=UPDATE SIT_CORRELAZIONE_PROCESSID SET DATA_AGG_FABB = ? WHERE PROCESSID = ? AND ID_ENTE_SORG = ? AND PROG_ES = ?


/*SQL_NEW_PID_DWH_SOGG=(SELECT 1 from SIT_CORRELAZIONE_PROCESSID pid WHERE pid.processid=tabDWH.processid AND id_ente_sorg = ? \
						AND data_agg_sogg is not null)

SQL_NEW_PID_DWH_OGG=(SELECT 1 from SIT_CORRELAZIONE_PROCESSID pid WHERE pid.processid=tabDWH.processid AND id_ente_sorg = ? \
					AND data_agg_ogg is not null)

SQL_NEW_PID_DWH_CIV=(SELECT 1 from SIT_CORRELAZIONE_PROCESSID pid WHERE pid.processid=tabDWH.processid AND id_ente_sorg = ? \
					AND data_agg_civico is not null)

SQL_NEW_PID_DWH_VIA=(SELECT 1 from SIT_CORRELAZIONE_PROCESSID pid WHERE pid.processid=tabDWH.processid AND id_ente_sorg = ? \
					AND data_agg_via is not null)*/

SQL_NEW_PID_DWH_SOGG=(SELECT 1 from SIT_CORRELAZIONE_PROCESSID pid WHERE pid.processid=tabDWH.processid AND id_ente_sorg = ? AND prog_es = ? \
						AND data_agg_sogg is not null)

SQL_NEW_PID_DWH_OGG=(SELECT 1 from SIT_CORRELAZIONE_PROCESSID pid WHERE pid.processid=tabDWH.processid AND id_ente_sorg = ? AND prog_es = ? \
					AND data_agg_ogg is not null)

SQL_NEW_PID_DWH_CIV=(SELECT 1 from SIT_CORRELAZIONE_PROCESSID pid WHERE pid.processid=tabDWH.processid AND id_ente_sorg = ? AND prog_es = ? \
					AND data_agg_civico is not null)

SQL_NEW_PID_DWH_VIA=(SELECT 1 from SIT_CORRELAZIONE_PROCESSID pid WHERE pid.processid=tabDWH.processid AND id_ente_sorg = ? AND prog_es = ? \
					AND data_agg_via is not null)

SQL_NEW_PID_DWH_FABB=(SELECT 1 from SIT_CORRELAZIONE_PROCESSID pid WHERE pid.processid=tabDWH.processid AND id_ente_sorg = ? AND prog_es = ? \
					AND data_agg_fabb is not null)
					

/*SQL_PID_EXIST=SELECT * FROM SIT_CORRELAZIONE_PROCESSID WHERE PROCESSID=? AND ID_ENTE_SORG =? AND \
			(data_agg_sogg is not null OR data_agg_ogg is not null OR data_agg_via is not null OR data_agg_civico is not null)*/
					
SQL_PID_EXIST=SELECT * FROM SIT_CORRELAZIONE_PROCESSID WHERE PROCESSID=? AND ID_ENTE_SORG =? AND PROG_ES =? AND \
			(data_agg_sogg is not null OR data_agg_ogg is not null OR data_agg_via is not null OR data_agg_civico is not null OR data_agg_fabb is not null)					
			

/*SQL_GET_PID_DWH_SOGG=select * from sit_correlazione_processid where id_ente_sorg = ? and data_agg_sogg is not null

SQL_GET_PID_DWH_OGG=select * from sit_correlazione_processid where id_ente_sorg = ? and data_agg_ogg is not null

SQL_GET_PID_DWH_CIV=select * from sit_correlazione_processid where id_ente_sorg = ? and data_agg_civico is not null

SQL_GET_PID_DWH_VIA=select * from sit_correlazione_processid where id_ente_sorg = ? and data_agg_via is not null*/

SQL_GET_PID_DWH_SOGG=select * from sit_correlazione_processid where id_ente_sorg = ? and prog_es = ? and data_agg_sogg is not null

SQL_GET_PID_DWH_OGG=select * from sit_correlazione_processid where id_ente_sorg = ? and prog_es = ? and data_agg_ogg is not null

SQL_GET_PID_DWH_CIV=select * from sit_correlazione_processid where id_ente_sorg = ? and prog_es = ? and data_agg_civico is not null

SQL_GET_PID_DWH_VIA=select * from sit_correlazione_processid where id_ente_sorg = ? and prog_es = ? and data_agg_via is not null

SQL_GET_PID_DWH_FABB=select * from sit_correlazione_processid where id_ente_sorg = ? and prog_es = ? and data_agg_fabb is not null
			
			

/*SQL_DELETE_PID_SOGG=update sit_correlazione_processid set data_agg_sogg=null where id_ente_sorg =?

SQL_DELETE_PID_OGG=update sit_correlazione_processid set data_agg_ogg=null where id_ente_sorg =?

SQL_DELETE_PID_CIV=update sit_correlazione_processid set data_agg_civico=null where id_ente_sorg =?

SQL_DELETE_PID_VIA=update sit_correlazione_processid set data_agg_via=null where id_ente_sorg =?*/

SQL_DELETE_PID_SOGG=update sit_correlazione_processid set data_agg_sogg=null where id_ente_sorg =? AND prog_es=?

SQL_DELETE_PID_OGG=update sit_correlazione_processid set data_agg_ogg=null where id_ente_sorg =? AND prog_es=?

SQL_DELETE_PID_CIV=update sit_correlazione_processid set data_agg_civico=null where id_ente_sorg =? AND prog_es=?

SQL_DELETE_PID_VIA=update sit_correlazione_processid set data_agg_via=null where id_ente_sorg =? AND prog_es=?

SQL_DELETE_PID_FABB=update sit_correlazione_processid set data_agg_fabb=null where id_ente_sorg =? AND prog_es=?


/*SQL_DELETE_ALL_PID=DELETE FROM sit_correlazione_processid WHERE id_ente_sorg =? AND data_agg_sogg IS NULL AND data_agg_ogg IS NULL \
					AND data_agg_via IS NULL AND data_agg_civico IS NULL*/
SQL_DELETE_ALL_PID=DELETE FROM sit_correlazione_processid WHERE id_ente_sorg =? AND prog_es =? AND data_agg_sogg IS NULL AND data_agg_ogg IS NULL \
					AND data_agg_via IS NULL AND data_agg_civico IS NULL AND data_agg_fabb IS NULL

					
/*SQL_DELETE_COLL_CIV=DELETE FROM sit_civico_totale WHERE id_dwh=? AND fk_ente_sorgente=? AND prog_es=? \
					AND ctr_hash NOT IN($lista)
					
SQL_AGG_CIV_DA_VIA=UPDATE SIT_CIVICO_TOTALE SET FK_CIVICO = null, FK_VIA = null, REL_DESCR=null, RATING=null WHERE ID_ORIG_VIA_TOTALE = ? AND FK_ENTE_SORGENTE = ? AND PROG_ES = ?*/					
		

					
/* Query gestione*/
SQL_ENTE_SORGENTE=SELECT ID FROM SIT_ENTE_SORGENTE \
				   WHERE ID = ?
											
/*SQL_INS_SOGG_TOTALE=INSERT INTO /*+APPEND*/  SIT_SOGGETTO_TOTALE (\
    				ID_DWH, FK_ENTE_SORGENTE,PROG_ES,CTR_HASH, COGNOME,NOME,\
    				DENOMINAZIONE,SESSO,CODFISC,PI,DT_NASCITA,\
    				TIPO_PERSONA,COD_PROVINCIA_NASCITA,COD_COMUNE_NASCITA,DESC_PROVINCIA_NASCITA,DESC_COMUNE_NASCITA,\
					COD_PROVINCIA_RES,COD_COMUNE_RES,DESC_PROVINCIA_RES,DESC_COMUNE_RES,ID_STORICO,DT_FINE_VAL,ANOMALIA,STATO,CODICE_SOGGETTO) \
					VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)*/
SQL_INS_SOGG_TOTALE=INSERT INTO /*+APPEND*/  SIT_SOGGETTO_TOTALE (\
    				ID_DWH, FK_ENTE_SORGENTE,PROG_ES,CTR_HASH, COGNOME,NOME,\
    				DENOMINAZIONE,SESSO,CODFISC,PI,DT_NASCITA,\
    				TIPO_PERSONA,COD_PROVINCIA_NASCITA,COD_COMUNE_NASCITA,DESC_PROVINCIA_NASCITA,DESC_COMUNE_NASCITA,\
					COD_PROVINCIA_RES,COD_COMUNE_RES,DESC_PROVINCIA_RES,DESC_COMUNE_RES,ID_STORICO,DT_FINE_VAL,ANOMALIA,STATO,CODICE_SOGGETTO, \
					PROCESSID,DT_INIZIO_DATO,DT_FINE_DATO,DT_EXP_DATO,PROVENIENZA,DT_INIZIO_VAL,DATA_REGISTRAZIONE,FIELD1,FIELD2,FIELD3,FIELD4,FIELD5,FIELD6, \
					FIELD7,FIELD8,FIELD9,FIELD10,FIELD11,FIELD12,FIELD13,FIELD14,FIELD15,FIELD16,FIELD17,FIELD18,FIELD19,FIELD20,FIELD21,FIELD22, \
					FIELD23,FIELD24	) \
					VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)				   
					
SQL_DEL_SOGG_TOTALE=DELETE FROM SIT_SOGGETTO_TOTALE \
				   WHERE FK_ENTE_SORGENTE = ? AND PROG_ES = ?
				   
/*SQL_UPDATE_SOGG_TOTALE=UPDATE SIT_SOGGETTO_TOTALE \
					   SET CTR_HASH=?, COGNOME=?, NOME=?, DENOMINAZIONE=?, SESSO=?, CODFISC=?, PI=?, DT_NASCITA=?, \
					   TIPO_PERSONA=?, COD_PROVINCIA_NASCITA=?, COD_COMUNE_NASCITA=?, DESC_PROVINCIA_NASCITA=?, \
					   DESC_COMUNE_NASCITA=?, COD_PROVINCIA_RES=?, COD_COMUNE_RES=?, DESC_PROVINCIA_RES=?, DESC_COMUNE_RES=?, \
					   FK_SOGGETTO=?, REL_DESCR=?, RATING=?, NOTE=?, ID_STORICO=?, DT_FINE_VAL=?, ANOMALIA=?, STATO=?, CODICE_SOGGETTO=? \
					   WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=?*/
SQL_UPDATE_SOGG_TOTALE=UPDATE SIT_SOGGETTO_TOTALE \
					   SET CTR_HASH=?, COGNOME=?, NOME=?, DENOMINAZIONE=?, SESSO=?, CODFISC=?, PI=?, DT_NASCITA=?, \
					   TIPO_PERSONA=?, COD_PROVINCIA_NASCITA=?, COD_COMUNE_NASCITA=?, DESC_PROVINCIA_NASCITA=?, \
					   DESC_COMUNE_NASCITA=?, COD_PROVINCIA_RES=?, COD_COMUNE_RES=?, DESC_PROVINCIA_RES=?, DESC_COMUNE_RES=?, \
					   FK_SOGGETTO=?, REL_DESCR=?, RATING=?, NOTE=?, ID_STORICO=?, DT_FINE_VAL=?, ANOMALIA=?, STATO=?, CODICE_SOGGETTO=?, \
					   PROCESSID=?,DT_INIZIO_DATO=?,DT_FINE_DATO=?,DT_EXP_DATO=?,PROVENIENZA=?,DT_INIZIO_VAL=?,DATA_REGISTRAZIONE=?,FIELD1=?, \
					   FIELD2=?,FIELD3=?,FIELD4=?,FIELD5=?,FIELD6=?,FIELD7=?,FIELD8=?,FIELD9=?,FIELD10=?,FIELD11=?,FIELD12=?,FIELD13=?,FIELD14=?, \
					   FIELD15=?,FIELD16=?,FIELD17=?,FIELD18=?,FIELD19=?,FIELD20=?,FIELD21=?,FIELD22=?,FIELD23=?,FIELD24=? \
					   WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=?				   

SQL_CERCA_SOGG_TOTALE=SELECT * FROM SIT_SOGGETTO_TOTALE \
						WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=?	   
					   


SQL_DEL_VIA_TOTALE=DELETE FROM SIT_VIA_TOTALE \
				   WHERE FK_ENTE_SORGENTE = ? AND PROG_ES = ?
				   

/*SQL_INS_VIA_TOTALE=INSERT INTO /*+ APPEND*/  SIT_VIA_TOTALE \
				   (ID_DWH, FK_ENTE_SORGENTE,CTR_HASH, SEDIME, INDIRIZZO, PROG_ES, NOTE,ID_STORICO,DT_FINE_VAL,ANOMALIA,STATO,CODICE_VIA) \
				   VALUES (?,?,?,?,?,?,?,?,?,?,?,?)*/
SQL_INS_VIA_TOTALE=INSERT INTO /*+ APPEND*/  SIT_VIA_TOTALE \
				   (ID_DWH, FK_ENTE_SORGENTE,CTR_HASH, SEDIME, INDIRIZZO, PROG_ES, NOTE,ID_STORICO,DT_FINE_VAL,ANOMALIA,STATO,CODICE_VIA, \
				   FIELD1,FIELD2,FIELD3,FIELD4,FIELD5,FIELD6,FIELD7,FIELD8,FIELD9,FIELD10,FIELD11 ) \
				   VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
				   
/*SQL_UPDATE_VIA_TOTALE=UPDATE SIT_VIA_TOTALE \
					   SET CTR_HASH=?, FK_VIA=?, REL_DESCR=?, RATING=?, SEDIME=?, INDIRIZZO=?, NOTE=?, ID_STORICO=?, DT_FINE_VAL=?, ANOMALIA=?, STATO=?, CODICE_VIA=? \
					   WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=?*/
SQL_UPDATE_VIA_TOTALE=UPDATE SIT_VIA_TOTALE \
					   SET CTR_HASH=?, FK_VIA=?, REL_DESCR=?, RATING=?, SEDIME=?, INDIRIZZO=?, NOTE=?, ID_STORICO=?, DT_FINE_VAL=?, ANOMALIA=?, STATO=?, CODICE_VIA=?, \
					   FIELD1=?,FIELD2=?,FIELD3=?,FIELD4=?,FIELD5=?,FIELD6=?,FIELD7=?,FIELD8=?,FIELD9=?,FIELD10=?,FIELD11=? \
					   WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=?
					   
SQL_CERCA_VIA_TOTALE=SELECT * FROM SIT_VIA_TOTALE \
						WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=?				   					   			   

/*SQL_INS_OGG_TOTALE=INSERT INTO /*+ APPEND*/  SIT_OGGETTO_TOTALE \
				   (ID_DWH, FK_ENTE_SORGENTE,CTR_HASH, PROG_ES, FOGLIO, PARTICELLA, SUB, CATEGORIA, CLASSE, RENDITA, ZONA, FOGLIO_URBANO, SUPERFICIE, SCALA, INTERNO, PIANO, DT_INIZIO_VAL, FK_OGGETTO, REL_DESCR, RATING, NOTE,ID_STORICO,DT_FINE_VAL,ANOMALIA,STATO,SEZIONE) \
				   VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)*/
SQL_INS_OGG_TOTALE=INSERT INTO /*+ APPEND*/  SIT_OGGETTO_TOTALE \
				   (ID_DWH, FK_ENTE_SORGENTE,CTR_HASH, PROG_ES, FOGLIO, PARTICELLA, SUB, CATEGORIA, CLASSE, RENDITA, ZONA, FOGLIO_URBANO, SUPERFICIE, SCALA, INTERNO, PIANO, DT_INIZIO_VAL, FK_OGGETTO, REL_DESCR, RATING, NOTE,ID_STORICO,DT_FINE_VAL,ANOMALIA,STATO,SEZIONE, \
				   PROCESSID, DT_INIZIO_DATO, DT_FINE_DATO, DT_EXP_DATO, PROVENIENZA, DATA_REGISTRAZIONE, \
				   FIELD1, FIELD2, FIELD3, FIELD4, FIELD5, FIELD6, FIELD7, FIELD8, FIELD9, FIELD10, FIELD11, FIELD12, FIELD13, FIELD14, FIELD15, \
				   FIELD16, FIELD17, FIELD18, FIELD19, FIELD20, FIELD21, FIELD22, FIELD23, FIELD24, FIELD25, FIELD26, FIELD27, FIELD28, FIELD29, FIELD30, FIELD31 ) \
				   VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)						
				   

SQL_DEL_OGG_TOTALE=DELETE FROM SIT_OGGETTO_TOTALE \
				   WHERE FK_ENTE_SORGENTE = ? and PROG_ES = ?
				   
/*SQL_UPDATE_OGG_TOTALE=UPDATE SIT_OGGETTO_TOTALE \
					   SET CTR_HASH=?, FOGLIO=?, PARTICELLA=?, SUB=?, CATEGORIA=?, CLASSE=?, RENDITA=?, ZONA=?, FOGLIO_URBANO=?, \
					   SUPERFICIE=?, SCALA=?, INTERNO=?, PIANO=?, DT_INIZIO_VAL=?, FK_OGGETTO=?, REL_DESCR=?, RATING=?, NOTE=?, \
					   ID_STORICO=?, DT_FINE_VAL=?, ANOMALIA=?, STATO=?, SEZIONE=? \
					   WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=? AND CTR_HASH=?*/
SQL_UPDATE_OGG_TOTALE=UPDATE SIT_OGGETTO_TOTALE \
					   SET CTR_HASH=?, FOGLIO=?, PARTICELLA=?, SUB=?, CATEGORIA=?, CLASSE=?, RENDITA=?, ZONA=?, FOGLIO_URBANO=?, \
					   SUPERFICIE=?, SCALA=?, INTERNO=?, PIANO=?, DT_INIZIO_VAL=?, FK_OGGETTO=?, REL_DESCR=?, RATING=?, NOTE=?, \
					   ID_STORICO=?, DT_FINE_VAL=?, ANOMALIA=?, STATO=?, SEZIONE=? \
					   PROCESSID=?, DT_INIZIO_DATO=?, DT_FINE_DATO=?, DT_EXP_DATO=?, PROVENIENZA=?, DATA_REGISTRAZIONE=?, \
					   FIELD1=?, FIELD2=?, FIELD3=?, FIELD4=?, FIELD5=?, FIELD6=?, FIELD7=?, FIELD8=?, FIELD9=?, FIELD10=?, FIELD11=?, FIELD12=?, FIELD13=?, FIELD14=?, FIELD15=?, \
					   FIELD16=?, FIELD17=?, FIELD18=?, FIELD19=?, FIELD20=?, FIELD21=?, FIELD22=?, FIELD23=?, FIELD24=?, FIELD25=?, FIELD26=?, FIELD27=?, FIELD28=?, FIELD29=?, FIELD30=?, FIELD31=? \
					   WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=? AND CTR_HASH=?				   

SQL_CERCA_OGG_TOTALE=SELECT * FROM SIT_OGGETTO_TOTALE \
						WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=? AND CTR_HASH=?
				   
						
/*SQL_INS_CIVICO_TOTALE=INSERT INTO /*+APPEND*/  SIT_CIVICO_TOTALE \
				   (ID_DWH, FK_ENTE_SORGENTE,PROG_ES,CTR_HASH, CIVICO_COMPOSTO,\
				   CIV_LIV1,CIV_LIV2,CIV_LIV3,ID_ORIG_VIA_TOTALE,ID_STORICO,DT_FINE_VAL,NOTE,ANOMALIA,STATO,CODICE_CIVICO) \
				   VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)*/
SQL_INS_CIVICO_TOTALE=INSERT INTO /*+APPEND*/  SIT_CIVICO_TOTALE \
				   (ID_DWH, FK_ENTE_SORGENTE,PROG_ES,CTR_HASH, CIVICO_COMPOSTO,\
				   CIV_LIV1,CIV_LIV2,CIV_LIV3,ID_ORIG_VIA_TOTALE,ID_STORICO,DT_FINE_VAL,NOTE,ANOMALIA,STATO,CODICE_CIVICO, \
				   FIELD1,FIELD2,FIELD3,FIELD4,FIELD5,FIELD6,FIELD7,FIELD8,FIELD9,FIELD10,FIELD11 ) \
				   VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)	
				   
SQL_DEL_CIVICO_TOTALE=DELETE FROM SIT_CIVICO_TOTALE \
				   WHERE FK_ENTE_SORGENTE = ? AND PROG_ES = ?
				   
/*SQL_UPDATE_CIV_TOTALE=UPDATE SIT_CIVICO_TOTALE \
					   SET CTR_HASH=?, FK_CIVICO=?, REL_DESCR=?, RATING=?, CIVICO_COMPOSTO=?, CIV_LIV1=?, CIV_LIV2=?, CIV_LIV3=?, ID_ORIG_VIA_TOTALE=?, \
					   ID_STORICO=?, DT_FINE_VAL=?, NOTE=?, ANOMALIA=?, STATO=?, CODICE_CIVICO=? \
					   WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=? AND CTR_HASH=?*/
SQL_UPDATE_CIV_TOTALE=UPDATE SIT_CIVICO_TOTALE \
					   SET CTR_HASH=?, FK_CIVICO=?, REL_DESCR=?, RATING=?, CIVICO_COMPOSTO=?, CIV_LIV1=?, CIV_LIV2=?, CIV_LIV3=?, ID_ORIG_VIA_TOTALE=?, \
					   ID_STORICO=?, DT_FINE_VAL=?, NOTE=?, ANOMALIA=?, STATO=?, CODICE_CIVICO=?, \
					   FIELD1=?, FIELD2=?, FIELD3=?, FIELD4=?, FIELD5=?, FIELD6=?, FIELD7=?, FIELD8=?, FIELD9=?, FIELD10=?, FIELD11=? \
					   WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=? AND CTR_HASH=?
				   
SQL_CERCA_CIV_TOTALE=SELECT * FROM SIT_CIVICO_TOTALE \
						WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=? AND CTR_HASH=?
				   				   
SQL_DELETE_COLL_CIV=DELETE FROM sit_civico_totale WHERE id_dwh=? AND fk_ente_sorgente=? AND prog_es=? \
					AND ctr_hash NOT IN($lista)
					
SQL_AGG_CIV_DA_VIA=UPDATE SIT_CIVICO_TOTALE SET FK_CIVICO = null, FK_VIA = null, REL_DESCR=null, RATING=null WHERE ID_ORIG_VIA_TOTALE = ? AND FK_ENTE_SORGENTE = ? AND PROG_ES = ?					
		


SQL_INS_FABB_TOTALE=INSERT INTO /*+ APPEND*/  SIT_FABBRICATO_TOTALE \
				   (ID_DWH, FK_ENTE_SORGENTE,CTR_HASH, PROG_ES, FOGLIO, PARTICELLA, SUBALTERNO, CATEGORIA, CLASSE, RENDITA, ZONA, FOGLIO_URBANO, SUPERFICIE, SCALA, INTERNO, PIANO, DT_INIZIO_VAL, FK_FABBRICATO, REL_DESCR, RATING, NOTE,ID_STORICO,DT_FINE_VAL,ANOMALIA,STATO,SEZIONE, \
				   PROCESSID, DT_INIZIO_DATO, DT_FINE_DATO, DT_EXP_DATO, PROVENIENZA, DATA_REGISTRAZIONE, \
				   FIELD1, FIELD2, FIELD3, FIELD4, FIELD5, FIELD6, FIELD7, FIELD8, FIELD9, FIELD10, FIELD11, FIELD12, FIELD13, FIELD14, FIELD15, \
				   FIELD16, FIELD17, FIELD18, FIELD19, FIELD20, FIELD21, FIELD22, FIELD23, FIELD24, FIELD25, FIELD26, FIELD27, FIELD28, FIELD29, FIELD30, FIELD31 ) \
				   VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

/*SQL_INS_FABB_TOTALE=INSERT INTO /*+ APPEND*/  SIT_FABBRICATO_TOTALE \
				   (ID_DWH, FK_ENTE_SORGENTE,CTR_HASH, PROG_ES, FOGLIO, PARTICELLA, CATEGORIA, CLASSE, RENDITA, ZONA, FOGLIO_URBANO, SUPERFICIE, SCALA, INTERNO, PIANO, DT_INIZIO_VAL, FK_FABBRICATO, REL_DESCR, RATING, NOTE,ID_STORICO,DT_FINE_VAL,ANOMALIA,STATO,SEZIONE, \
				   PROCESSID, DT_INIZIO_DATO, DT_FINE_DATO, DT_EXP_DATO, PROVENIENZA, DATA_REGISTRAZIONE ) \
				   VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)	*/					

				   
SQL_DEL_FABB_TOTALE=DELETE FROM SIT_FABBRICATO_TOTALE \
				   WHERE FK_ENTE_SORGENTE = ? and PROG_ES = ?
				   
SQL_UPDATE_FABB_TOTALE=UPDATE SIT_FABBRICATO_TOTALE \
					   SET CTR_HASH=?, FOGLIO=?, PARTICELLA=?, SUBALTERNO=?, CATEGORIA=?, CLASSE=?, RENDITA=?, ZONA=?, FOGLIO_URBANO=?, \
					   SUPERFICIE=?, SCALA=?, INTERNO=?, PIANO=?, DT_INIZIO_VAL=?, FK_FABBRICATO=?, REL_DESCR=?, RATING=?, NOTE=?, \
					   ID_STORICO=?, DT_FINE_VAL=?, ANOMALIA=?, STATO=?, SEZIONE=? \
					   PROCESSID=?, DT_INIZIO_DATO=?, DT_FINE_DATO=?, DT_EXP_DATO=?, PROVENIENZA=?, DATA_REGISTRAZIONE=?, \
					   FIELD1=?, FIELD2=?, FIELD3=?, FIELD4=?, FIELD5=?, FIELD6=?, FIELD7=?, FIELD8=?, FIELD9=?, FIELD10=?, FIELD11=?, FIELD12=?, FIELD13=?, FIELD14=?, FIELD15=?, \
					   FIELD16=?, FIELD17=?, FIELD18=?, FIELD19=?, FIELD20=?, FIELD21=?, FIELD22=?, FIELD23=?, FIELD24=?, FIELD25=?, FIELD26=?, FIELD27=?, FIELD28=?, FIELD29=?, FIELD30=?, FIELD31=? \
					   WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=? AND CTR_HASH=?				   

SQL_CERCA_FABB_TOTALE=SELECT * FROM SIT_FABBRICATO_TOTALE \
						WHERE ID_DWH=? AND FK_ENTE_SORGENTE=? AND PROG_ES=? AND CTR_HASH=?
	

/*#############################################################################################################################################################################################################*/
/*########################################      Query SOGGETTI      #############################################################################################################################################*/
/*#############################################################################################################################################################################################################*/
			   
/*SQL_SOGG_DEMOGRAFIA=SELECT PER.ID AS ID_DWH, PER.ID_EXT AS ID_STORICO, \
					PER.DT_INIZIO_VAL AS DT_INIZIO_VAL, \
					PER.DT_FINE_VAL AS DT_FINE_VAL, \
					PER.COGNOME AS COGNOME,\
					PER.NOME AS NOME,\
					SUBSTR (PER.COGNOME || ' ' || PER.NOME,1,150) AS DENOMINAZIONE, \
					PER.SESSO AS SESSO, \
					PER.CODFISC AS COD_FISC, \
					NULL AS PI, \
					PER.DATA_NASCITA DT_NASCITA,\
					'F' AS TIPO_PERSONA, \
					PRO1.ID_ORIG AS COD_PROVINCIA_NASCITA, \
					COM1.ID_ORIG AS COD_COMUNE_NASCITA, \
					PRO1.DESCRIZIONE AS DESC_PROVINCIA_NASCITA, \
					COM1.DESCRIZIONE AS DESC_COMUNE_NASCITA, \
					PER.POSIZ_ANA,\
			        PER.STATO_CIVILE,\
			        PER.FLAG_CODICE_FISCALE,\
			        NULL AS COD_PROVINCIA_RES,\
			        NULL AS COD_COMUNE_RES,\
			        NULL AS DESC_PROVINCIA_RES,\
			        NULL AS DESC_COMUNE_RES, PER.ID_ORIG AS CODICE_SOGGETTO \
					FROM SIT_D_PERSONA PER, \
					SIT_PROVINCIA PRO1, \
					SIT_COMUNE COM1 \
					WHERE 1 = 1 \
					AND PER.ID_EXT_PROVINCIA_NASCITA = PRO1.ID_EXT(+) \
					AND PRO1.DT_FINE_VAL IS NULL \
					AND PER.ID_EXT_COMUNE_NASCITA = COM1.ID_EXT(+) \
					AND COM1.DT_FINE_VAL IS NULL				
					
SQL_SOGG_TRIBUTI_ICI=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, DECODE(TIP_SOGG, 'F', COG_DENOM, NULL) AS COGNOME, NOME, \
					DECODE(TIP_SOGG, 'G', COG_DENOM, NULL) AS DENOMINAZIONE, SESSO, COD_FISC, \
					DECODE (PART_IVA, '0', NULL, PART_IVA) AS PI, util.fchar_to_date(DT_NSC,'dd/mm/yyyy' ) AS DT_NASCITA, \
					TIP_SOGG AS TIPO_PERSONA, NULL AS COD_PROVINCIA_NASCITA, COD_IST_CMN_NSC AS COD_COMUNE_NASCITA, DES_PROV_NSC AS DESC_PROVINCIA_NASCITA, \
					DES_COM_NSC AS DESC_COMUNE_NASCITA, DECODE(TIP_SOGG, 'G', DES_COM_RES, NULL) AS LUOGOESTERNO, \
					DECODE(TIP_SOGG, 'G', IND_RES_EXT || DECODE(NUM_CIV_EXT, NULL, '', ', ' || NUM_CIV_EXT), NULL) AS INDIRIZZOESTERNO, \
					NULL AS COD_PROVINCIA_RES, COD_IST_CMN_RES AS COD_COMUNE_RES, DES_PROV_RES AS DESC_PROVINCIA_RES, DES_COM_RES AS DESC_COMUNE_RES, \
					DT_FINE_VAL, ID_ORIG_SOGG_U CODICE_SOGGETTO \
					FROM SIT_T_ICI_SOGG 
					
SQL_SOGG_TRIBUTI_TARSU=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, DECODE(TIP_SOGG, 'F', COG_DENOM, NULL) AS COGNOME, NOME, \
					DECODE(TIP_SOGG, 'G', COG_DENOM, NULL) AS DENOMINAZIONE, SESSO, COD_FISC, \
					DECODE (PART_IVA, '0', NULL, PART_IVA) AS PI, util.fchar_to_date(DT_NSC,'dd/mm/yyyy' ) AS DT_NASCITA, \
					TIP_SOGG AS TIPO_PERSONA, NULL AS COD_PROVINCIA_NASCITA, COD_IST_CMN_NSC AS COD_COMUNE_NASCITA, DES_PROV_NSC AS DESC_PROVINCIA_NASCITA, \
					DES_COM_NSC AS DESC_COMUNE_NASCITA, DECODE(TIP_SOGG, 'G', DES_COM_RES, NULL) AS LUOGOESTERNO, \
					DECODE(TIP_SOGG, 'G', IND_RES_EXT || DECODE(NUM_CIV_EXT, NULL, '', ', ' || NUM_CIV_EXT), NULL) AS INDIRIZZOESTERNO, \
					NULL AS COD_PROVINCIA_RES, COD_IST_CMN_RES AS COD_COMUNE_RES, DES_PROV_RES AS DESC_PROVINCIA_RES, DES_COM_RES AS DESC_COMUNE_RES, \
					DT_FINE_VAL, ID_ORIG_SOGG_U CODICE_SOGGETTO \
					FROM SIT_T_TAR_SOGG					 				
							
SQL_SOGG_FORNITURE_ELETTRICHE=SELECT   ID AS ID_DWH, ID_EXT AS ID_STORICO, \
				  DT_FINE_VAL AS DT_FINE_VAL, \
                  CODICE_FISCALE AS COD_FISC, \
                  NULL AS PI, \
                  DECODE(SESSO, NULL, 'G','P') AS TIPO_PERSONA, \
                  DENOMINAZIONE AS DENOMINAZIONE, \
                  NULL AS COGNOME, \
                  NULL AS NOME, \
                  SESSO AS SESSO, \
                  UTIL.FCHAR_TO_DATE(DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA, \
                  COMUNE_NASCITA_SEDE AS DESC_COMUNE_NASCITA, \
                  NULL AS COD_COMUNE_NASCITA, \
                  NULL AS DESC_PROVINCIA_NASCITA, \
                  PROVINCIA_NASCITA_SEDE AS COD_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_RES, \
    			  NULL AS COD_COMUNE_RES, \
			  	  NULL AS DESC_PROVINCIA_RES, \
				  NULL AS DESC_COMUNE_RES \
				  FROM SIT_ENEL_UTENTE				  							  
											  
SQL_SOGG_GAS=SELECT   ID AS ID_DWH, ID_EXT AS ID_STORICO, \
				  DT_FINE_VAL AS DT_FINE_VAL, \
				  decode(g.TIPO_SOGGETTO,'Persona Fisica', g.CF_TITOLARE_UTENZA,NULL) AS COD_FISC, \
                  decode(g.TIPO_SOGGETTO,'Soggetto diverso da persona fisica', g.CF_TITOLARE_UTENZA,NULL)  AS PI, \
                  DECODE(g.TIPO_SOGGETTO,'Soggetto diverso da persona fisica', 'G','P') AS TIPO_PERSONA, \
                  G.RAGIONE_SOCIALE AS DENOMINAZIONE, \
                  G.COGNOME_UTENTE AS COGNOME, \
                  G.NOME_UTENTE AS NOME, \
                  G.SESSO AS SESSO, \
                  UTIL.FCHAR_TO_DATE(G.DATA_NASCITA , 'dd/mm/yyyy') AS DT_NASCITA, \
                  g.DESC_COMUNE_NASCITA AS DESC_COMUNE_NASCITA, \
                  NULL AS COD_COMUNE_NASCITA, \
                  NULL AS DESC_PROVINCIA_NASCITA,\
                  NULL AS COD_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_RES, \
    			  NULL AS COD_COMUNE_RES, \
			  	  NULL AS DESC_PROVINCIA_RES,\
				  NULL AS DESC_COMUNE_RES, g.SIGLA_PROV_NASCITA AS FIELD1 \
				  FROM SIT_U_GAS g				

				  
SQL_SOGG_CATASTO=SELECT SOG.PKID AS ID_DWH , NULL AS ID_STORICO, DATA_FINE AS DT_FINE_VAL, \
					SOG.CODI_FISC AS COD_FISC,\
					SOG.CODI_PIVA AS PI,\
					SOG.FLAG_PERS_FISICA AS TIPO_PERSONA,\
					DECODE (SOG.FLAG_PERS_FISICA,'G',SOG.RAGI_SOCI,NULL) AS DENOMINAZIONE,\
					DECODE (SOG.FLAG_PERS_FISICA,'P',SOG.RAGI_SOCI,NULL) AS COGNOME,\
					SOG.NOME AS NOME,\
					SOG.SESSO AS SESSO,\
					SOG.DATA_NASC AS DT_NASCITA,\
					IST.NOME AS DESC_COMUNE_NASCITA,\
					IST.ISTATC AS COD_COMUNE_NASCITA,\
					IST.ISTATP AS COD_PROVINCIA_NASCITA,\
					IST.DENO_PROV AS DESC_PROVINCIA_NASCITA,\
					NULL AS COD_PROVINCIA_RES,\
	                NULL AS COD_COMUNE_RES,\
	                NULL AS DESC_PROVINCIA_RES,\
	                NULL AS DESC_COMUNE_RES \
					FROM CONS_SOGG_TAB SOG,\
					SITICOMU_ISTAT IST \
					WHERE SOG.COMU_NASC = IST.CODI_FISC_LUNA (+) \
					AND NOT exists \
					(select 1 from sit_soggetto_totale where id_dwh = SOG.PKID and fk_ente_sorgente =? and prog_es=?)				  
											  				  
SQL_SOGG_LOCAZIONI=SELECT   LOC.UFFICIO || '|' || LOC.ANNO || '|' || LOC.SERIE || '|' || LOC.NUMERO || '|' || LOC.PROG_SOGGETTO AS ID_DWH, \
				  NULL AS ID_STORICO, NULL AS DT_FINE_VAL, \
				  DECODE (LENGTH (LOC.CODICEFISCALE),16, LOC.CODICEFISCALE,NULL) AS COD_FISC, \
				  DECODE (LENGTH (LOC.CODICEFISCALE),11, LOC.CODICEFISCALE,NULL) AS PI, \
				  DECODE(LOC.SESSO, 'S', 'G','P') AS TIPO_PERSONA, \
				  NULL AS DENOMINAZIONE, \
				  NULL AS COGNOME, \
				  NULL AS NOME, \
				  DECODE (LOC.SESSO, 'S', NULL, LOC.SESSO) AS SESSO, \
				  UTIL.FCHAR_TO_DATE(LOC.DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA, \
				  LOC.CITTA_NASCITA AS DESC_COMUNE_NASCITA, \
				  NULL AS COD_COMUNE_NASCITA, \
				  LOC.PROV_NASCITA AS DESC_PROVINCIA_NASCITA, \
				  NULL AS COD_PROVINCIA_NASCITA, \
				  NULL AS COD_PROVINCIA_RES, \
				  NULL AS COD_COMUNE_RES, \
			  	  LOC.PROV_RESIDENZA AS DESC_PROVINCIA_RES, \
				  LOC.CITTA_RESIDENZA AS DESC_COMUNE_RES \
				  FROM LOCAZIONI_B LOC \
				  WHERE  NOT exists \
                  (select 1 from sit_soggetto_totale where id_dwh = LOC.UFFICIO || '|' || LOC.ANNO || '|' || LOC.SERIE || '|' || LOC.NUMERO || '|' || LOC.PROG_SOGGETTO and fk_ente_sorgente =? and prog_es=?)				  

SQL_SOGG_CONCESSIONI=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, DT_FINE_VAL AS DT_FINE_VAL, \
					CODICE_FISCALE AS COD_FISC, PIVA AS PI, TIPO_PERSONA AS TIPO_PERSONA, \
					DENOMINAZIONE AS DENOMINAZIONE, COGNOME AS COGNOME, NOME AS NOME, \
					NULL AS SESSO, UTIL.FCHAR_TO_DATE(DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA, \
					COMUNE_NASCITA AS DESC_COMUNE_NASCITA, NULL AS COD_COMUNE_NASCITA, \
					PROV_NASCITA AS DESC_PROVINCIA_NASCITA, NULL AS COD_PROVINCIA_NASCITA, \
					COMUNE_RESIDENZA AS DESC_COMUNE_RES, NULL AS COD_COMUNE_RES, \
					PROV_RESIDENZA AS DESC_PROVINCIA_RES, NULL AS COD_PROVINCIA_RES, \
					DT_FINE_VAL AS DT_FINE_VAL, ID_ORIG AS CODICE_SOGGETTO \
					FROM SIT_C_PERSONA
					
SQL_SOGG_SUCCESSIONI_DEFUNTO=SELECT PK_ID_SUCCA AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, \
 					SUC.CF_DEFUNTO AS COD_FISC, \
 					NULL AS PI, \
 					'P' AS TIPO_PERSONA, \
 					NULL AS DENOMINAZIONE, \
 					SUC.COGNOME_DEFUNTO AS COGNOME, \
 					SUC.NOME_DEFUNTO AS NOME, \
 					SUC.SESSO AS SESSO, \
 					UTIL.FCHAR_TO_DATE(SUC.DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA, \
 					NULL AS COD_COMUNE_NASCITA, \
 					NULL AS COD_PROVINCIA_NASCITA, \
 					SUC.CITTA_NASCITA AS DESC_COMUNE_NASCITA, \
 					SUC.PROV_NASCITA AS DESC_PROVINCIA_NASCITA, \
 					NULL AS COD_PROVINCIA_RES, \
 					NULL AS COD_COMUNE_RES, \
 					SUC.CITTA_RESIDENZA AS DESC_COMUNE_RES, \
 					SUC.PROV_RESIDENZA AS DESC_PROVINCIA_RES \
 					FROM SUCCESSIONI_A SUC \
 					WHERE NOT exists \
 					(select 1 from sit_soggetto_totale where id_dwh = SUC.PK_ID_SUCCA and fk_ente_sorgente =? and prog_es=?)					
  									
SQL_SOGG_SUCCESSIONI_EREDE=SELECT PK_ID_SUCCB AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, \
			     SUC.CF_EREDE AS COD_FISC, \
			     NULL AS PI,\
			     DECODE(SESSO,'S','G','P') AS TIPO_PERSONA,\
			     SUC.DENOMINAZIONE AS DENOMINAZIONE,\
			     NULL AS COGNOME, \
			     NULL AS NOME, \
			     DECODE(SUC.SESSO,'S',NULL,SUC.SESSO) AS SESSO,\
			     UTIL.FCHAR_TO_DATE(SUC.DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA,\
			     NULL AS COD_COMUNE_NASCITA,\
			     NULL AS COD_PROVINCIA_NASCITA,\
			     SUC.CITTA_NASCITA AS DESC_COMUNE_NASCITA,\
			     SUC.PROV_NASCITA AS DESC_PROVINCIA_NASCITA,\
			     NULL AS COD_PROVINCIA_RES,\
			     NULL AS COD_COMUNE_RES,\
			     SUC.CITTA_RESIDENZA AS DESC_COMUNE_RES,\
			     SUC.PROV_RESIDENZA AS DESC_PROVINCIA_RES \
				 FROM SUCCESSIONI_B SUC \
				 WHERE NOT exists \
				 (select 1 from sit_soggetto_totale where id_dwh = SUC.PK_ID_SUCCB and fk_ente_sorgente =? and prog_es=?)				  
  										
SQL_SOGG_LIC_COMM=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, DT_FINE_VAL AS DT_FINE_VAL, CODICE_FISCALE AS COD_FISC, \
					NULL AS PI, NULL AS TIPO_PERSONA, DENOMINAZIONE AS DENOMINAZIONE, NULL AS COGNOME, NULL AS NOME, \
					NULL AS SESSO, UTIL.FCHAR_TO_DATE(DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA, NULL AS DESC_COMUNE_NASCITA, \
					COMUNE_NASCITA AS COD_COMUNE_NASCITA, NULL AS DESC_PROVINCIA_NASCITA, PROVINCIA_NASCITA AS COD_PROVINCIA_NASCITA, \
					NULL AS DESC_PROVINCIA_RES, PROVINCIA_RESIDENZA AS COD_PROVINCIA_RES, NULL AS DESC_COMUNE_RES, \
					COMUNE_RESIDENZA AS COD_COMUNE_RES, ID_ORIG AS CODICE_SOGGETTO \
					FROM SIT_LICENZE_COMMERCIO_ANAG				 
	
SQL_SOGG_REDDITI_DICHIARANTE=SELECT IDE_TELEMATICO || '|' || CODICE_FISCALE_DIC AS ID_DWH, NULL AS ID_STORICO, \
				 NULL AS DT_FINE_VAL, CODICE_FISCALE_DIC AS COD_FISC, NULL AS PI, FLAG_PERSONA AS TIPO_PERSONA,  DENOMINAZIONE AS DENOMINAZIONE, \
				 COGNOME AS COGNOME, NOME AS NOME, SESSO AS SESSO, UTIL.FCHAR_TO_DATE(DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA, \
				 COMUNE_NASCITA AS COD_COMUNE_NASCITA, NULL AS COD_PROVINCIA_NASCITA, NULL AS DESC_COMUNE_NASCITA, NULL AS DESC_PROVINCIA_NASCITA, \
				 NULL AS COD_PROVINCIA_RES, NULL AS COD_COMUNE_RES, NULL AS DESC_COMUNE_RES, NULL AS DESC_PROVINCIA_RES \
				 FROM RED_DATI_ANAGRAFICI \
				 WHERE NOT exists (SELECT 1 FROM sit_soggetto_totale WHERE id_dwh = IDE_TELEMATICO || '|' ||   CODICE_FISCALE_DIC AND fk_ente_sorgente =? AND prog_es=?)	
					
SQL_SOGG_DOCFA_TECNICO=SELECT fornitura || '|' || PROTOCOLLO_REG AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, DIC_COGNOME AS COGNOME, DIC_NOME NOME, NULL AS DENOMINAZIONE, \
					   NULL SESSO, NULL COD_FISC, NULL AS PI, NULL AS DT_NASCITA, NULL AS TIPO_PERSONA, NULL AS COD_PROVINCIA_NASCITA, NULL AS COD_COMUNE_NASCITA, NULL AS DESC_PROVINCIA_NASCITA, \
					   NULL AS DESC_COMUNE_NASCITA, null AS LUOGOESTERNO, NULL AS INDIRIZZOESTERNO, DIC_RES_PROV AS COD_PROVINCIA_RES, DIC_RES_CAP AS COD_COMUNE_RES, DIC_RES_PROV AS DESC_PROVINCIA_RES, \
					   DIC_RES_COM AS DESC_COMUNE_RES \
					   FROM docfa_dichiaranti \
					   WHERE NOT exists (SELECT 1 FROM sit_soggetto_totale WHERE id_dwh = fornitura || '|' || PROTOCOLLO_REG AND fk_ente_sorgente =? AND prog_es=?)					 
						
SQL_SOGG_DOCFA_DICHIARANTE=SELECT fornitura || '|' || PROTOCOLLO_REG AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, TEC_COGNOME AS COGNOME, TEC_NOME NOME, NULL AS DENOMINAZIONE, NULL SESSO, TEC_CODFISC COD_FISC, \
						   decode(length(TEC_CODFISC),11,TEC_CODFISC,null) AS PI, NULL AS DT_NASCITA, NULL AS TIPO_PERSONA, NULL AS COD_PROVINCIA_NASCITA, NULL AS COD_COMUNE_NASCITA, NULL AS DESC_PROVINCIA_NASCITA, \
						   NULL AS DESC_COMUNE_NASCITA, null AS LUOGOESTERNO, NULL AS INDIRIZZOESTERNO, NULL AS COD_PROVINCIA_RES, NULL AS COD_COMUNE_RES, NULL AS DESC_PROVINCIA_RES, NULL AS DESC_COMUNE_RES \
						   FROM docfa_dichiaranti \
						   WHERE NOT exists (SELECT 1 FROM sit_soggetto_totale WHERE id_dwh = fornitura || '|' || PROTOCOLLO_REG AND fk_ente_sorgente =? AND prog_es=?)

SQL_SOGG_COMPRAVENDITE=SELECT iid AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, COGNOME AS COGNOME, NOME NOME, DENOMINAZIONE AS DENOMINAZIONE, \
					   SESSO SESSO, CODICE_FISCALE COD_FISC, CODICE_FISCALE_G AS PI, DATA_NASCITA AS DT_NASCITA, tipo_soggetto AS TIPO_PERSONA, NULL AS COD_PROVINCIA_NASCITA,\
					   luogo_nascita AS COD_COMUNE_NASCITA, NULL AS DESC_PROVINCIA_NASCITA, NULL AS DESC_COMUNE_NASCITA, null AS LUOGOESTERNO, NULL AS INDIRIZZOESTERNO, null AS COD_PROVINCIA_RES, \
					   null aS COD_COMUNE_RES, null AS DESC_PROVINCIA_RES, null AS DESC_COMUNE_RES \
					   FROM mui_soggetti \
					   WHERE NOT exists (SELECT 1 FROM sit_soggetto_totale WHERE id_dwh = iid AND fk_ente_sorgente =? AND prog_es=?)
																				
*/
						
SQL_SOGG_DEMOGRAFIA=SELECT PER.ID AS ID_DWH, PER.ID_EXT AS ID_STORICO, \
					PER.DT_INIZIO_VAL AS DT_INIZIO_VAL, \
					PER.DT_FINE_VAL AS DT_FINE_VAL, \
					PER.COGNOME AS COGNOME,\
					PER.NOME AS NOME,\
					SUBSTR (PER.COGNOME || ' ' || PER.NOME,1,150) AS DENOMINAZIONE, \
					PER.SESSO AS SESSO, \
					PER.CODFISC AS COD_FISC, \
					NULL AS PI, \
					PER.DATA_NASCITA DT_NASCITA,\
					'F' AS TIPO_PERSONA, \
					PRO1.ID_ORIG AS COD_PROVINCIA_NASCITA, \
					COM1.ID_ORIG AS COD_COMUNE_NASCITA, \
					PRO1.DESCRIZIONE AS DESC_PROVINCIA_NASCITA, \
					COM1.DESCRIZIONE AS DESC_COMUNE_NASCITA, \
					PER.POSIZ_ANA,\
			        PER.STATO_CIVILE,\
			        PER.FLAG_CODICE_FISCALE,\
			        NULL AS COD_PROVINCIA_RES,\
			        NULL AS COD_COMUNE_RES,\
			        NULL AS DESC_PROVINCIA_RES,\
			        NULL AS DESC_COMUNE_RES, PER.ID_ORIG AS CODICE_SOGGETTO, \
			        PER.PROCESSID AS PROCESSID, PER.DT_INIZIO_DATO AS DT_INIZIO_DATO, PER.DT_FINE_DATO AS DT_FINE_DATO, \
			        PER.DT_EXP_DATO AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, \
			        PER.POSIZ_ANA AS FIELD1, PER.STATO_CIVILE AS FIELD2, to_char(PER.DATA_INIZIO_RESIDENZA, 'dd/MM/yyyy') AS FIELD3, to_char(PER.DATA_IMM, 'dd/MM/yyyy') AS FIELD4, \
			        to_char(PER.DATA_EMI, 'dd/MM/yyyy') AS FIELD5, to_char(PER.DATA_MOR, 'dd/MM/yyyy') AS FIELD6, COM1.DESCRIZIONE AS FIELD7, COM1.BELFIORE AS FIELD8, \
			        PRO1.DESCRIZIONE AS FIELD9, PRO1.SIGLA AS FIELD10 \
			        FROM SIT_D_PERSONA PER, \
					SIT_PROVINCIA PRO1, \
					SIT_COMUNE COM1 \
					WHERE 1 = 1 \
					AND PER.ID_EXT_PROVINCIA_NASCITA = PRO1.ID_EXT(+) \
					AND PRO1.DT_FINE_VAL IS NULL \
					AND PER.ID_EXT_COMUNE_NASCITA = COM1.ID_EXT(+) \
					AND COM1.DT_FINE_VAL IS NULL
					/*AND PER.NOME LIKE 'ALFO%' AND PER.COGNOME = 'GEROSA'*/

					
SQL_SOGG_TRIBUTI_ICI=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, DECODE(TIP_SOGG, 'F', COG_DENOM, NULL) AS COGNOME, NOME, \
					DECODE(TIP_SOGG, 'G', COG_DENOM, NULL) AS DENOMINAZIONE, SESSO, COD_FISC, \
					DECODE (PART_IVA, '0', NULL, PART_IVA) AS PI, DT_NSC AS DT_NASCITA, \
					TIP_SOGG AS TIPO_PERSONA, NULL AS COD_PROVINCIA_NASCITA, COD_IST_CMN_NSC AS COD_COMUNE_NASCITA, DES_PROV_NSC AS DESC_PROVINCIA_NASCITA, \
					DES_COM_NSC AS DESC_COMUNE_NASCITA, DECODE(TIP_SOGG, 'G', DES_COM_RES, NULL) AS LUOGOESTERNO, \
					DECODE(TIP_SOGG, 'G', IND_RES_EXT || DECODE(NUM_CIV_EXT, NULL, '', ', ' || NUM_CIV_EXT), NULL) AS INDIRIZZOESTERNO, \
					NULL AS COD_PROVINCIA_RES, COD_IST_CMN_RES AS COD_COMUNE_RES, DES_PROV_RES AS DESC_PROVINCIA_RES, DES_COM_RES AS DESC_COMUNE_RES, \
					DT_FINE_VAL, ID_ORIG_SOGG_U CODICE_SOGGETTO, \
					PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, \
					DT_EXP_DATO AS DT_EXP_DATO, PROVENIENZA AS PROVENIENZA, TMS_AGG AS DATA_REGISTRAZIONE, DT_INIZIO_VAL AS DT_INIZIO_VAL, \
					COD_BLFR_CMN_NSC AS FIELD1, COD_STATO_NSC AS FIELD2, DES_STATO_NSC AS FIELD3, COD_BLFR_CMN_RES AS FIELD4, \
					SIGLA_PROV_RES AS FIELD5, COD_STATO_RES AS FIELD6, DES_STATO_RES AS FIELD7, DES_IND_RES AS FIELD8, \
					ID_EXT_VIA_RES AS FIELD9, NUM_CIV_RES AS FIELD10, IND_RES_EXT AS FIELD11, NUM_CIV_EXT AS FIELD12 \
					FROM SIT_T_ICI_SOGG
					/*where cod_fisc = 'BNTLBT33P44F205C'*/
					
SQL_SOGG_TRIBUTI_TARSU=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, DECODE(TIP_SOGG, 'F', COG_DENOM, NULL) AS COGNOME, NOME, \
					DECODE(TIP_SOGG, 'G', COG_DENOM, NULL) AS DENOMINAZIONE, SESSO, COD_FISC, \
					DECODE (PART_IVA, '0', NULL, PART_IVA) AS PI, DT_NSC AS DT_NASCITA, \
					TIP_SOGG AS TIPO_PERSONA, NULL AS COD_PROVINCIA_NASCITA, COD_IST_CMN_NSC AS COD_COMUNE_NASCITA, DES_PROV_NSC AS DESC_PROVINCIA_NASCITA, \
					DES_COM_NSC AS DESC_COMUNE_NASCITA, DECODE(TIP_SOGG, 'G', DES_COM_RES, NULL) AS LUOGOESTERNO, \
					DECODE(TIP_SOGG, 'G', IND_RES_EXT || DECODE(NUM_CIV_EXT, NULL, '', ', ' || NUM_CIV_EXT), NULL) AS INDIRIZZOESTERNO, \
					NULL AS COD_PROVINCIA_RES, COD_IST_CMN_RES AS COD_COMUNE_RES, DES_PROV_RES AS DESC_PROVINCIA_RES, DES_COM_RES AS DESC_COMUNE_RES, \
					DT_FINE_VAL, ID_ORIG_SOGG_U CODICE_SOGGETTO, \
					PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, \
					DT_EXP_DATO AS DT_EXP_DATO, PROVENIENZA AS PROVENIENZA, TMS_AGG AS DATA_REGISTRAZIONE, DT_INIZIO_VAL AS DT_INIZIO_VAL, \
					COD_BLFR_CMN_NSC AS FIELD1, COD_STATO_NSC AS FIELD2, DES_STATO_NSC AS FIELD3, COD_BLFR_CMN_RES AS FIELD4, \
					SIGLA_PROV_RES AS FIELD5, COD_STATO_RES AS FIELD6, DES_STATO_RES AS FIELD7, DES_IND_RES AS FIELD8, \
					ID_EXT_VIA_RES AS FIELD9, NUM_CIV_RES AS FIELD10, IND_RES_EXT AS FIELD11, NUM_CIV_EXT AS FIELD12 \
					FROM SIT_T_TAR_SOGG
					/*where cod_fisc = 'BGGRRT72S26H501D'*/ 				 				
							
SQL_SOGG_FORNITURE_ELETTRICHE=SELECT   ID AS ID_DWH, ID_EXT AS ID_STORICO, \
				  DT_FINE_VAL AS DT_FINE_VAL, \
                  CASE WHEN LENGTH(TRIM(CODICE_FISCALE))>11 THEN TRIM(CODICE_FISCALE) ELSE NULL END AS COD_FISC,\
                  CASE WHEN LENGTH(TRIM(CODICE_FISCALE))=11 THEN TRIM(CODICE_FISCALE) ELSE NULL END AS PI,\
                  CASE WHEN (LENGTH(TRIM(CODICE_FISCALE))=11) THEN 'G' ELSE 'P' END AS TIPO_PERSONA,\
                  DENOMINAZIONE AS DENOMINAZIONE, \
                  NULL AS COGNOME, \
                  NULL AS NOME, \
                  SESSO AS SESSO, \
                  DATA_NASCITA AS DT_NASCITA, \
                  COMUNE_NASCITA_SEDE AS DESC_COMUNE_NASCITA, \
                  NULL AS COD_COMUNE_NASCITA, \
                  NULL AS DESC_PROVINCIA_NASCITA, \
                  PROVINCIA_NASCITA_SEDE AS COD_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_RES, \
    			  NULL AS COD_COMUNE_RES, \
			  	  NULL AS DESC_PROVINCIA_RES, \
				  NULL AS DESC_COMUNE_RES, \
				  PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, \
				  DT_EXP_DATO AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, DT_INIZIO_VAL AS DT_INIZIO_VAL, \
				  QUALIFICA_TITOLARE AS FIELD1, COMUNE_DOM_FISCALE AS FIELD2, PROVINCIA_DOM_FISCALE AS FIELD3 \
				  FROM SIT_ENEL_UTENTE				  							  
											  
SQL_SOGG_GAS=SELECT   ID AS ID_DWH, ID_EXT AS ID_STORICO, \
				  DT_FINE_VAL AS DT_FINE_VAL, \
				  decode(g.TIPO_SOGGETTO,'Persona Fisica', g.CF_TITOLARE_UTENZA,NULL) AS COD_FISC, \
                  decode(g.TIPO_SOGGETTO,'Soggetto diverso da persona fisica', g.CF_TITOLARE_UTENZA,NULL)  AS PI, \
                  DECODE(g.TIPO_SOGGETTO,'Soggetto diverso da persona fisica', 'G','P') AS TIPO_PERSONA, \
                  G.RAGIONE_SOCIALE AS DENOMINAZIONE, \
                  G.COGNOME_UTENTE AS COGNOME, \
                  G.NOME_UTENTE AS NOME, \
                  G.SESSO AS SESSO, \
                  UTIL.FCHAR_TO_DATE(G.DATA_NASCITA , 'dd/mm/yyyy') AS DT_NASCITA, \
                  g.DESC_COMUNE_NASCITA AS DESC_COMUNE_NASCITA, \
                  NULL AS COD_COMUNE_NASCITA, \
                  NULL AS DESC_PROVINCIA_NASCITA,\
                  NULL AS COD_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_RES, \
    			  NULL AS COD_COMUNE_RES, \
			  	  NULL AS DESC_PROVINCIA_RES,\
				  NULL AS DESC_COMUNE_RES, \
				  G.PROCESSID AS PROCESSID, G.DT_INIZIO_DATO AS DT_INIZIO_DATO, G.DT_FINE_DATO AS DT_FINE_DATO, \
				  G.DT_EXP_DATO AS DT_EXP_DATO, G.PROVENIENZA AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, G.DT_INIZIO_VAL AS DT_INIZIO_VAL, \
				  G.TIPOLOGIA_FORNITURA AS FIELD1, G.ANNO_RIFERIMENTO AS FIELD2, G.CODICE_CATASTALE_UTENZA AS FIELD3, G.CF_EROGANTE AS FIELD4, \
				  G.SIGLA_PROV_NASCITA AS FIELD5, G.IDENTIFICATIVO_UTENZA AS FIELD6, G.TIPO_UTENZA AS FIELD7, G.INDIRIZZO_UTENZA AS FIELD8, \
				  G.CAP_UTENZA AS FIELD9, G.SPESA_CONSUMO_NETTO_IVA AS FIELD10, G.N_MESI_FATTURAZIONE AS FIELD11 \
				  FROM SIT_U_GAS g				

				  
SQL_SOGG_CATASTO=SELECT SOG.PKID AS ID_DWH , NULL AS ID_STORICO, DATA_FINE AS DT_FINE_VAL, \
					SOG.CODI_FISC AS COD_FISC,\
					SOG.CODI_PIVA AS PI,\
					SOG.FLAG_PERS_FISICA AS TIPO_PERSONA,\
					DECODE (SOG.FLAG_PERS_FISICA,'G',SOG.RAGI_SOCI,NULL) AS DENOMINAZIONE,\
					DECODE (SOG.FLAG_PERS_FISICA,'P',SOG.RAGI_SOCI,NULL) AS COGNOME,\
					SOG.NOME AS NOME,\
					SOG.SESSO AS SESSO,\
					SOG.DATA_NASC AS DT_NASCITA,\
					IST.NOME AS DESC_COMUNE_NASCITA,\
					IST.ISTATC AS COD_COMUNE_NASCITA,\
					IST.ISTATP AS COD_PROVINCIA_NASCITA,\
					IST.DENO_PROV AS DESC_PROVINCIA_NASCITA,\
					NULL AS COD_PROVINCIA_RES,\
	                NULL AS COD_COMUNE_RES,\
	                NULL AS DESC_PROVINCIA_RES,\
	                NULL AS DESC_COMUNE_RES, \
	                NULL AS PROCESSID, DATA_INIZIO AS DT_INIZIO_DATO, DATA_FINE AS DT_FINE_DATO, \
	                NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, DATA_REGISTRAZIONE AS DATA_REGISTRAZIONE, DATA_INIZIO AS DT_INIZIO_VAL, \
	                to_char(DATA_MORTE, 'dd/MM/yyyy') AS FIELD1, COMU_NASC AS FIELD2, RESI_COMU AS FIELD3, NATURA_GIURIDICA AS FIELD4, FLAG_PERS_FISICA AS FIELD5 \
	                FROM CONS_SOGG_TAB SOG,\
					SITICOMU_ISTAT IST \
					WHERE SOG.COMU_NASC = IST.CODI_FISC_LUNA (+) \
					AND NOT exists \
					(select 1 from sit_soggetto_totale where id_dwh = SOG.PKID and fk_ente_sorgente =? and prog_es=?)				  
											  				  
SQL_SOGG_LOCAZIONI=SELECT LOC.UFFICIO || '|' || LOC.ANNO || '|' || LOC.SERIE || '|' || LOC.NUMERO || '|' || LOC.SOTTONUMERO || '|' || LOC.PROG_NEGOZIO || '|' || LOC.PROG_SOGGETTO AS ID_DWH, \
				  NULL AS ID_STORICO, NULL AS DT_FINE_VAL, \
				  CASE WHEN LENGTH(TRIM(LOC.CODICEFISCALE))>11  THEN LOC.CODICEFISCALE ELSE NULL END AS COD_FISC,\
                  CASE WHEN LENGTH(TRIM(LOC.CODICEFISCALE))<=11 THEN LOC.CODICEFISCALE ELSE NULL END AS PI,\
				  DECODE(LOC.SESSO, 'S', 'G','P') AS TIPO_PERSONA, \
				  NULL AS DENOMINAZIONE, \
				  NULL AS COGNOME, \
				  NULL AS NOME, \
				  DECODE (LOC.SESSO, 'S', NULL, LOC.SESSO) AS SESSO, \
				  UTIL.FCHAR_TO_DATE(LOC.DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA, \
				  LOC.CITTA_NASCITA AS DESC_COMUNE_NASCITA, \
				  NULL AS COD_COMUNE_NASCITA, \
				  LOC.PROV_NASCITA AS DESC_PROVINCIA_NASCITA, \
				  NULL AS COD_PROVINCIA_NASCITA, \
				  NULL AS COD_PROVINCIA_RES, \
				  NULL AS COD_COMUNE_RES, \
			  	  LOC.PROV_RESIDENZA AS DESC_PROVINCIA_RES, \
				  LOC.CITTA_RESIDENZA AS DESC_COMUNE_RES, \
				  NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, \
	              NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, NULL AS DT_INIZIO_VAL, \
	              LOC.PROV_RESIDENZA AS FIELD1, LOC.INDIRIZZO_RESIDENZA AS FIELD2, LOC.CITTA_RESIDENZA AS FIELD3, LOC.CIVICO_RESIDENZA AS FIELD4, \
				  LOC.TIPO_RECORD AS FIELD5, LOC.FORNITURA AS FIELD6, to_char(LOC.DATA_CESSIONE, 'dd/MM/yyyy') AS FIELD7, to_char(LOC.DATA_SUBENTRO, 'dd/MM/yyyy') AS FIELD8, \
				  LOC.SOTTONUMERO AS FIELD9, LOC.PROG_NEGOZIO AS FIELD10, LOC.UFFICIO AS FIELD11, LOC.ANNO AS FIELD12, \
				  LOC.SERIE AS FIELD13, LOC.NUMERO AS FIELD14, LOC.PROG_SOGGETTO AS FIELD15 \
				  FROM LOCAZIONI_B LOC \
				  WHERE  NOT exists \
				  (select 1 from sit_soggetto_totale where id_dwh = LOC.UFFICIO || '|' || LOC.ANNO || '|' || LOC.SERIE || '|' || LOC.NUMERO || '|' || LOC.SOTTONUMERO || '|' || LOC.PROG_NEGOZIO || '|' || LOC.PROG_SOGGETTO and fk_ente_sorgente =? and prog_es=?)				  

SQL_SOGG_CONCESSIONI=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, DT_FINE_VAL AS DT_FINE_VAL, \
					CODICE_FISCALE AS COD_FISC, PIVA AS PI, TIPO_PERSONA AS TIPO_PERSONA, \
					DENOMINAZIONE AS DENOMINAZIONE, COGNOME AS COGNOME, NOME AS NOME, \
					NULL AS SESSO, UTIL.FCHAR_TO_DATE(DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA, \
					COMUNE_NASCITA AS DESC_COMUNE_NASCITA, NULL AS COD_COMUNE_NASCITA, \
					PROV_NASCITA AS DESC_PROVINCIA_NASCITA, NULL AS COD_PROVINCIA_NASCITA, \
					COMUNE_RESIDENZA AS DESC_COMUNE_RES, NULL AS COD_COMUNE_RES, \
					PROV_RESIDENZA AS DESC_PROVINCIA_RES, NULL AS COD_PROVINCIA_RES, \
					DT_FINE_VAL AS DT_FINE_VAL, ID_ORIG AS CODICE_SOGGETTO, \
					PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, \
					DT_EXP_DATO AS DT_EXP_DATO, PROVENIENZA AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, DT_INIZIO_VAL AS DT_INIZIO_VAL, \
					TITOLO AS FIELD1, INDIRIZZO AS FIELD2, CAP AS FIELD3, COMUNE_RESIDENZA AS FIELD4, \
					PROV_RESIDENZA AS FIELD5, TELEFONO AS FIELD6, FAX AS FIELD7, EMAIL AS FIELD8, \
					PIVA AS FIELD9, INDIRIZZO_STUDIO AS FIELD10,CAP_STUDIO AS FIELD11, COMUNE_STUDIO AS FIELD12, PROV_STUDIO AS FIELD13, ALBO AS FIELD14, \
					RAGSOC_DITTA AS FIELD15, CF_DITTA AS FIELD16, PI_DITTA AS FIELD17, INDIRIZZO_DITTA AS FIELD18, \
					CAP_DITTA AS FIELD19, COMUNE_DITTA AS FIELD20, PROV_DITTA AS FIELD21, QUALITA AS FIELD22, CIVICO AS FIELD23, to_char(DATA_INI_RES, 'dd/MM/yyyy') AS FIELD24 \
					FROM SIT_C_PERSONA
					
SQL_SOGG_SUCCESSIONI_DEFUNTO=SELECT PK_ID_SUCCA AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, \
					SUC.CF_DEFUNTO AS COD_FISC, \
					NULL AS PI, \
					'P' AS TIPO_PERSONA, \
					NULL AS DENOMINAZIONE, \
					SUC.COGNOME_DEFUNTO AS COGNOME, \
					SUC.NOME_DEFUNTO AS NOME, \
					SUC.SESSO AS SESSO, \
					UTIL.FCHAR_TO_DATE(SUC.DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA, \
					NULL AS COD_COMUNE_NASCITA, \
					NULL AS COD_PROVINCIA_NASCITA, \
					SUC.CITTA_NASCITA AS DESC_COMUNE_NASCITA, \
					SUC.PROV_NASCITA AS DESC_PROVINCIA_NASCITA, \
					NULL AS COD_PROVINCIA_RES, \
					NULL AS COD_COMUNE_RES, \
					SUC.CITTA_RESIDENZA AS DESC_COMUNE_RES, \
					SUC.PROV_RESIDENZA AS DESC_PROVINCIA_RES, \
					NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, \
					NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, NULL AS DT_INIZIO_VAL, \
					SUC.TIPO_DICHIARAZIONE AS FIELD1, SUC.CITTA_RESIDENZA AS FIELD2, SUC.PROV_RESIDENZA AS FIELD3, SUC.INDIRIZZO_RESIDENZA AS FIELD4, \
					SUC.UFFICIO AS FIELD5, SUC.ANNO AS FIELD6, SUC.VOLUME AS FIELD7, SUC.NUMERO AS FIELD8, SUC.SOTTONUMERO AS FIELD9, \
					SUC.COMUNE AS FIELD10, SUC.PROGRESSIVO AS FIELD11 \
					FROM SUCCESSIONI_A SUC \
					WHERE NOT exists \
					(select 1 from sit_soggetto_totale where id_dwh = SUC.PK_ID_SUCCA and fk_ente_sorgente =? and prog_es=?)					
  									
SQL_SOGG_SUCCESSIONI_EREDE=SELECT PK_ID_SUCCB AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, \
                 CASE WHEN (NVL(SESSO,' ')<>'S' AND  LENGTH(SUC.CF_EREDE)>11) THEN SUC.CF_EREDE ELSE NULL END AS COD_FISC,\
                 CASE WHEN (SESSO='S' OR (SESSO IS NULL AND LENGTH(SUC.CF_EREDe)=11)) THEN SUC.CF_EREDE ELSE NULL END AS PI,\
                 DECODE(SESSO,'S','G','P') AS TIPO_PERSONA,\
			     SUC.DENOMINAZIONE AS DENOMINAZIONE,\
			     NULL AS COGNOME, \
			     NULL AS NOME, \
			     DECODE(SUC.SESSO,'S',NULL,SUC.SESSO) AS SESSO,\
			     UTIL.FCHAR_TO_DATE(SUC.DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA,\
			     NULL AS COD_COMUNE_NASCITA,\
			     NULL AS COD_PROVINCIA_NASCITA,\
			     SUC.CITTA_NASCITA AS DESC_COMUNE_NASCITA,\
			     SUC.PROV_NASCITA AS DESC_PROVINCIA_NASCITA,\
			     NULL AS COD_PROVINCIA_RES,\
			     NULL AS COD_COMUNE_RES,\
			     SUC.CITTA_RESIDENZA AS DESC_COMUNE_RES,\
			     SUC.PROV_RESIDENZA AS DESC_PROVINCIA_RES, \
			     NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, \
			     NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, NULL AS DT_INIZIO_VAL, \
			     SUC.CATEGORIA AS FIELD1, SUC.CITTA_RESIDENZA AS FIELD2, SUC.PROV_RESIDENZA AS FIELD3, SUC.INDIRIZZO_RESIDENZA AS FIELD4, \
			     SUC.UFFICIO AS FIELD5, SUC.ANNO AS FIELD6, SUC.VOLUME AS FIELD7, SUC.NUMERO AS FIELD8, SUC.SOTTONUMERO AS FIELD9, \
				 SUC.COMUNE AS FIELD10, SUC.PROGRESSIVO AS FIELD11 \
			     FROM SUCCESSIONI_B SUC \
				 WHERE NOT exists \
				 (select 1 from sit_soggetto_totale where id_dwh = SUC.PK_ID_SUCCB and fk_ente_sorgente =? and prog_es=?)				  
  										
SQL_SOGG_LIC_COMM=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, DT_FINE_VAL AS DT_FINE_VAL, CODICE_FISCALE AS COD_FISC, \
					NULL AS PI, NULL AS TIPO_PERSONA, DENOMINAZIONE AS DENOMINAZIONE, NULL AS COGNOME, NULL AS NOME, \
					NULL AS SESSO, UTIL.FCHAR_TO_DATE(DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA, COMUNE_NASCITA AS DESC_COMUNE_NASCITA, \
					NULL AS COD_COMUNE_NASCITA, NULL AS DESC_PROVINCIA_NASCITA, PROVINCIA_NASCITA AS COD_PROVINCIA_NASCITA, \
					NULL AS DESC_PROVINCIA_RES, PROVINCIA_RESIDENZA AS COD_PROVINCIA_RES, NULL AS DESC_COMUNE_RES, \
					COMUNE_RESIDENZA AS COD_COMUNE_RES, ID_ORIG AS CODICE_SOGGETTO, \
					PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, \
					DT_EXP_DATO AS DT_EXP_DATO, PROVENIENZA AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, DT_INIZIO_VAL AS DT_INIZIO_VAL, \
					NUMERO AS FIELD1, FORMA_GIURIDICA AS FIELD2, INDIRIZZO_RESIDENZA AS FIELD3, CIVICO_RESIDENZA AS FIELD4, \
					CAP_RESIDENZA AS FIELD5, COMUNE_RESIDENZA AS FIELD6, PROVINCIA_RESIDENZA AS FIELD7, to_char(DATA_INIZIO_RESIDENZA, 'dd/MM/yyyy') AS FIELD8, \
					TEL AS FIELD9, FAX AS FIELD10, EMAIL AS FIELD11, PIVA AS FIELD12 \
					FROM SIT_LICENZE_COMMERCIO_ANAG				 
	
SQL_SOGG_REDDITI_DICHIARANTE=SELECT IDE_TELEMATICO || '|' || CODICE_FISCALE_DIC AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL,\
				 DECODE (LENGTH (TRIM(CODICE_FISCALE_DIC)),16, TRIM(CODICE_FISCALE_DIC),NULL) AS COD_FISC,\
                 DECODE (LENGTH (TRIM(CODICE_FISCALE_DIC)),11, TRIM(CODICE_FISCALE_DIC),NULL) AS PI,\
                 DECODE(LENGTH (TRIM(CODICE_FISCALE_DIC)),11,'G','P') AS TIPO_PERSONA, DENOMINAZIONE AS DENOMINAZIONE, \
				 COGNOME AS COGNOME, NOME AS NOME, SESSO AS SESSO, UTIL.FCHAR_TO_DATE(DATA_NASCITA, 'YYYY-MM-DD') AS DT_NASCITA, \
				 COMUNE_NASCITA AS COD_COMUNE_NASCITA, NULL AS COD_PROVINCIA_NASCITA, NULL AS DESC_COMUNE_NASCITA, NULL AS DESC_PROVINCIA_NASCITA, \
				 NULL AS COD_PROVINCIA_RES, NULL AS COD_COMUNE_RES, NULL AS DESC_COMUNE_RES, NULL AS DESC_PROVINCIA_RES, \
				 NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, \
				 NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, NULL AS DT_INIZIO_VAL, \
				 ANNO_IMPOSTA AS FIELD1, SETTORE_ONLUS AS FIELD2, ONLUS AS FIELD3, STATO AS FIELD4, \
				 SITUAZIONE AS FIELD5, NATURA_GIURIDICA AS FIELD6 \
				 FROM RED_DATI_ANAGRAFICI \
				 WHERE NOT exists (SELECT 1 FROM sit_soggetto_totale WHERE id_dwh = IDE_TELEMATICO || '|' ||   CODICE_FISCALE_DIC AND fk_ente_sorgente =? AND prog_es=?)	
					
SQL_SOGG_DOCFA_TECNICO=SELECT PROTOCOLLO_REG || '|' || TO_CHAR(fornitura, 'YYYYMMDD') AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, TEC_COGNOME AS COGNOME, TEC_NOME NOME, NULL AS DENOMINAZIONE, \
					   NULL SESSO, TEC_CODFISC AS COD_FISC, decode(length(TEC_CODFISC),11,TEC_CODFISC,null) AS PI, NULL AS DT_NASCITA, NULL AS TIPO_PERSONA, NULL AS COD_PROVINCIA_NASCITA, NULL AS COD_COMUNE_NASCITA, NULL AS DESC_PROVINCIA_NASCITA, \
					   NULL AS DESC_COMUNE_NASCITA, null AS LUOGOESTERNO, NULL AS INDIRIZZOESTERNO, NULL AS COD_PROVINCIA_RES, NULL AS COD_COMUNE_RES, NULL AS DESC_PROVINCIA_RES, \
					   DIC_RES_COM AS DESC_COMUNE_RES, \
					   NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, \
					   NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, NULL AS DT_INIZIO_VAL, \
					   TEC_ISC_ALBO AS FIELD1, TEC_ISC_NUMORD AS FIELD2, TEC_ISC_PROV AS FIELD3 \
					   FROM docfa_dichiaranti \
					   WHERE NOT exists (SELECT 1 FROM sit_soggetto_totale WHERE id_dwh = PROTOCOLLO_REG || '|' || TO_CHAR(fornitura, 'YYYYMMDD') AND fk_ente_sorgente =? AND prog_es=?)					 
						
SQL_SOGG_DOCFA_DICHIARANTE=SELECT PROTOCOLLO_REG || '|' || TO_CHAR(fornitura, 'YYYYMMDD') AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, DIC_COGNOME AS COGNOME, DIC_NOME NOME, NULL AS DENOMINAZIONE, NULL SESSO, NULL COD_FISC, \
						   NULL AS PI, NULL AS DT_NASCITA, NULL AS TIPO_PERSONA, NULL AS COD_PROVINCIA_NASCITA, NULL AS COD_COMUNE_NASCITA, NULL AS DESC_PROVINCIA_NASCITA, \
						   NULL AS DESC_COMUNE_NASCITA, null AS LUOGOESTERNO, NULL AS INDIRIZZOESTERNO, NULL AS COD_PROVINCIA_RES, NULL AS COD_COMUNE_RES, NULL AS DESC_PROVINCIA_RES, NULL AS DESC_COMUNE_RES, \
						   NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, \
						   NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, NULL AS DT_INIZIO_VAL, \
						   DIC_RES_COM AS FIELD1, DIC_RES_PROV AS FIELD2, DIC_RES_INDIR AS FIELD3, DIC_RES_NUMCIV AS FIELD4, DIC_RES_CAP AS FIELD5 \
				 		   FROM docfa_dichiaranti \
						   WHERE NOT exists (SELECT 1 FROM sit_soggetto_totale WHERE id_dwh = PROTOCOLLO_REG || '|' || TO_CHAR(fornitura, 'YYYYMMDD') AND fk_ente_sorgente =? AND prog_es=?)

SQL_SOGG_COMPRAVENDITE=SELECT iid AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, COGNOME AS COGNOME, NOME NOME, DENOMINAZIONE AS DENOMINAZIONE, \
					   SESSO SESSO, CODICE_FISCALE COD_FISC, CODICE_FISCALE_G AS PI, DATA_NASCITA AS DT_NASCITA, tipo_soggetto AS TIPO_PERSONA, NULL AS COD_PROVINCIA_NASCITA,\
					   luogo_nascita AS COD_COMUNE_NASCITA, NULL AS DESC_PROVINCIA_NASCITA, NULL AS DESC_COMUNE_NASCITA, null AS LUOGOESTERNO, NULL AS INDIRIZZOESTERNO, null AS COD_PROVINCIA_RES, \
					   null aS COD_COMUNE_RES, null AS DESC_PROVINCIA_RES, null AS DESC_COMUNE_RES, \
					   NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, \
					   NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, NULL AS DT_INIZIO_VAL, SEDE AS FIELD1 \
					   FROM mui_soggetti \
					   WHERE NOT exists (SELECT 1 FROM sit_soggetto_totale WHERE id_dwh = iid AND fk_ente_sorgente =? AND prog_es=?)
					   
SQL_COSAP_CONTRIB=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, \
                  DT_FINE_VAL AS DT_FINE_VAL, \
                  CODICE_FISCALE AS COD_FISC, \
                  PARTITA_IVA AS PI, \
                  TIPO_PERSONA, \
                  DECODE(TIPO_PERSONA, 'G', DECODE(COG_DENOM, NULL, '', COG_DENOM) || ' ' || DECODE(NOME, NULL, '', NOME), NULL) AS DENOMINAZIONE, \
                  DECODE(TIPO_PERSONA, 'F', COG_DENOM, NULL) AS COGNOME, \
                  DECODE(TIPO_PERSONA, 'F', NOME, NULL) AS NOME, \
                  NULL AS SESSO, \
                  DT_NASCITA, \
                  DESC_COMUNE_NASCITA, \
                  COD_BELFIORE_NASCITA AS COD_COMUNE_NASCITA, \
                  NULL AS DESC_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_RES, \
                  COD_BELFIORE_RESIDENZA AS COD_COMUNE_RES, \
                  NULL AS DESC_PROVINCIA_RES, \
                  DESC_COMUNE_RESIDENZA AS DESC_COMUNE_RES, \
                  c.PROCESSID AS PROCESSID, c.DT_INIZIO_DATO AS DT_INIZIO_DATO, c.DT_FINE_DATO AS DT_FINE_DATO, \
                  c.DT_EXP_DATO AS DT_EXP_DATO, c.PROVENIENZA AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, c.DT_INIZIO_VAL AS DT_INIZIO_VAL, \
                  to_char(c.DT_ISCR_ARCHIVIO, 'dd/MM/yyyy') AS FIELD1, to_char(c.DT_COSTIT_SOGGETTO, 'dd/MM/yyyy') AS FIELD2 \
                  FROM SIT_T_COSAP_CONTRIB c
                  
SQL_SOGG_MULTE=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, \
                  DT_FINE_VAL AS DT_FINE_VAL, \
                  DECODE(NOME, NULL, NULL,COD_FISC) AS COD_FISC, \
                  DECODE(NOME, NULL, COD_FISC,NULL) AS PI, \
                  DECODE(NOME, NULL, 'G','P') AS TIPO_PERSONA, \
                  COGNOME || ' ' || NOME AS DENOMINAZIONE, \
                  COGNOME, \
                  NOME, \
                  NULL AS SESSO, \
                  UTIL.FCHAR_TO_DATE(DT_NASCITA, 'YYYYMMDD') AS DT_NASCITA, \
                  LUOGO_NASCITA AS DESC_COMUNE_NASCITA, \
                  NULL AS COD_COMUNE_NASCITA, \
                  NULL AS DESC_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_RES, \
                  NULL AS COD_COMUNE_RES, \
                    NULL AS DESC_PROVINCIA_RES, \
                  LUOGO_RESIDENZA AS DESC_COMUNE_RES, \
                  PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, \
                  DT_EXP_DATO AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, DT_INIZIO_VAL AS DT_INIZIO_VAL, \
                  NR_VERBALE AS FIELD1, DATA_MULTA AS FIELD2, IMPORTO_MULTA AS FIELD3, LUOGO_INFRAZIONE AS FIELD4, \
                  TARGA AS FIELD5, MARCA AS FIELD6, MODELLO AS FIELD7, NR_PATENTE AS FIELD8 \
                  FROM SIT_TRFF_MULTE
                 
SQL_SOGG_RETTE=SELECT DISTINCT ID AS ID_DWH, ID_EXT AS ID_STORICO, \
                  DT_FINE_VAL AS DT_FINE_VAL, \
                  DECODE(NOME, NULL, NULL, CODICE_FISCALE) AS COD_FISC, \
                  DECODE(PARTITA_IVA, NULL, COD_SOGGETTO,PARTITA_IVA) AS PI, \
                  DECODE(NOME, NULL, 'G','P') AS TIPO_PERSONA, \
                  COGNOME || ' ' || NOME AS DENOMINAZIONE, \
                  COGNOME, NOME, \
                  DECODE(SESSO, NULL, '',DECODE(SESSO, 1, 'M','F')) AS SESSO, \
                  DATA_NASCITA AS DT_NASCITA, \
                  COMUNE_NASCITA AS DESC_COMUNE_NASCITA, \
                  NULL AS COD_COMUNE_NASCITA, \
                  NULL AS DESC_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_RES, \
                  NULL AS COD_COMUNE_RES, \
                  NULL AS DESC_PROVINCIA_RES, \
                  NULL AS DESC_COMUNE_RES, \
                  PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, \
                  DT_EXP_DATO AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, DT_INIZIO_VAL AS DT_INIZIO_VAL \
                  FROM SIT_RTT_SOGG_BOLLETTE

SQL_SOGG_RETTE_RAPPR=SELECT DISTINCT ID AS ID_DWH, ID_EXT AS ID_STORICO, \
                  DT_FINE_VAL AS DT_FINE_VAL, \
                  NULL AS PI, \
                  'P' AS TIPO_PERSONA, \
                  NULL COGNOME, NULL NOME, \
                  NULL AS SESSO, \
                  NULL AS DT_NASCITA, \
                  NULL AS DESC_COMUNE_NASCITA, \
                  NULL AS COD_COMUNE_NASCITA, \
                  NULL AS DESC_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_RES, \
                  NULL AS COD_COMUNE_RES, \
                  NULL AS DESC_PROVINCIA_RES, \
                  NULL AS DESC_COMUNE_RES, \
                  PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, \
                  DT_EXP_DATO AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, DT_INIZIO_VAL AS DT_INIZIO_VAL \
                  FROM SIT_RTT_SOGG_BOLLETTE
                  
SQL_SOGG_PORTALESERVIZI=SELECT ID AS ID_DWH, NULL AS ID_STORICO, \
                  NULL AS DT_FINE_VAL, \
                  CODICE_FISCALE AS COD_FISC, \
                  NULL AS PI, \
                  'P' AS TIPO_PERSONA, \
                  COGNOME || ' ' || NOME AS DENOMINAZIONE, \
                  COGNOME, NOME, SESSO, \
                  UTIL.FCHAR_TO_DATE(DATA_NASCITA, 'YYYYMMDD') AS DT_NASCITA, \
                  COMUNE_NASCITA AS DESC_COMUNE_NASCITA, \
                  NULL AS COD_COMUNE_NASCITA, \
                  PROVINCIA_NASCITA AS DESC_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_RES, \
                  NULL AS COD_COMUNE_RES, \
                  PROVINCIA_RESIDENZA AS DESC_PROVINCIA_RES, \
                  COMUNE_RESIDENZA AS DESC_COMUNE_RES, \
                  NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, \
                  NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, NULL AS DT_INIZIO_VAL \
                  FROM PS_ANAGRAFICA_VIEW \
                  WHERE NOT exists (SELECT 1 FROM sit_soggetto_totale WHERE id_dwh = id AND fk_ente_sorgente =? AND prog_es=?)
                  
SQL_SOGG_ACQUA_UTENTE=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, \
                  DT_FINE_VAL AS DT_FINE_VAL, \
                  COD_FISCALE AS COD_FISC, \
                  PART_IVA AS PI, \
                  DECODE(NOME, NULL, 'G','P') AS TIPO_PERSONA, \
                  DECODE(NOME, NULL, DENOMINAZIONE,COGNOME || ' ' || NOME) AS DENOMINAZIONE, \
                  COGNOME, \
                  NOME, \
                  SESSO, \
                  DT_NASCITA, \
                  COMUNE_NASCITA AS DESC_COMUNE_NASCITA, \
                  NULL AS COD_COMUNE_NASCITA, \
                  PR_NASCITA AS DESC_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_RES, \
                  NULL AS COD_COMUNE_RES, \
                  PR_RESIDENZA AS DESC_PROVINCIA_RES, \
                  COMUNE_RESIDENZA AS DESC_COMUNE_RES, \
                  PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, \
                  DT_EXP_DATO AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, DT_INIZIO_VAL AS DT_INIZIO_VAL, \
                  TELEFONO AS FIELD1, FAX_EMAIL AS FIELD2 \
                  FROM SIT_ACQUA_UTENTE
                  
SQL_SOGG_ACQUA_UTENZE=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, \
                  DT_FINE_VAL AS DT_FINE_VAL, \
                  NULL AS COD_FISC, \
                  NULL AS PI, \
                  NULL AS TIPO_PERSONA, \
                  RAG_SOC_UBICAZIONE AS DENOMINAZIONE, \
                  NULL AS COGNOME, \
                  NULL AS NOME, \
                  NULL AS SESSO, \
                  NULL AS DT_NASCITA, \
                  NULL AS DESC_COMUNE_NASCITA, \
                  NULL AS COD_COMUNE_NASCITA, \
                  NULL AS DESC_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_NASCITA, \
                  NULL AS COD_PROVINCIA_RES, \
                  NULL AS COD_COMUNE_RES, \
                  NULL AS DESC_PROVINCIA_RES, \
                  COMUNE_UBICAZIONE AS DESC_COMUNE_RES, \
                  PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, \
                  DT_EXP_DATO AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, DT_INIZIO_VAL AS DT_INIZIO_VAL, \
                  VIA_UBICAZIONE AS FIELD1, CIVICO_UBICAZIONE AS FIELD2, CONSUMO_MEDIO AS FIELD3, \
                  STACCO AS FIELD4, GIRO AS FIELD5 \
                  FROM SIT_ACQUA_UTENZE WHERE RAG_SOC_UBICAZIONE IS NOT NULL
					
SQL_SOGG_REDD_ANALITICI=SELECT DISTINCT ID AS ID_DWH, ID_EXT AS ID_STORICO, \
                 DT_FINE_VAL AS DT_FINE_VAL, CODICE_FISCALE AS COD_FISC, NULL AS PI, DECODE(TRIM(NOME), NULL || '', 'G','P') AS TIPO_PERSONA,  DENOMINAZIONE AS DENOMINAZIONE, \
                 COGNOME AS COGNOME, NOME AS NOME, SESSO AS SESSO, DATA_NASCITA AS DT_NASCITA, \
                 COMUNE_NASCITA AS COD_COMUNE_NASCITA, NULL AS COD_PROVINCIA_NASCITA, NULL AS DESC_COMUNE_NASCITA, NULL AS DESC_PROVINCIA_NASCITA, \
                 NULL AS COD_PROVINCIA_RES, NULL AS COD_COMUNE_RES, NULL AS DESC_COMUNE_RES, NULL AS DESC_PROVINCIA_RES, \
                 PROCESSID, DT_INIZIO_DATO, DT_FINE_DATO, \
                 DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, DT_INIZIO_VAL, \
                 ANNO_IMPOSTA AS FIELD1, SETTORE_ONLUS AS FIELD2, ONLUS AS FIELD3, STATO AS FIELD4, \
                 SITUAZIONE AS FIELD5, NATURA_GIURIDICA AS FIELD6 \
                 FROM RED_AN_DATI_ANAGRAFICI

SQL_SOGG_F24_VERS_CONTRIB=SELECT DISTINCT ID AS ID_DWH,\
                ID_EXT AS ID_STORICO,\
                DT_FINE_VAL AS DT_FINE_VAL,\
                DECODE(DENOMINAZIONE, NULL, DECODE (LENGTH (CF),16, CF,NULL),NULL) AS COD_FISC,\
                DECODE(DENOMINAZIONE, NULL, DECODE (LENGTH (CF),11, CF,NULL),NULL) AS PI,\
                DECODE (LENGTH (CF),11, 'G', 'P') AS TIPO_PERSONA,\
                DECODE (LENGTH (CF),11,DENOMINAZIONE, NULL) AS DENOMINAZIONE,\
                DECODE (LENGTH (CF),16,DENOMINAZIONE, NULL) AS COGNOME,\
                v.NoME AS NOME,\
                SESSO AS SESSO,\
                DECODE(TRIM(LTRIM(DT_NASCITA,'0')),'',null,TRIM(LTRIM(DT_NASCITA,'0'))) AS DT_NASCITA,\
                COD_NAZIONALE AS COD_COMUNE_NASCITA,\
                PROVINCIA AS COD_PROVINCIA_NASCITA,\
                COMUNE_STATO AS DESC_COMUNE_NASCITA,\
                DENO_PROV AS DESC_PROVINCIA_NASCITA,\
                NULL AS COD_PROVINCIA_RES,\
                NULL AS COD_COMUNE_RES,\
                NULL AS DESC_COMUNE_RES,\
                NULL AS DESC_PROVINCIA_RES,\
                PROCESSID,\
                DT_INIZIO_DATO,\
                DT_FINE_DATO,\
                DT_EXP_DATO,\
                NULL AS PROVENIENZA,\
                NULL AS DATA_REGISTRAZIONE,\
                DT_INIZIO_VAL,\
                TO_CHAR(DT_FORNITURA,'dd/MM/yyyy') AS FIELD1,\
                PROG_FORNITURA AS FIELD2,\
                TO_CHAR(DT_RIPARTIZIONE,'dd/MM/yyyy') AS FIELD3,\
                PROG_RIPARTIZIONE AS FIELD4,\
                TO_CHAR(DT_BONIFICO,'dd/MM/yyyy') AS FIELD5,\
                PROG_DELEGA AS FIELD6,\
                PROG_RIGA AS FIELD7,\
                COD_ENTE_RD AS FIELD8,\
                COD_ENTE_COM AS FIELD9,\
                COD_TRIBUTO AS FIELD10,\
                ANNO_RIF AS FIELD11,\
                TIPO_IMPOSTA AS FIELD12,\
                ACCONTO AS FIELD13,\
                SALDO AS FIELD14 FROM SIT_T_f24_VERSAMENTI v left join siticomu c on (c.sigla_prov=v.provincia and c.nome = v.COMUNE_STATO)

SQL_SOGG_F24_VERS_ALTRO=SELECT DISTINCT ID AS ID_DWH,\
                ID_EXT AS ID_STORICO,\
                DT_FINE_VAL AS DT_FINE_VAL,\
                DECODE (LENGTH (CF2),16, CF2,NULL) AS COD_FISC,\
                DECODE (LENGTH (CF2),11, CF2,NULL) AS PI,\
                DECODE (LENGTH (CF2),11, 'G', 'P') AS TIPO_PERSONA,\
                PROCESSID,\
                DT_INIZIO_DATO,\
                DT_FINE_DATO,\
                DT_EXP_DATO,\
                NULL AS PROVENIENZA,\
                NULL AS DATA_REGISTRAZIONE,\
                DT_INIZIO_VAL,\
                TO_CHAR(DT_FORNITURA,'dd/MM/yyyy') AS FIELD1,\
                PROG_FORNITURA AS FIELD2,\
                TO_CHAR(DT_RIPARTIZIONE,'dd/MM/yyyy') AS FIELD3,\
                PROG_RIPARTIZIONE AS FIELD4,\
                TO_CHAR(DT_BONIFICO,'dd/MM/yyyy') AS FIELD5,\
                PROG_DELEGA AS FIELD6,\
                PROG_RIGA AS FIELD7,\
                COD_ENTE_RD AS FIELD8,\
                COD_ENTE_COM AS FIELD9,\
                COD_TRIBUTO AS FIELD10,\
                ANNO_RIF AS FIELD11,\
                TIPO_IMPOSTA AS FIELD12,\
                ACCONTO AS FIELD13,\
                SALDO AS FIELD14,\
                COD_ID_CF2 AS FIELD15,\
                DESCRIZIONE AS FIELD19,\
                CF AS FIELD20 FROM SIT_T_f24_VERSAMENTI v left join SIT_T_F24_COD_SOGG c on (c.codice = v.cod_id_cf2)  where cf2 is not null
                
SQL_SOGG_F24_ANNUL_CONTRIB=SELECT DISTINCT ID AS ID_DWH,\
                ID_EXT AS ID_STORICO,\
                DT_FINE_VAL AS DT_FINE_VAL,\
                DECODE (LENGTH (CF),16, CF,NULL) AS COD_FISC,\
                DECODE (LENGTH (CF),11, CF,NULL) AS PI,\
                DECODE (LENGTH (CF),11, 'G', 'P') AS TIPO_PERSONA,\
                PROCESSID,\
                DT_INIZIO_DATO,\
                DT_FINE_DATO,\
                DT_EXP_DATO,\
                NULL AS PROVENIENZA,\
                NULL AS DATA_REGISTRAZIONE,\
                DT_INIZIO_VAL,\
                TO_CHAR(DT_FORNITURA,'dd/MM/yyyy') AS FIELD1,\
                PROG_FORNITURA AS FIELD2,\
                TO_CHAR(DT_RIPART_ORIG,'dd/MM/yyyy') AS FIELD3,\
                PROG_RIPART_ORIG AS FIELD4,\
                TO_CHAR(DT_BONIFICO_ORIG,'dd/MM/yyyy') AS FIELD5,\
                COD_ENTE_RD AS FIELD8,\
                COD_ENTE_COM AS FIELD9,\
                COD_TRIBUTO AS FIELD10,\
                ANNO_RIF AS FIELD11,\
                TIPO_IMPOSTA AS FIELD12,\
                TIPO_OPERAZIONE AS FIELD16,\
                TO_CHAR(DT_RISCOSSIONE,'dd/MM/yyyy') AS FIELD17,\
                TO_CHAR(DT_OPERAZIONE,'dd/MM/yyyy') AS FIELD18 FROM SIT_T_f24_annullamento
                
SQL_SOGG_SALDO_IMU_STORICO=SELECT DISTINCT CODFISC||'|'||PROGRESSIVO AS ID_DWH,\
                CODFISC||'|'||PROGRESSIVO AS ID_STORICO,\
                NULL AS DT_FINE_VAL,\
                DECODE (LENGTH (codfisc),16, codfisc,NULL) AS COD_FISC,\
                DECODE (LENGTH (codfisc),11, codfisc,NULL)  AS PI,\
                DECODE (LENGTH (codfisc),11, 'G', 'P') AS TIPO_PERSONA,\
                DECODE (LENGTH (codfisc),11,COGNOME, NULL) AS DENOMINAZIONE,\
                DECODE (LENGTH (codfisc),16,COGNOME, NULL) AS COGNOME,\
                NOME AS NOME,\
                SESSO AS SESSO,\
                NULL AS DT_NASCITA,\
                NULL AS COD_COMUNE_NASCITA,\
                PROV_NASC AS COD_PROVINCIA_NASCITA,\
                COMU_NASC AS DESC_COMUNE_NASCITA,\
                NULL AS DESC_PROVINCIA_NASCITA,\
                NULL AS COD_PROVINCIA_RES,\
                NULL AS COD_COMUNE_RES,\
                COMU_RES AS DESC_COMUNE_RES,\
                PROV_RES AS DESC_PROVINCIA_RES,\
                DT_INS AS DT_INIZIO_DATO,\
                NULL AS PROCESSID,\
                NULL AS DT_FINE_DATO,\
                DT_INS AS DT_EXP_DATO,\
                NULL AS PROVENIENZA,\
                DT_INS AS DATA_REGISTRAZIONE,\
                DT_INS AS DT_INIZIO_VAL from saldo_imu_storico    

SQL_SOGG_CONCEDI_VISURE=SELECT inxdoc||'|'||tipo_atto AS ID_DWH, inxdoc||'|'||tipo_atto AS ID_STORICO,\
                    NOME_INTESTATARIO AS DENOMINAZIONE,\
                     NUM_PROT_GEN   AS FIELD1,  ANNO_PROT_GEN AS FIELD2, NUM_PROT_SETT  AS FIELD3,\
                     TIPO_ATTO AS FIELD4, NUMERO_ATTO AS FIELD5, DATA_DOC AS FIELD6,  INXDOC AS FIELD7,\
                     TPV||' '||NOME_VIA AS FIELD8, ALTRAVIA AS FIELD9,\
                     CIVICO AS FIELD10, CIVICO_SUB  AS FIELD11, ALTRICIV AS FIELD12 FROM MI_CONC_EDILIZIE_VISURE \
                     WHERE NOT exists (SELECT 1 FROM sit_soggetto_totale WHERE id_dwh = inxdoc||'|'||tipo_atto AND fk_ente_sorgente =? AND prog_es=?)
                     
SQL_SOGG_ICI_DM_VERS= select DISTINCT v.ID AS ID_DWH,\
                ID_EXT AS ID_STORICO,\
                V.DT_FINE_VAL AS DT_FINE_VAL,\
               case when (V.FLG_REPERIBILITA='1' OR V.FLG_REPERIBILITA='3') then null \
                     else (case when LENGTH (v.cf_versante)>11 then v.cf_versante else NULL end) \
                end as COD_FISC,\
                 case when (V.FLG_REPERIBILITA='1' OR V.FLG_REPERIBILITA='3') then null \
                     else (case when LENGTH (v.cf_versante)<=11 then v.cf_versante else NULL end) \
                end as PI,\
                DECODE (LENGTH (v.cf_versante),16, 'P', 'G') AS TIPO_PERSONA,\
                a.DENOMINAZIONE AS DENOMINAZIONE,\
                a.COGNOME AS COGNOME,\
                a.NOME AS NOME,\
                c.SIGLA_PROV AS COD_PROVINCIA_RES,\
                c.COD_NAZIONALE AS COD_COMUNE_RES,\
                a.com_domicilio AS DESC_COMUNE_RES,\
                c.deno_prov AS DESC_PROVINCIA_RES,\
                v.PROCESSID,\
                v.DT_INIZIO_DATO,\
                v.DT_FINE_DATO,\
                v.DT_EXP_DATO,\
                v.DT_INIZIO_VAL,\
                TO_CHAR(v.DT_VERSAMENTO,'dd/MM/yyyy') as FIELD1,\
                IMP_VERSATO as FIELD2,\
                TO_CHAR(v.DT_REGISTRAZIONE,'dd/MM/yyyy') AS FIELD3,\
                COMUNE AS FIELD4,\
                CAP AS FIELD5,\
                NUM_FABB AS FIELD6,\
                FLG_ACC_SALDO AS FIELD7,\
                ANNO_IMPOSTA AS FIELD8,\
                FLG_RAVVEDIMENTO AS FIELD9 \
                from sit_t_ici_dm_vers v left join sit_t_ici_dm_anag a on v.id_ext_an=A.ID_EXT left join siticomu c on (c.nome = a.com_domicilio)

SQL_SOGG_ICI_DM_VIOL=select DISTINCT v.ID AS ID_DWH,\
                ID_EXT AS ID_STORICO,\
                V.DT_FINE_VAL AS DT_FINE_VAL,\
               case when (V.FLG_REPERIBILITA='1' OR V.FLG_REPERIBILITA='3') then null \
                     else (case when LENGTH (v.cf_versante)>11 then v.cf_versante else NULL end) \
                end as COD_FISC,\
                 case when (V.FLG_REPERIBILITA='1' OR V.FLG_REPERIBILITA='3') then null \
                     else (case when LENGTH (v.cf_versante)<=11 then v.cf_versante else NULL end) \
                end as PI,\
                DECODE (LENGTH (v.cf_versante),16, 'P', 'G') AS TIPO_PERSONA,\
                a.DENOMINAZIONE AS DENOMINAZIONE,\
                a.COGNOME AS COGNOME,\
                a.NOME AS NOME,\
                c.SIGLA_PROV AS COD_PROVINCIA_RES,\
                c.COD_NAZIONALE AS COD_COMUNE_RES,\
                a.com_domicilio AS DESC_COMUNE_RES,\
                c.deno_prov AS DESC_PROVINCIA_RES,\
                v.PROCESSID,\
                v.DT_INIZIO_DATO,\
                v.DT_FINE_DATO,\
                v.DT_EXP_DATO,\
                v.DT_INIZIO_VAL,\
                TO_CHAR(v.DT_VERSAMENTO,'dd/MM/yyyy') as FIELD1,\
                IMP_VERSATO as FIELD2,\
                TO_CHAR(v.DT_REGISTRAZIONE,'dd/MM/yyyy') AS FIELD3,\
                COMUNE AS FIELD4,\
                CAP AS FIELD5,\
                TIPO_IMPOSTA AS FIELD6 \
                from sit_t_ici_dm_violazione v left join sit_t_ici_dm_anag a on v.id_ext_an=A.ID_EXT left join siticomu c on (c.nome = a.com_domicilio)

SQL_SOGG_R_TARSU=select distinct ruolo.*, \
                c_res.deno_prov AS DESC_PROVINCIA_RES,\
                c_res_com.codi_fisc_luna AS COD_COMUNE_RES from \
               ((select v.id as ID_DWH, ID_EXT AS ID_STORICO,V.DT_FINE_VAL AS DT_FINE_VAL,\
                null as cod_FISC, v.codfisc as PI, v.nominativo_contrib AS DENOMINAZIONE,'G' AS TIPO_PERSONA,\
                v.PROV AS COD_PROVINCIA_RES,v.COMUNE AS DESC_COMUNE_RES,\
                v.PROCESSID,v.DT_INIZIO_DATO,v.DT_FINE_DATO,v.DT_EXP_DATO,v.DT_INIZIO_VAL,\
                v.ANNO AS FIELD1,v.TIPO AS FIELD2,V.TOT_NETTO AS FIELD3,v.TOTALE AS FIELD4 \
                from sit_ruolo_tarsu v where length(codfisc)<=11) \
                union all \
                (select v.id as ID_DWH, ID_EXT AS ID_STORICO,V.DT_FINE_VAL AS DT_FINE_VAL,\
                v.codfisc as cod_FISC,null as PI, v.nominativo_contrib AS DENOMINAZIONE,'P' AS TIPO_PERSONA,\
                v.PROV AS COD_PROVINCIA_RES,v.COMUNE AS DESC_COMUNE_RES,\
                v.PROCESSID,v.DT_INIZIO_DATO,v.DT_FINE_DATO,v.DT_EXP_DATO,v.DT_INIZIO_VAL,\
                v.ANNO AS FIELD1,v.TIPO AS FIELD2,V.TOT_NETTO AS FIELD3,v.TOTALE AS FIELD4 \
                from sit_ruolo_tarsu v where length(codfisc)<=16 and length(codfisc)>11)) ruolo \
                    left join siticomu c_res  on (c_res.sigla_prov=ruolo.COD_PROVINCIA_RES) \
                    left join siticomu c_res_com on (c_res_com.nome = replace(ruolo.DESC_COMUNE_RES,'''', '`' ))
                
SQL_SOGG_R_TARES=select ruolo.*,\
                c_nasc.codi_fisc_luna AS COD_COMUNE_NASCITA,c_nasc.deno_prov AS DESC_PROVINCIA_NASCITA,\
                c_res.deno_prov AS DESC_PROVINCIA_RES,c_res.codi_fisc_luna AS COD_COMUNE_RES from \
                (select v.ID AS ID_DWH,ID_EXT AS ID_STORICO,V.DT_FINE_VAL AS DT_FINE_VAL,\
                null as cod_FISC, v.codfisc as PI, DECODE (v.cognome_ragsoc, null, v.nominativo_contrib, v.cognome_ragsoc) as DENOMINAZIONE,\
                null as cognome, null as nome, v.sesso as sesso,  v.data_nasc AS DT_NASCITA, 'G' as TIPO_PERSONA,\
                v.PROV_NASC AS COD_PROVINCIA_NASCITA,v.COMUNE_NASC AS DESC_COMUNE_NASCITA,\
                v.PROV AS COD_PROVINCIA_RES, v.COMUNE AS DESC_COMUNE_RES,\
                v.PROCESSID,v.DT_INIZIO_DATO,v.DT_FINE_DATO,v.DT_EXP_DATO,v.DT_INIZIO_VAL,\
                v.ANNO AS FIELD1,v.TIPO AS FIELD2,V.TOT_NETTO AS FIELD3,v.TOTALE AS FIELD4,v.NIMM AS FIELD5 \
                from sit_ruolo_tares v where length(v.codfisc)<=11 \
                union all \
                select v.ID AS ID_DWH,ID_EXT AS ID_STORICO,V.DT_FINE_VAL AS DT_FINE_VAL, \
                v.codfisc as cod_FISC, null as PI,\
                CASE WHEN (v.cognome_ragsoc is null or v.nome is null) then v.nominativo_contrib else null end as DENOMINAZIONE,\
                v.cognome_ragsoc as cognome, v.nome as nome, v.sesso as sesso,  v.data_nasc AS DT_NASCITA, 'P' as TIPO_PERSONA,\
                v.PROV_NASC AS COD_PROVINCIA_NASCITA,v.COMUNE_NASC AS DESC_COMUNE_NASCITA,\
                v.PROV AS COD_PROVINCIA_RES, v.COMUNE AS DESC_COMUNE_RES,\
                v.PROCESSID,v.DT_INIZIO_DATO,v.DT_FINE_DATO,v.DT_EXP_DATO,v.DT_INIZIO_VAL,\
                v.ANNO AS FIELD1,v.TIPO AS FIELD2,V.TOT_NETTO AS FIELD3,v.TOTALE AS FIELD4,v.NIMM AS FIELD5 \
                from sit_ruolo_tares v where length(v.codfisc)<=16 and length(v.codfisc)>11) ruolo \
                left join siticomu c_nasc on (c_nasc.sigla_prov=ruolo.COD_PROVINCIA_NASCITA and c_nasc.nome = replace(ruolo.DESC_COMUNE_NASCITA,'''', '`' )) \
                left join siticomu c_res  on (c_res.sigla_prov=ruolo.COD_PROVINCIA_RES and c_res.nome = replace(ruolo.DESC_COMUNE_RES,'''', '`' ))
                
SQL_SOGG_CENED_PROPRIETARIO=SELECT ID AS ID_DWH, \
                  CASE WHEN LENGTH(TRIM(B.CF_PIVA_PROPRIETARIO))>11  THEN B.CF_PIVA_PROPRIETARIO ELSE NULL END AS COD_FISC, \
                  CASE WHEN LENGTH(TRIM(B.CF_PIVA_PROPRIETARIO))<=11 THEN B.CF_PIVA_PROPRIETARIO ELSE NULL END AS PI, \
                  B.DENOM_PROPRIETARIO AS DENOMINAZIONE, \
                  B.SEZIONE FIELD1, \
                  B.FOGLIO FIELD2, \
                  B.PARTICELLA FIELD3, \
                  B.SUB_TUTTI  FIELD4, \
                  B.INDIRIZZO  FIELD5, \
                  to_char(B.DATA_PROT, 'dd/MM/yyyy') FIELD6, \
                  B.CODICE_IDENTIFICATIVO_PRATICA FIELD7, \
                  B.CLASSE_ENERGETICA FIELD8, \
                  B.DESTINAZIONE_DI_USO FIELD9, \
                  B.MOTIVAZIONE_ACE FIELD10 \
        FROM DATI_TEC_FABBR_CERT_ENER B \
       WHERE (B.CF_PIVA_PROPRIETARIO IS NOT NULL OR B.DENOM_PROPRIETARIO IS NOT NULL) AND (B.BELFIORE in (select codent from sit_ente) ) \
       AND NOT exists ( select 1 from sit_soggetto_totale where id_dwh = b.ID and fk_ente_sorgente =? and prog_es =? )
                
SQL_SOGG_CENED_CERTIFICATORE=SELECT ID AS ID_DWH, \
                  CASE WHEN LENGTH(TRIM(B.CF_PIVA_CERTIFICATORE))>11  THEN B.CF_PIVA_CERTIFICATORE ELSE NULL END AS COD_FISC, \
                  CASE WHEN LENGTH(TRIM(B.CF_PIVA_CERTIFICATORE))<=11 THEN B.CF_PIVA_CERTIFICATORE ELSE NULL END AS PI, \
                  B.DENOM_CERTIFICATORE AS DENOMINAZIONE, \
                  B.SEZIONE FIELD1, \
                  B.FOGLIO FIELD2, \
                  B.PARTICELLA FIELD3, \
                  B.SUB_TUTTI  FIELD4, \
                  B.INDIRIZZO  FIELD5, \
                  to_char(B.DATA_PROT, 'dd/MM/yyyy') FIELD6, \
                  B.CODICE_IDENTIFICATIVO_PRATICA FIELD7, \
                  B.CLASSE_ENERGETICA FIELD8, \
                  B.DESTINAZIONE_DI_USO FIELD9, \
                  B.MOTIVAZIONE_ACE FIELD10 \
        FROM DATI_TEC_FABBR_CERT_ENER B \
       WHERE (B.CF_PIVA_CERTIFICATORE IS NOT NULL OR B.DENOM_CERTIFICATORE IS NOT NULL) AND (B.BELFIORE in (select codent from sit_ente) ) \
       AND NOT exists ( select 1 from sit_soggetto_totale where id_dwh = b.ID and fk_ente_sorgente =? and prog_es =? )
       
SQL_SOGG_BOLLI_VEICOLI=SELECT ID AS ID_DWH, \
                  CASE WHEN LENGTH(TRIM(B.CODICEFISCALE_PIVA))>11  THEN B.CODICEFISCALE_PIVA ELSE NULL END AS COD_FISC, \
                  CASE WHEN LENGTH(TRIM(B.CODICEFISCALE_PIVA))<=11 THEN B.CODICEFISCALE_PIVA ELSE NULL END AS PI, \
                  CASE WHEN LENGTH(TRIM(B.CODICEFISCALE_PIVA))>11  THEN NULL ELSE B.RAGIONESOCIALE END AS DENOMINAZIONE, \
                  B.COGNOME AS COGNOME,\
                  B.NOME AS NOME,\
	              B.TARGA FIELD1, \
	              B.USO FIELD2, \
	              B.DESTINAZIONE FIELD3, \
	              to_char(B.dt_prima_immatricolazione, 'dd/MM/yyyy') FIELD4, \
	              B.cilindrata FIELD5 \
        FROM BOLLI_VEICOLI B \
       WHERE (B.CODICEFISCALE_PIVA IS NOT NULL OR B.RAGIONESOCIALE IS NOT NULL) AND (B.ENTE in (select codent from sit_ente) ) \
       AND NOT exists ( select 1 from sit_soggetto_totale where id_dwh = b.ID and fk_ente_sorgente =? and prog_es =? )

/*#############################################################################################################################################################################################################*/
/*########################################      Query VIE      #############################################################################################################################################*/
/*#############################################################################################################################################################################################################*/

SQL_VIA_FORNITURE_ELETTRICHE=select utenza.ID ID_DWH, utenza.ID_EXT ID_STORICO, utenza.DT_FINE_VAL AS DT_FINE_VAL, INDIRIZZO_UBICAZIONE INDIRIZZO, \
                    utente.DENOMINAZIONE AS FIELD1, utente.CODICE_FISCALE AS FIELD2, ANNO_RIFERIMENTO_DATI AS FIELD3 \
					from sit_enel_utenza utenza inner join  SIT_ENEL_UTENTE utente \
                    on (utenza.ID_EXT_ENEL_UTENTE = utente.ID_EXT )

SQL_VIA_DEMOGRAFIA=SELECT ID ID_DWH, ID_EXT ID_STORICO, DT_FINE_VAL AS DT_FINE_VAL, VIASEDIME, DESCRIZIONE, ID_ORIG CODICE_VIA \
				   FROM SIT_D_VIA				 				  	
				   
SQL_VIA_GAS=select ID ID_DWH, ID_EXT ID_STORICO, DT_FINE_VAL AS DT_FINE_VAL, INDIRIZZO_UTENZA INDIRIZZO, \
					COGNOME_UTENTE AS FIELD1, NOME_UTENTE AS FIELD2, RAGIONE_SOCIALE AS FIELD3, INDIRIZZO_UTENZA AS FIELD4, \
					IDENTIFICATIVO_UTENZA AS FIELD5, ANNO_RIFERIMENTO AS FIELD6 \
					from SIT_U_GAS	
					
SQL_VIA_CATASTO=SELECT PKID_STRA AS ID_DWH, NULL AS ID_STORICO, \
				   DECODE(TO_CHAR(data_fine_val,'dd/MM/yyyy'),'31/12/9999',TO_DATE(null),data_fine_val) AS DT_FINE_VAL, \
				   PREFISSO,SITIDSTR.NOME,NUMERO CODICE_VIA \
				   FROM SITIDSTR, SITICOMU C \
				   WHERE SITIDSTR.cod_nazionale = C.COD_NAZIONALE \
				   AND C.CODI_FISC_LUNA = ? \
				   AND  NOT exists \
				   (select 1 from sit_via_totale where id_dwh = TO_CHAR(PKID_STRA) and fk_ente_sorgente =? and prog_es=?)
				   
SQL_VIA_CATASTO2=SELECT DISTINCT LID.ID_IMM || '|' || LID.PROGRESSIVO || '|' || LID.SEQ || '|' || LID.CODI_FISC_LUNA || '|' || LID.SEZIONE AS ID_DWH, NULL AS ID_STORICO, \
       NULL AS DT_FINE_VAL, t.descr PREFISSO,  ind.ind AS NOME,  COD_STRADA AS NUMERO,  FOGLIO FIELD1, MAPPALE FIELD2,SUB FIELD3, GRAFFATO FIELD4 \
       FROM LOAD_CAT_UIU_ID LID,  siticomu c, cat_d_toponimi t, load_cat_uiu_ind IND   \
   WHERE c.cODI_FISC_LUNA = ? \
   AND c.sezione_censuaria = lid.sez \
   AND ind.codi_fisc_luna = LID.codi_fisc_luna  \
   AND ind.sezione = LID.sezione AND ind.id_imm = LID.id_imm \
   AND ind.progressivo = LID.progressivo \
   AND ind.toponimo = t.pk_id \
   AND ind.codi_fisc_luna = c.codi_fisc_luna   \
   AND IND.TODELETE ='0' \
   AND IND.SEQ = (SELECT MAX(SEQ) \
                  FROM load_cat_uiu_ind IND21 \
                  WHERE IND21.ID_IMM = IND.ID_IMM \
                     AND IND21.CODI_FISC_LUNA = IND.CODI_FISC_LUNA \
                     AND IND21.PROGRESSIVO = IND.PROGRESSIVO \
                     AND ind21.SEZIONE = ind.SEZIONE \
                     AND ind21.todelete ='0' \
                     ) \
   AND LID.SEQ = (SELECT MAX(SEQ) \
                  FROM load_cat_uiu_id LID2 \
                  WHERE LID2.ID_IMM = LID.ID_IMM \
                     AND LID2.CODI_FISC_LUNA = LID.CODI_FISC_LUNA \
                     AND LID2.PROGRESSIVO = LID.PROGRESSIVO \
                     AND LID2.SEZIONE = LID.SEZIONE \
                     AND lid2.foglio = lid.foglio \
                     AND lid2.mappale = lid.mappale \
                     AND lid2.sub = lid.sub) \
   AND IND.PROGRESSIVO = (SELECT MAX(PROGRESSIVO) \
                          FROM load_cat_uiu_ind IND22 \
                          WHERE IND22.ID_IMM = IND.ID_IMM \
                             AND IND22.CODI_FISC_LUNA = IND.CODI_FISC_LUNA \
                             AND ind22.SEZIONE = ind.SEZIONE \
                             AND ind22.todelete ='0' \
                             )  \
   AND NOT EXISTS (SELECT 1 FROM sit_via_totale \
                   WHERE id_dwh = LID.ID_IMM || '|' || LID.PROGRESSIVO || '|' || LID.SEQ || '|' || LID.CODI_FISC_LUNA || '|' || LID.SEZIONE \
                      AND fk_ente_sorgente = ? \
                      AND prog_es = ?) \
                      AND LTRIM(RTRIM(TRANSLATE(ind.ind, '0123456789', '          '))) IS NOT NULL
                                       
SQL_VIA_LOCAZIONI=select * from (SELECT UFFICIO||'|'||ANNO||'|'||SERIE||'|'||NUMERO||'|'||SOTTONUMERO||'|'||PROG_NEGOZIO AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, INDIRIZZO, NULL CODICE_VIA \
				, UFFICIO FIELD1 \
				, ANNO FIELD2 \
				, SERIE FIELD3 \
				,NUMERO FIELD4 \
				,to_char(DATA_FINE, 'dd/MM/yyyy') FIELD5 \
        		,to_char(DATA_STIPULA,'dd/MM/yyyy') FIELD6 \
				,IMPORTO_CANONE FIELD7 \
				,OGGETTO_LOCAZIONE FIELD8 \
                FROM  locazioni_a ) l \
				WHERE NOT exists \
                   (select 1 from sit_via_totale vt where vt.id_dwh = l.id_dwh and vt.fk_ente_sorgente =? and vt.prog_es=?)
					
SQL_VIA_LOCAZIONI2=SELECT b.UFFICIO||'|'||b.ANNO||'|'||b.SERIE||'|'||b.NUMERO||'|'||b.SOTTONUMERO||'|'||b.PROG_NEGOZIO||'|'||b.PROG_SOGGETTO AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, \
                  b.INDIRIZZO_RESIDENZA AS INDIRIZZO \
				, b.UFFICIO FIELD1 \
				, b.ANNO FIELD2 \
				, b.SERIE FIELD3 \
				,b.NUMERO FIELD4 \
				,PROG_SOGGETTO FIELD5 \
				,to_char(DATA_FINE, 'dd/MM/yyyy') FIELD6 \
        		,to_char(DATA_STIPULA,'dd/MM/yyyy') FIELD7 \
				,IMPORTO_CANONE FIELD8 \
				,OGGETTO_LOCAZIONE FIELD9 \
				,a.INDIRIZZO FIELD10 \
                  FROM LOCAZIONI_B b, SIT_ENTE E , locazioni_a a \
                  WHERE E.CODENT = ? \
                  AND UPPER(TRIM(CITTA_RESIDENZA))=E.DESCRIZIONE \
                    AND a.ufficio = b.ufficio \
                   AND a.anno = b.anno \
                   and a.serie =  b.serie \
                   and a.numero =  b.numero \
                  AND NOT exists \
                  (select 1 from sit_via_totale where id_dwh = b.UFFICIO||'|'||b.ANNO||'|'||b.SERIE||'|'||b.NUMERO||'|'||b.SOTTONUMERO||'|'||b.PROG_NEGOZIO||'|'||b.PROG_SOGGETTO and fk_ente_sorgente =? \
                   and prog_es=?)
                   
SQL_VIA_LOCAZIONI3=SELECT b.UFFICIO||'|'||b.ANNO||'|'||b.SERIE||'|'||b.NUMERO||'|'||b.SOTTONUMERO||'|'||b.PROG_NEGOZIO||'|'||b.PROG_IMMOBILE AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, \
                  b.INDIRIZZO \
                , b.UFFICIO FIELD1 \
                , b.ANNO FIELD2 \
                , b.SERIE FIELD3 \
                ,b.NUMERO FIELD4 \
                ,null FIELD5 \
                ,to_char(DATA_FINE, 'dd/MM/yyyy') FIELD6 \
                ,to_char(DATA_STIPULA,'dd/MM/yyyy') FIELD7 \
                ,IMPORTO_CANONE FIELD8 \
				,OGGETTO_LOCAZIONE FIELD9 \
				,a.INDIRIZZO FIELD10 \
                  FROM LOCAZIONI_I b, locazioni_a a \
                  WHERE(B.CODICE_CAT is null or B.codice_cat in (select codent from sit_ente) ) \
                   AND a.ufficio = b.ufficio \
                   AND a.anno = b.anno \
                   and a.serie =  b.serie \
                   and a.numero =  b.numero \
                  AND NOT exists \
                  (select 1 from sit_via_totale where id_dwh = b.UFFICIO||'|'||b.ANNO||'|'||b.SERIE||'|'||b.NUMERO||'|'||b.SOTTONUMERO||'|'||b.PROG_NEGOZIO||'|'||b.PROG_IMMOBILE and fk_ente_sorgente =? \
                   and prog_es=?)
				  
SQL_VIA_TRIBUTI_ICI=SELECT DISTINCT iciv.ID AS ID_DWH, iciv.ID_EXT ID_STORICO, iciv.PREFISSO AS VIASEDIME, iciv.DESCRIZIONE AS INDIRIZZO, iciv.DT_FINE_VAL, iciv.ID_ORIG AS CODICE_VIA \
					FROM sit_t_ici_oggetto icio INNER JOIN sit_t_ici_via iciv ON (icio.ID_EXT_VIA = iciv.ID_EXT )
SQL_VIA_TRIBUTI_TARSU=SELECT DISTINCT iciv.ID AS ID_DWH, iciv.ID_EXT ID_STORICO, iciv.PREFISSO AS VIASEDIME, iciv.DESCRIZIONE INDIRIZZO, iciv.DT_FINE_VAL, iciv.ID_ORIG AS CODICE_VIA \
					FROM sit_t_tar_oggetto icio INNER JOIN sit_t_tar_via iciv ON (icio.ID_EXT_VIA = iciv.ID_EXT )
					
SQL_VIA_CONCESSIONI_PRATICA=SELECT  C.ID AS ID_DWH, C.ID_EXT ID_STORICO, CI.SEDIME AS VIASEDIME, CI.INDIRIZZO AS INDIRIZZO, CI.CIV_LIV1 AS CIV_LIV1, NULL AS CIV_LIV2, NULL AS CIV_LIV3, C.DT_FINE_VAL, C.ID AS ID_ORIG_VIA, CI.ID_ORIG AS CODICE_CIVICO , \
							C.CONCESSIONE_NUMERO FIELD1 , C.PROTOCOLLO_NUMERO FIELD2, to_char(C.PROTOCOLLO_DATA, 'dd/MM/yyyy') FIELD3, TIPO_INTERVENTO FIELD4, OGGETTO FIELD5, to_char(DATA_RILASCIO, 'dd/MM/yyyy') FIELD6, to_char(DATA_INIZIO_LAVORI, 'dd/MM/yyyy') FIELD7, to_char(DATA_FINE_LAVORI, 'dd/MM/yyyy') FIELD8 \
							FROM SIT_C_CONC_INDIRIZZI CI INNER JOIN SIT_C_CONCESSIONI C \
							on (CI.ID_EXT_C_CONCESSIONI = C.ID_EXT)
				  
SQL_VIA_SUCCESSIONI_OGGETTO=SELECT  UFFICIO || '|' || ANNO || '|' || VOLUME || '|' || NUMERO || '|' || SOTTONUMERO || '|' || COMUNE || '|' || PROGRESSIVO || '|' || PROGRESSIVO_IMMOBILE || '|' || FORNITURA AS ID_DWH, \
							NULL AS ID_STORICO, NULL AS DT_FINE_VAL, INDIRIZZO_IMMOBILE AS INDIRIZZO, \
							FOGLIO AS FIELD1, PARTICELLA1 AS FIELD2, SUBALTERNO1 AS FIELD3, NATURA AS FIELD4, UFFICIO AS FIELD5, ANNO AS FIELD6, \
							VOLUME AS FIELD7, NUMERO AS FIELD8, SOTTONUMERO AS FIELD9, COMUNE AS FIELD10, PROGRESSIVO AS FIELD11 \
							FROM SUCCESSIONI_C WHERE COMUNE = ? \
							AND  NOT exists \
							(select 1 from sit_via_totale where id_dwh = UFFICIO || '|' || ANNO || '|' || VOLUME || '|' || NUMERO || '|' || SOTTONUMERO || '|' || COMUNE || '|' || PROGRESSIVO || '|' || PROGRESSIVO_IMMOBILE || '|' || FORNITURA and fk_ente_sorgente =? and prog_es=?)							
                 
SQL_VIA_LIC_COMM=SELECT DISTINCT ID AS ID_DWH, ID_EXT ID_STORICO, SEDIME AS VIASEDIME, INDIRIZZO AS INDIRIZZO, DT_FINE_VAL, ID_ORIG AS CODICE_VIA FROM SIT_LICENZE_COMMERCIO_VIE
				
SQL_VIA_REDDITI_DICHIARANTE=SELECT RED_DAT_ANA.IDE_TELEMATICO || '|' || RED_DAT_ANA.CODICE_FISCALE_DIC AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, INDIRIZZO_ATTUALE AS INDIRIZZO \
							, red_dat_ana.CODICE_FISCALE_DIC FIELD1 \
							, COGNOME FIELD2 \
							, RED_DAT_ANA.NOME FIELD3 \
							, DENOMINAZIONE FIELD4 \
							, C.NOME FIELD5 \
							, to_char(TO_DATE(DATA_NASCITA,'YYYYMMDD'),'dd/MM/yyyy' ) FIELD6 \
							, RED_DAT_ANA.ANNO_IMPOSTA FIELD7 \
							  FROM red_dati_anagrafici RED_DAT_ANA, red_domicilio_fiscale RED_DOM_FISC,  SITICOMU C \
							                    WHERE RED_DAT_ANA.IDE_TELEMATICO = RED_DOM_FISC.IDE_TELEMATICO \
							                    AND RED_DAT_ANA.CODICE_FISCALE_DIC = RED_DOM_FISC.CODICE_FISCALE_DIC \
							                    AND RED_DAT_ANA.ANNO_IMPOSTA = RED_DOM_FISC.ANNO_IMPOSTA \
							                    AND COMUNE_NASCITA = C.COD_NAZIONALE (+) \
							 AND EXISTS (select 1 from sit_ente where codent = red_dom_fisc.CODICE_CAT_DOM_FISCALE_ATTUALE) \
							 AND  NOT exists \
							(select 1 from sit_via_totale where ID_DWH = RED_DAT_ANA.IDE_TELEMATICO || '|' || RED_DAT_ANA.CODICE_FISCALE_DIC and fk_ente_sorgente =? and prog_es=?)

SQL_VIA_DOCFA=SELECT  PROTOCOLLO_REG || '|'|| TO_CHAR(FORNITURA,'YYYYMMDD') || '|' || NR_PROG AS ID_DWH, NULL ID_STORICO, NULL AS DT_FINE_VAL, NULL VIASEDIME , INDIR_TOPONIMO INDIRIZZO, NULL CODICE_VIA, \
			  FOGLIO AS FIELD1, NUMERO AS FIELD2, SUBALTERNO AS FIELD3, PROTOCOLLO_REG AS FIELD4, TO_CHAR(FORNITURA,'dd/MM/yyyy') AS FIELD5 \
			  FROM DOCFA_UIU WHERE INDIR_TOPONIMO  is not null \
			  AND NOT exists (select 1 from sit_via_totale where id_dwh = PROTOCOLLO_REG || '|'|| TO_CHAR(FORNITURA,'YYYYMMDD') || '|' || NR_PROG and fk_ente_sorgente =? and prog_es =?)
			  
SQL_VIA_COMPRAV_SOGG=SELECT IID AS ID_DWH, NULL ID_STORICO, NULL AS DT_FINE_VAL, NULL VIASEDIME , INDIRIZZO INDIRIZZO, NULL CODICE_VIA, COMUNE as FIELD1, PROVINCIA as FIELD2, CAP as FIELD3 FROM MUI_INDIRIZZI_SOG WHERE NOT exists (select 1 from sit_via_totale where id_dwh = TO_CHAR(IID) and fk_ente_sorgente =? and prog_es =?)

SQL_VIA_COMPRAV_OGG=SELECT FABB.IID AS ID_DWH , NULL ID_STORICO, NULL AS DT_FINE_VAL, T.DESCR VIASEDIME , C_INDIRIZZO INDIRIZZO, NULL CODICE_VIA, \
					FABB.FOGLIO as FIELD1, FABB.NUMERO as FIELD2, FABB.SUBALTERNO as FIELD3	\
					FROM mui_fabbricati_identifica FABB , mui_fabbricati_info fabinfo, CAT_D_TOPONIMI T  \
				    WHERE fabinfo.IID_FORNITURA = fabb.IID_FORNITURA AND  fabinfo.iId_nota = fabb.iId_nota AND fabinfo.id_immobile = fabb.id_immobile AND T.PK_ID = fabinfo.C_TOPONIMO (+) AND NOT exists (select 1 from sit_via_totale where id_dwh = TO_CHAR(FABB.IID) and fk_ente_sorgente =? and prog_es =?)
                   
SQL_VIA_COSAP_CONTRIB=SELECT ID AS id_dwh, id_ext id_storico, sedime AS viasedime, \
				       indirizzo, civico AS civ_liv1, NULL AS civ_liv2, \
				       NULL AS civ_liv3, dt_fine_val, ID AS id_orig_via, \
				       id_orig AS codice_civico \
					   FROM sit_t_cosap_contrib
					   
SQL_VIA_COSAP_TASSA=SELECT ID AS id_dwh, id_ext id_storico, sedime AS viasedime, \
                       indirizzo, civico AS civ_liv1, NULL AS civ_liv2, \
                       NULL AS civ_liv3, dt_fine_val, ID AS id_orig_via, \
                       id_orig AS codice_civico, \
                       cod_univoco_canone as FIELD1, numero_documento as FIELD2, \
                       anno_documento as FIELD3, tipo_occupazione as FIELD4, \
                       codice_immobile as FIELD5, codice_via as FIELD6, \
                       foglio as FIELD7, particella as FIELD8, \
                       subalterno as FIELD9, quantita as FIELD10, \
                       importo_canone as FIELD11 \
                       FROM sit_t_cosap_tassa
                       
SQL_VIA_PUBBLICITA_DETTAGLIO=SELECT ID AS id_dwh, id_ext id_storico, null AS viasedime, via AS indirizzo, civico AS civ_liv1, \
                       NULL AS civ_liv2, NULL AS civ_liv3, dt_fine_val, ID AS id_orig_via, id_orig AS codice_civico, \
                       tipo_pratica AS FIELD1, num_pratica AS FIELD2, anno_pratica AS FIELD3, desc_cls AS FIELD4, \
                       desc_oggetto AS FIELD5,  TO_CHAR(dt_inizio, 'dd/MM/yyyy') AS FIELD6,TO_CHAR(dt_fine, 'dd/MM/yyyy') AS FIELD7, \
                       indirizzo  AS FIELD8, giorni_occupazione AS FIELD9, \
                       cod_zona_cespite AS FIELD10, cod_caratteristica  AS FIELD11 FROM sit_pubblicita_prat_dettaglio 

SQL_VIA_MULTE=SELECT ID AS id_dwh, id_ext id_storico, NULL AS viasedime, luogo_infrazione AS indirizzo, \
			       null AS civ_liv1, NULL AS civ_liv2, NULL AS civ_liv3, dt_fine_val, \
			       ID AS id_orig_via, id_orig AS codice_civico, \
			       NR_VERBALE AS FIELD1, DATA_MULTA AS FIELD2, IMPORTO_MULTA AS FIELD3, \
                   TARGA AS FIELD4, MARCA AS FIELD5, MODELLO AS FIELD6, NR_PATENTE AS FIELD7 \
			  	   FROM SIT_TRFF_MULTE WHERE NOT EXISTS (SELECT 1 FROM SIT_VIA_TOTALE WHERE ID_DWH = ID AND fk_ente_sorgente =? AND prog_es=?)

SQL_VIA_ECOGRAFICO_STRADE=select ID AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, SPECIE_STRADA AS SEDIME, NOME_STRADA AS INDIRIZZO, CODICE_STRADA AS CODICE_VIA, PK_SEQU_STRADA AS FIELD1, UK_STRADA AS FIELD2 from ec_top_strade WHERE NOT exists (select 1 from sit_via_totale where id_dwh = id and fk_ente_sorgente =? and prog_es =?)
			  
                       
SQL_VIA_PORTALESERVIZI=SELECT ID AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, VIA_RESIDENZA AS INDIRIZZO \
				   FROM PS_ANAGRAFICA_VIEW \
				   WHERE NOT exists \
				   (select 1 from sit_via_totale where id_dwh = ID and fk_ente_sorgente =? and prog_es=?)
				 
SQL_VIA_ACQUA_UTENTE=SELECT ID AS id_dwh, id_ext id_storico, NULL AS viasedime, via_residenza AS indirizzo, \
			       civico_residenza AS civ_liv1, NULL AS civ_liv2, NULL AS civ_liv3, dt_fine_val, \
			       ID AS id_orig_via, id_orig AS codice_civico, cognome AS field1, \
			       nome AS field2, cod_fiscale AS field3, denominazione AS field4, \
			       part_iva AS field5, cap_residenza AS field6, telefono AS field7, \
			       fax_email AS field8 \
			  	   FROM SIT_ACQUA_UTENTE \
				   WHERE NOT exists \
				   (select 1 from sit_via_totale where id_dwh = ID and fk_ente_sorgente =? and prog_es=?)
			
SQL_VIA_ACQUA_UTENZE=SELECT ID AS id_dwh, id_ext id_storico, NULL AS viasedime, via_ubicazione AS indirizzo, \
			       civico_ubicazione AS civ_liv1, NULL AS civ_liv2, NULL AS civ_liv3, dt_fine_val, \
			       ID AS id_orig_via, id_orig AS codice_civico, rag_soc_ubicazione AS field1, \
			       cap_ubicazione AS field2, consumo_medio AS field3, stacco AS field4, \
			       giro AS field5 \
			       FROM SIT_ACQUA_UTENZE \
				   WHERE NOT exists \
				   (select 1 from sit_via_totale where id_dwh = ID and fk_ente_sorgente =? and prog_es=?)
                   
SQL_VIA_REDD_ANALITICI=SELECT DISTINCT ID AS ID_DWH, ID_EXT AS ID_STORICO, \
                			DT_FINE_VAL AS DT_FINE_VAL, INDIRIZZO_residenza AS INDIRIZZO \
                            , CODICE_FISCALE FIELD1 \
                            , COGNOME FIELD2 \
                            , NOME FIELD3 \
                            , DENOMINAZIONE FIELD4 \
                            , to_char(DATA_NASCITA,'dd/MM/yyyy' ) FIELD6 \
                            , ANNO_IMPOSTA FIELD7 \
                              FROM red_an_dati_anagrafici \
                              WHERE INDIRIZZO_residenza is not null
                              
SQL_VIA_CONCEDI_VISURE=SELECT  inxdoc||'|'||tipo_atto AS ID_DWH, inxdoc||'|'||tipo_atto AS ID_STORICO,\
                    TPV AS VIASEDIME , NOME_VIA AS INDIRIZZO,\
                    NUM_PROT_GEN   AS FIELD1,  ANNO_PROT_GEN AS FIELD2, NUM_PROT_SETT  AS FIELD3,\
                    TIPO_ATTO AS FIELD4, NUMERO_ATTO AS FIELD5, DATA_DOC AS FIELD6,  INXDOC AS FIELD7,\
                    ALTRAVIA AS FIELD8,\
                    CIVICO AS FIELD9, CIVICO_SUB  AS FIELD10, ALTRICIV AS FIELD11 FROM MI_CONC_EDILIZIE_VISURE \
                    WHERE NOT exists (SELECT 1 FROM sit_via_totale WHERE id_dwh = inxdoc||'|'||tipo_atto AND fk_ente_sorgente =? AND prog_es=?)

SQL_VIA_R_TARSU_CONTRIB=select DISTINCT v.ID AS ID_DWH,\
                ID_EXT AS ID_STORICO,\
                V.DT_FINE_VAL AS DT_FINE_VAL,\
                replace(V.INDIRIZZO,'','.') AS INDIRIZZO,\
                v.PROCESSID,\
                v.DT_INIZIO_DATO,\
                v.DT_FINE_DATO,\
                v.DT_EXP_DATO,\
                v.DT_INIZIO_VAL,\
                v.ANNO AS FIELD1,\
                v.TIPO AS FIELD2,\
                V.TOT_NETTO AS FIELD3,\
                v.TOTALE AS FIELD4,\
                null as FIELD5,\
                v.comune AS FIELD6,\
                v.prov AS FIELD7, \
                v.estero AS FIELD8,\
                V.NOMINATIVO_CONTRIB AS FIELD9,\
                V.CODFISC AS FIELD10 \
                from sit_ruolo_tarsu v  \
                where v.indirizzo is not null and estero is null and replace(v.COMUNE,'''', '`' )=(select descrizione from sit_ente)       

SQL_VIA_R_TARES_CONTRIB=select DISTINCT v.ID AS ID_DWH,\
                ID_EXT AS ID_STORICO,\
                V.DT_FINE_VAL AS DT_FINE_VAL,\
                replace(V.INDIRIZZO,'','.') AS INDIRIZZO,\
                v.PROCESSID,\
                v.DT_INIZIO_DATO,\
                v.DT_FINE_DATO,\
                v.DT_EXP_DATO,\
                v.DT_INIZIO_VAL,\
                v.ANNO AS FIELD1,\
                v.TIPO AS FIELD2,\
                V.TOT_NETTO AS FIELD3,\
                v.TOTALE AS FIELD4,\
                v.nimm as FIELD5,\
                v.comune AS FIELD6,\
                v.prov AS FIELD7, \
                v.estero AS FIELD8,\
                V.NOMINATIVO_CONTRIB AS FIELD9,\
                V.CODFISC AS FIELD10 \
                from sit_ruolo_tares v  \
                where v.indirizzo is not null and estero is null and replace(v.COMUNE,'''', '`' )=(select descrizione from sit_ente)      
              
SQL_VIA_R_TARSU_IMM=select DISTINCT i.ID AS ID_DWH,\
                i.ID_EXT AS ID_STORICO,\
                i.DT_FINE_VAL AS DT_FINE_VAL,\
                i.INDIRIZZO AS INDIRIZZO,\
                i.PROCESSID,\
                i.DT_INIZIO_DATO,\
                i.DT_FINE_DATO,\
                i.DT_EXP_DATO,\
                i.DT_INIZIO_VAL,\
                v.ANNO AS FIELD1,\
                v.TIPO AS FIELD2,\
                i.importo AS FIELD3,\
                i.cod_tributo AS FIELD4,\
                i.mq as FIELD5,\
                I.DES_CAT as FIELD6,\
                V.ID AS FIELD7,\
                V.NOMINATIVO_CONTRIB AS FIELD8, \
                V.CODFISC AS FIELD9 \
                from sit_ruolo_tarsu_imm i , sit_ruolo_tarsu v \
                where I.id_ext_ruolo=V.ID_EXT and i.indirizzo is not null

SQL_VIA_R_TARES_IMM=select DISTINCT i.ID AS ID_DWH,\
                i.ID_EXT AS ID_STORICO,\
                i.DT_FINE_VAL AS DT_FINE_VAL,\
                i.INDIRIZZO AS INDIRIZZO,\
                i.PROCESSID,\
                i.DT_INIZIO_DATO,\
                i.DT_FINE_DATO,\
                i.DT_EXP_DATO,\
                i.DT_INIZIO_VAL,\
                v.ANNO AS FIELD1,\
                v.TIPO AS FIELD2,\
                i.importo AS FIELD3,\
                i.cod_tributo AS FIELD4,\
                i.mq as FIELD5,\
                I.DES_CAT as FIELD6,\
                V.ID AS FIELD7,\
                V.NOMINATIVO_CONTRIB AS FIELD8, \
                V.CODFISC AS FIELD9 \
                from sit_ruolo_tares_imm i , sit_ruolo_tares v \
                where I.id_ext_ruolo=V.ID_EXT and i.indirizzo is not null

SQL_VIA_DEMANIO=select DISTINCT i.ID AS ID_DWH,\
                i.tipo_via AS SEDIME,\
                i.descr_via AS INDIRIZZO,\
                i.cod_via as CODICE_VIA,\
                i.DT_FINE_VAL AS DT_FINE_VAL,\
                i.dm_b_bene_id AS FIELD1,\
                i.tipo as FIELD2, \
                i.des_comune AS FIELD3,\
                i.prov AS FIELD4,\
                i.flg_principale AS FIELD5,\
                I.civico as FIELD6 \
                from dm_b_indirizzo i \
                WHERE NOT exists (SELECT 1 FROM sit_via_totale WHERE id_dwh = id AND fk_ente_sorgente =? AND prog_es=?) \
                AND cod_comune = (select codent from sit_ente) 
                
SQL_VIA_CENED=select B.ID AS ID_DWH, \
                B.INDIRIZZO AS INDIRIZZO, \
                b.CODICE_IDENTIFICATIVO_PRATICA FIELD1, \
                b.SEZIONE FIELD2, \
                b.FOGLIO FIELD3, \
                b.PARTICELLA FIELD4, \
                B.SUB_TUTTI FIELD5, \
                to_char(B.DATA_PROT, 'dd/MM/yyyy') FIELD6, \
                B.NUM_PROT FIELD7, \
                B.CLASSE_ENERGETICA FIELD8, \
                B.DESTINAZIONE_DI_USO FIELD9, \
                B.MOTIVAZIONE_ACE FIELD10 \
                from DATI_TEC_FABBR_CERT_ENER B \
                WHERE B.belfiore = (select codent from sit_ente) \
                AND NOT exists (SELECT 1 FROM sit_via_totale WHERE id_dwh = id AND fk_ente_sorgente =? AND prog_es=? )
                
SQL_VIA_BOLLI_VEICOLI=select B.ID AS ID_DWH, \
                B.INDIRIZZO AS INDIRIZZO, \
                b.TARGA FIELD1, \
                b.USO FIELD2, \
                b.DESTINAZIONE FIELD3, \
                to_char(B.dt_prima_immatricolazione, 'dd/MM/yyyy') FIELD4, \
                B.cilindrata FIELD5 \
                from BOLLI_VEICOLI B \
                WHERE B.ENTE = (select codent from sit_ente) \
                AND NOT exists (SELECT 1 FROM sit_via_totale WHERE id_dwh = id AND fk_ente_sorgente =? AND prog_es=? )
                
/*#############################################################################################################################################################################################################*/
/*########################################      Query OGGETTI      #############################################################################################################################################*/
/*#############################################################################################################################################################################################################*/

/*SQL_OGG_FORNITURE_ELETTRICHE=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZIONE, FOGLIO, PARTICELLA, SUBALTERNO,DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL FROM sit_enel_utenza     

SQL_OGG_SUCCESSIONI=SELECT UFFICIO || '|' || ANNO || '|' || VOLUME || '|' || NUMERO || '|' || SOTTONUMERO || '|' || COMUNE || '|' || PROGRESSIVO || '|' || PROGRESSIVO_IMMOBILE || '|' || FORNITURA AS ID_DWH, \
					NULL AS ID_STORICO, SEZIONE, FOGLIO, PARTICELLA1, SUBALTERNO1, PARTICELLA2, SUBALTERNO2, NULL AS DT_INIZIO_VAL, NULL AS DT_FINE_VAL \
					FROM SUCCESSIONI_C \
					WHERE COMUNE = ? \
					AND UFFICIO || '|' || ANNO || '|' || VOLUME || '|' || NUMERO || '|' || SOTTONUMERO || '|' || COMUNE || '|' || PROGRESSIVO || '|' || PROGRESSIVO_IMMOBILE || '|' || FORNITURA \
					NOT IN (SELECT id_dwh FROM sit_oggetto_totale WHERE fk_ente_sorgente =? AND prog_es=?)

SQL_OGG_CONCESSIONI=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZIONE, FOGLIO, PARTICELLA, SUBALTERNO,DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL FROM SIT_C_CONCESSIONI_CATASTO

SQL_OGG_CATASTO=SELECT PKID_UIU ID_DWH, NULL ID_STORICO, id_sezc AS SEZIONE, FOGLIO, PARTICELLA, SUB AS SUBALTERNO,DATA_INIZIO_VAL dt_inizio_val, DATA_FINE_VAL AS DT_FINE_VAL \
				FROM SITICOMU, SITIUIU WHERE siticomu.COD_NAZIONALE = sitiuiu.COD_NAZIONALE \
				AND sitiuiu.COD_NAZIONALE = ? \
				AND PKID_UIU NOT IN (SELECT id_dwh FROM sit_oggetto_totale WHERE fk_ente_sorgente = ? and prog_es= ?)

SQL_OGG_TRIBUTI_ICI=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZ AS SEZIONE, FOGLIO, NUMERO AS PARTICELLA, SUB AS SUBALTERNO,DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL FROM SIT_T_ICI_OGGETTO

SQL_OGG_TRIBUTI_TARSU=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZ AS SEZIONE, FOGLIO, NUMERO AS PARTICELLA, SUB AS SUBALTERNO,DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL FROM SIT_T_TAR_OGGETTO
		  
SQL_OGG_DOCFA=SELECT  TO_CHAR(FORNITURA,'DD-MM-YYYY')||'|'||PROTOCOLLO_REG||'|'||TO_CHAR(NR_PROG) AS ID_DWH, NULL ID_STORICO, SEZIONE AS SEZIONE, FOGLIO, NUMERO AS PARTICELLA, SUBALTERNO, NULL dt_inizio_val, NULL AS DT_FINE_VAL \
			  FROM DOCFA_UIU WHERE NOT exists (SELECT 1 FROM sit_oggetto_totale WHERE id_dwh = TO_CHAR(FORNITURA,'DD-MM-YYYY') || '|' || PROTOCOLLO_REG || '|'|| NR_PROG AND fk_ente_sorgente =? AND prog_es=?)
			  
SQL_OGG_COMPRAVENDITE=SELECT FABB.IID  AS ID_DWH, NULL ID_STORICO, FABB.SEZIONE_URBANA AS SEZIONE, FABB.FOGLIO, FABB.NUMERO AS PARTICELLA, FABB.SUBALTERNO, FABINFO.CATEGORIA, FABINFO.CLASSE, RENDITA_EURO RENDITA, \
					  FABINFO.ZONA, NULL FOGLIO_URBANO, FABINFO.SUPERFICIE, T_SCALA SCALA, T_INTERNO1 INTERNO, T_PIANO1 PIANO, NULL dt_inizio_val, NULL AS DT_FINE_VAL FROM mui_fabbricati_identifica FABB , \
					  mui_fabbricati_info fabinfo WHERE fabinfo.IID_FORNITURA = fabb.IID_FORNITURA AND  fabinfo.iId_nota = fabb.iId_nota AND fabinfo.id_immobile = fabb.id_immobile \
					  AND NOT exists (SELECT 1 FROM sit_oggetto_totale WHERE id_dwh = FABB.IID AND fk_ente_sorgente =? AND prog_es=?)*/
				    
SQL_OGG_FORNITURE_ELETTRICHE=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZIONE, FOGLIO, PARTICELLA, SUBALTERNO,DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL, \
							 PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, DT_EXP_DATO AS DT_EXP_DATO, NULL AS PROVENIENZA, \
							 NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, NULL AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
							 NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO, \
							 ANNO_RIFERIMENTO_DATI AS FIELD1, to_char(DATA_PRIMA_ATTIVAZIONE, 'dd/MM/yyyy') AS FIELD2, TIPO_UTENZA AS FIELD3, COMUNE_AMM_UBICAZIONE AS FIELD4, PROVINCIA_AMM_UBICAZIONE AS FIELD5, \
							 CAP_UBICAZIONE AS FIELD6, COMUNE_CATASTALE AS FIELD7, CODICE_COMUNE_CATASTALE AS FIELD8, INDIRIZZO_UBICAZIONE AS FIELD9, TIPO_UNITA AS FIELD10, \
							 ESTENSIONE_PARTICELLA AS FIELD11, TIPO_PARTICELLA AS FIELD12, CODICE_ASSENZA_CATASTO AS FIELD13, MESI_FATTURAZIONE AS FIELD14, KWH_FATTURATI AS FIELD15, \
							 SEGNO_IMPORTO AS FIELD16, SPESA_ANNUA AS FIELD17, TIPOLOGIA_FORNITURA AS FIELD18, ID_EXT_ENEL_UTENTE AS FIELD19 \
							 FROM sit_enel_utenza

SQL_OGG_SUCCESSIONI=SELECT UFFICIO || '|' || ANNO || '|' || VOLUME || '|' || NUMERO || '|' || SOTTONUMERO || '|' || COMUNE || '|' || PROGRESSIVO || '|' || PROGRESSIVO_IMMOBILE || '|' || FORNITURA AS ID_DWH, \
					NULL AS ID_STORICO, SEZIONE, FOGLIO, PARTICELLA1, SUBALTERNO1, PARTICELLA2, SUBALTERNO2, NULL AS DT_INIZIO_VAL, NULL AS DT_FINE_VAL, \
					NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, \
					NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, SUPERFICIE_MQ AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
					NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO, \
					NUMERATORE_QUOTA_DEF AS FIELD1, DENOMINATORE_QUOTA_DEF AS FIELD2, DIRITTO AS FIELD3, NATURA AS FIELD4, SUPERFICIE_ETTARI AS FIELD5, \
					VANI AS FIELD6, INDIRIZZO_IMMOBILE AS FIELD7 \
					FROM SUCCESSIONI_C \
					WHERE COMUNE = ? \
					AND NOT EXISTS (SELECT 1 FROM sit_oggetto_totale \
                    where id_dwh=UFFICIO || '|' || ANNO || '|' || VOLUME || '|' || NUMERO || '|' || SOTTONUMERO || '|' || COMUNE || '|' || PROGRESSIVO || '|' || PROGRESSIVO_IMMOBILE || '|' || FORNITURA \
                    AND fk_ente_sorgente =? AND prog_es=?)

SQL_OGG_CONCESSIONI=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZIONE, FOGLIO, PARTICELLA, SUBALTERNO,DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL, \
					PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, DT_EXP_DATO AS DT_EXP_DATO, PROVENIENZA AS PROVENIENZA, \
					NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, NULL AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
					NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO, \
					CODICE_FABBRICATO AS FIELD1, DESCRIZIONE AS FIELD2, ID_EXT_C_CONC_INDIRIZZI AS FIELD3, ID_EXT_C_CONCESSIONI AS FIELD4, TIPO AS FIELD5 \
					FROM SIT_C_CONCESSIONI_CATASTO

SQL_OGG_CATASTO=SELECT PKID_UIU ID_DWH, NULL ID_STORICO, id_sezc AS SEZIONE, FOGLIO, PARTICELLA, UNIMM AS SUBALTERNO,DATA_INIZIO_VAL dt_inizio_val, DATA_FINE_VAL AS DT_FINE_VAL, \
				NULL AS PROCESSID, DATA_INIZIO_VAL AS DT_INIZIO_DATO, DATA_FINE_VAL AS DT_FINE_DATO, NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, \
				DATA_LAV AS DATA_REGISTRAZIONE, CATEGORIA AS CATEGORIA, CLASSE AS CLASSE, RENDITA AS RENDITA, SUP_CAT AS SUPERFICIE, ZONA AS ZONA, FOGLIO_URBA AS FOGLIO_URBANO, \
				SCALA AS SCALA, INTERNO AS INTERNO, PIANO AS PIANO, \
				CONSISTENZA AS FIELD1, MICROZONA AS FIELD2, IDE_IMMO AS FIELD3, IDE_MUTA_INI AS FIELD4, IDE_MUTA_FINE AS FIELD5, \
				PARTITA AS FIELD6, ATTO_INI AS FIELD7, ATTO_FIN AS FIELD8, EDIFICIO AS FIELD9 \
				FROM SITICOMU, SITIUIU WHERE siticomu.COD_NAZIONALE = sitiuiu.COD_NAZIONALE \
				AND sitiuiu.COD_NAZIONALE = ? \
				AND NOT EXISTS (SELECT 1 FROM sit_oggetto_totale WHERE id_dwh=pkid_uiu and fk_ente_sorgente = ? and prog_es= ?)

SQL_OGG_LOCAZIONI=SELECT b.UFFICIO||'|'||b.ANNO||'|'||b.SERIE||'|'||b.NUMERO||'|'||b.SOTTONUMERO||'|'||b.PROG_NEGOZIO||'|'||b.PROG_IMMOBILE ID_DWH, NULL ID_STORICO, b.SEZ_URBANA AS SEZIONE, b.FOGLIO, b.PARTICELLA,b.SUBALTERNO, NULL dt_inizio_val, NULL DT_FINE_VAL, \
					NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, \
					NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, NULL AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
					NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO \
					, b.UFFICIO FIELD1 \
                	, b.ANNO FIELD2 \
                	, b.SERIE FIELD3 \
                	,b.NUMERO FIELD4 \
                	,null FIELD5 \
                	,to_char(DATA_FINE, 'dd/MM/yyyy') FIELD6 \
                	,to_char(DATA_STIPULA,'dd/MM/yyyy') FIELD7 \
                	,IMPORTO_CANONE FIELD8 \
					,OGGETTO_LOCAZIONE FIELD9 \
					,a.INDIRIZZO FIELD10 \
                  	FROM LOCAZIONI_I b, locazioni_a a \
                  	WHERE (B.CODICE_CAT is null or B.codice_cat in (select codent from sit_ente) ) \
                    AND a.ufficio = b.ufficio \
                   	AND a.anno = b.anno \
                   	and a.serie =  b.serie \
                   	and a.numero =  b.numero \
					and b.PARTICELLA IS NOT NULL AND NOT exists (select 1 from sit_fabbricato_totale where id_dwh = b.UFFICIO||'|'||b.ANNO||'|'||b.SERIE||'|'||b.NUMERO||'|'||b.SOTTONUMERO||'|'||b.PROG_NEGOZIO||'|'||b.PROG_IMMOBILE and fk_ente_sorgente =? and prog_es=?)
				
SQL_OGG_TRIBUTI_ICI=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZ AS SEZIONE, FOGLIO, NUMERO AS PARTICELLA, SUB AS SUBALTERNO,DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL, \
					PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, DT_EXP_DATO AS DT_EXP_DATO, PROVENIENZA AS PROVENIENZA, \
					NULL AS DATA_REGISTRAZIONE, CAT AS CATEGORIA, CLS AS CLASSE, NULL AS RENDITA, NULL AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
					SCALA AS SCALA, INTERNO AS INTERNO, PIANO AS PIANO, \
					YEA_DEN AS FIELD1, NUM_DEN AS FIELD2, YEA_RIF AS FIELD3, TIP_DEN AS FIELD4, DESC_TIP_DEN AS FIELD5, \
					TIP_VAL AS FIELD6, DESC_TIP_VAL AS FIELD7, VAL_IMM AS FIELD8, PRC_POSS AS FIELD9, CAR_IMM AS FIELD10, \
					DTR_ABI_PRI AS FIELD11, NUM_MOD AS FIELD12, NUM_RIGA AS FIELD13, SUF_RIGA AS FIELD14, FLG_IMM_STO AS FIELD15, \
					MESI_POS AS FIELD16, MESI_ESE AS FIELD17, MESI_RID AS FIELD18, FLG_POS3112 AS FIELD19, FLG_ESE3112 AS FIELD20, \
					FLG_RID3112 AS FIELD21, FLG_ABI_PRI3112 AS FIELD22, FLG_ACQ AS FIELD23, FLG_CSS AS FIELD24, YEA_PRO AS FIELD25, \
					NUM_PRO AS FIELD26, FLG_TRF AS FIELD27, DES_IND AS FIELD28, ID_EXT_VIA AS FIELD29, NUM_CIV AS FIELD30, ESP_CIV AS FIELD31 \
					FROM SIT_T_ICI_OGGETTO

SQL_OGG_TRIBUTI_TARSU=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZ AS SEZIONE, FOGLIO, NUMERO AS PARTICELLA, SUB AS SUBALTERNO,DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL, \
					  PROCESSID AS PROCESSID, DAT_INI AS DT_INIZIO_DATO, DAT_FIN AS DT_FINE_DATO, DT_EXP_DATO AS DT_EXP_DATO, PROVENIENZA AS PROVENIENZA, \
					  NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, SUP_TOT AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
					  SCALA AS SCALA, INTERNO AS INTERNO, PIANO AS PIANO, \
					  DES_CLS_RSU AS FIELD1, TIP_OGG AS FIELD2, DES_TIP_OGG AS FIELD3, DES_IND AS FIELD4, ID_EXT_VIA AS FIELD5, \
					  NUM_CIV AS FIELD6, ESP_CIV AS FIELD7 \
					  FROM SIT_T_TAR_OGGETTO
		  
SQL_OGG_DOCFA=SELECT PROTOCOLLO_REG ||'|'|| TO_CHAR(FORNITURA,'YYYYMMDD')||'|'|| TO_CHAR(NR_PROG) AS ID_DWH, NULL ID_STORICO, SEZIONE AS SEZIONE, FOGLIO, NUMERO AS PARTICELLA, SUBALTERNO, NULL dt_inizio_val, NULL AS DT_FINE_VAL, \
			  NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, \
			  NULL AS DATA_REGISTRAZIONE, PROP_CATEGORIA AS CATEGORIA, PROP_CLASSE AS CLASSE, PROP_RENDITA_EURO_CATA AS RENDITA, PROP_SUPERFICIE_CATA AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
			  SCALA AS SCALA, INTERNO AS INTERNO, NULL AS PIANO, \
			  TIPO_OPERAZIONE AS FIELD1, INDIR_FLAG AS FIELD2, INDIR_CODICE AS FIELD3, INDIR_TOPONIMO AS FIELD4, INDIR_NCIV_UNO AS FIELD5, \
			  INDIR_NCIV_DUE AS FIELD6, INDIR_NCIV_TRE AS FIELD7, RIF_MOD_1N AS FIELD8, PROP_ZONA_CENSUARIA AS FIELD9, PROP_CONSISTENZA AS FIELD10, \
			  ID_PLANIMETRIA AS FIELD11, FLAG_UIU_RECUPERATA AS FIELD12 \
			  FROM DOCFA_UIU WHERE (NUMERO IS NOT NULL OR SUBALTERNO is not null) and NOT exists (SELECT 1 FROM sit_oggetto_totale WHERE id_dwh = PROTOCOLLO_REG || '|'|| TO_CHAR(FORNITURA,'YYYYMMDD') || '|' || TO_CHAR(NR_PROG) AND fk_ente_sorgente =? AND prog_es=?)
			  
SQL_OGG_COMPRAVENDITE=SELECT FABB.IID  AS ID_DWH, NULL ID_STORICO, FABB.SEZIONE_URBANA AS SEZIONE, FABB.FOGLIO, FABB.NUMERO AS PARTICELLA, FABB.SUBALTERNO, FABINFO.CATEGORIA, FABINFO.CLASSE, RENDITA_EURO RENDITA, \
					  FABINFO.ZONA, NULL FOGLIO_URBANO, FABINFO.SUPERFICIE, T_SCALA SCALA, T_INTERNO1 INTERNO, T_PIANO1 PIANO, NULL dt_inizio_val, NULL AS DT_FINE_VAL, \
					  NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, \
					  NULL AS DATA_REGISTRAZIONE, CATEGORIA AS CATEGORIA, CLASSE AS CLASSE, RENDITA_EURO AS RENDITA, SUPERFICIE AS SUPERFICIE, ZONA AS ZONA, NULL AS FOGLIO_URBANO, \
					  NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO, \
					  FABB.TIPO_DENUNCIA AS FIELD1, FABB.NUMERO_PROTOCOLLO AS FIELD2, FABB.ANNO AS FIELD3, T_LOTTO AS FIELD4, T_EDIFICIO AS FIELD5, \
					  T_SCALA AS FIELD6, T_INTERNO1 AS FIELD7, T_INTERNO2 AS FIELD8, T_PIANO1 AS FIELD9, T_PIANO2 AS FIELD10, \
					  T_PIANO3 AS FIELD11, T_PIANO4 AS FIELD12, T_TOPONIMO AS FIELD13, T_INDIRIZZO AS FIELD14, T_CIVICO1 AS FIELD15, \
					  T_CIVICO2 AS FIELD16, T_CIVICO3 AS FIELD17, C_LOTTO AS FIELD18, C_EDIFICIO AS FIELD19, C_SCALA AS FIELD20, \
					  C_INTERNO1 AS FIELD21, C_INTERNO2 AS FIELD22, C_PIANO1 AS FIELD23, C_PIANO2 AS FIELD24, C_PIANO3 AS FIELD25, \
					  C_PIANO4 AS FIELD26, C_TOPONIMO AS FIELD27, C_INDIRIZZO AS FIELD28, C_CIVICO1 AS FIELD29, C_CIVICO2 AS FIELD30, C_CIVICO3 AS FIELD31 \
					  FROM mui_fabbricati_identifica FABB , \
					  mui_fabbricati_info fabinfo WHERE fabinfo.IID_FORNITURA = fabb.IID_FORNITURA AND  fabinfo.iId_nota = fabb.iId_nota AND fabinfo.id_immobile = fabb.id_immobile \
					  AND (FABB.NUMERO IS NOT NULL OR FABB.SUBALTERNO is not null) and NOT exists (SELECT 1 FROM sit_oggetto_totale WHERE id_dwh = FABB.IID AND fk_ente_sorgente =? AND prog_es=?)  
				    
SQL_OGG_ACQUA=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZIONE, FOGLIO, PARTICELLA, SUBALTERNO,DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL, \
                      PROCESSID AS PROCESSID, DT_INIZIO_DATO, DT_FINE_DATO, DT_EXP_DATO, NULL AS PROVENIENZA, \
                      NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, NULL AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
                      NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO, \
                      ESTENSIONE_PART AS FIELD1, TIPOLOGIA_PART AS FIELD2 \
                      FROM SIT_ACQUA_CATASTO
					  
SQL_OGG_R_TARES=select distinct \
                i.id as id_dwh, i.id_ext ID_STORICO,\
                i.sez AS SEZIONE, i.foglio, i.particella,i.sub AS SUBALTERNO , I.CAT AS CATEGORIA,\
                i.PROCESSID,\
                i.DT_INIZIO_DATO,\
                i.DT_FINE_DATO,\
                i.DT_EXP_DATO,\
                i.DT_INIZIO_VAL,\
                i.DT_FINE_VAL AS DT_FINE_VAL,\
                v.ANNO AS FIELD1,\
                v.TIPO AS FIELD2,\
                i.importo AS FIELD3,\
                i.cod_tributo AS FIELD4,\
                i.mq as FIELD5,\
                I.DES_CAT as FIELD6,\
                V.ID AS FIELD7,\
                V.NOMINATIVO_CONTRIB AS FIELD8,\
                V.CODFISC AS FIELD9 \
                from sit_ruolo_tares_imm i , sit_ruolo_tares v \
                where I.id_ext_ruolo=V.ID_EXT and (i.foglio is not null or I.PARTICELLA is not null)
                
SQL_OGG_CENED=SELECT B.ID AS ID_DWH, \
	       B.SEZIONE, \
	       B.FOGLIO, \
	       B.PARTICELLA, \
	       B.SUB_TUTTI AS SUB, \
	       B.INDIRIZZO AS FIELD1, \
	       B.DENOM_PROPRIETARIO AS FIELD2, \
	       B.DENOM_CERTIFICATORE AS FIELD3, \
	       to_char(B.DATA_PROT, 'dd/MM/yyyy') AS FIELD4, \
	       B.CODICE_IDENTIFICATIVO_PRATICA AS FIELD5, \
	       B.CLASSE_ENERGETICA AS FIELD6, \
	       B.DESTINAZIONE_DI_USO AS FIELD7, \
	       B.MOTIVAZIONE_ACE AS FIELD8 \
	       FROM DATI_TEC_FABBR_CERT_ENER B \
	       WHERE B.BELFIORE in (select codent from sit_ente)  \
	       AND NOT exists ( select 1 from sit_oggetto_totale where id_dwh = B.ID and fk_ente_sorgente =? and prog_es =? )
                     
/*#############################################################################################################################################################################################################*/
/*########################################      Query CIVICI    #############################################################################################################################################*/
/*#############################################################################################################################################################################################################*/

SQL_CIV_FORNITURE_ELETTRICHE=select utenza.ID ID_DWH, utenza.ID_EXT ID_STORICO, utenza.DT_FINE_VAL AS DT_FINE_VAL, utenza.INDIRIZZO_UBICAZIONE INDIRIZZO, \
					utente.DENOMINAZIONE AS FIELD1, utente.CODICE_FISCALE AS FIELD2, ANNO_RIFERIMENTO_DATI AS FIELD3 \
					from sit_enel_utenza utenza inner join  SIT_ENEL_UTENTE utente \
                    on ( utenza.ID_EXT_ENEL_UTENTE = utente.ID_EXT ) 
					
SQL_CIV_GAS=select ID ID_DWH, ID_EXT ID_STORICO, DT_FINE_VAL AS DT_FINE_VAL, INDIRIZZO_UTENZA INDIRIZZO, \
					COGNOME_UTENTE AS FIELD1, NOME_UTENTE AS FIELD2, RAGIONE_SOCIALE AS FIELD3, INDIRIZZO_UTENZA AS FIELD4, \
					IDENTIFICATIVO_UTENZA AS FIELD5, ANNO_RIFERIMENTO AS FIELD6 \
					from SIT_U_GAS
					
SQL_CIVICO_DEMOGRAFIA=SELECT C.ID AS ID_DWH,C.ID_EXT AS ID_STORICO, C.DT_FINE_VAL AS DT_FINE_VAL, C.CIVICO_COMPOSTO,\
				   C.CIV_LIV1,C.CIV_LIV2,C.CIV_LIV3,\
				   V.ID AS ID_ORIG_VIA, C.ID_ORIG CODICE_CIVICO, V.DESCRIZIONE AS INDIRIZZO \
				   FROM SIT_D_CIVICO_V C \
				   ,SIT_D_VIA V \
				   WHERE C.ID_EXT_D_VIA = V.ID_EXT \
				   AND V.DT_FINE_VAL IS NULL
				   
SQL_CIVICO_CATASTO=SELECT V.PKID_STRA AS ID_ORIG_VIA, \
				   TO_CHAR(C.PKID_CIVI) AS ID_DWH, NULL AS ID_STORICO, \
				   DECODE(TO_CHAR(c.data_fine_val,'dd/MM/yyyy'),'31/12/9999',TO_DATE(null),c.data_fine_val) AS DT_FINE_VAL, \
				   '<civicocomposto><att tipo=\"numero\" valore=\"'||C.CIVICO||'\"/></civicocomposto>' AS CIVICO_COMPOSTO, \
				   C.CIVICO AS CIV_LIV1, NULL AS CIV_LIV2, NULL AS CIV_LIV3 \
				   FROM SITICIVI C,SITIDSTR V \
				   WHERE C.PKID_STRA = V.PKID_STRA \
				   AND V.DATA_FINE_VAL = TO_DATE('31/12/9999','DD/MM/YYYY') \
				   AND NOT exists \
				   (select 1 from sit_civico_totale where id_dwh = TO_CHAR(C.PKID_CIVI) and fk_ente_sorgente =? and prog_es=?)				  
				   
SQL_CIVICO_CATASTO2=SELECT DISTINCT LID.ID_IMM || '|' || LID.PROGRESSIVO || '|' || LID.SEQ || '|' || LID.CODI_FISC_LUNA || '|' || LID.SEZIONE AS ID_DWH, \
       NULL AS ID_STORICO, \
       NULL AS DT_FINE_VAL, \
       civ1, civ2, civ3, \
       t.descr PREFISSO, ind.ind AS NOME, COD_STRADA AS NUMERO, \
       FOGLIO FIELD1, MAPPALE FIELD2, SUB FIELD3, GRAFFATO FIELD4 \
  FROM load_cat_uiu_ind IND, cat_d_toponimi t, siticomu c, LOAD_CAT_UIU_ID LID \
 WHERE c.cODI_FISC_LUNA = ? \
   AND LID.codi_fisc_luna = ind.codi_fisc_luna || '' \
   AND c.sezione_censuaria = LID.sez \
   AND LID.sezione = ind.sezione \
   AND LID.id_imm = ind.id_imm \
   AND LID.progressivo = ind.progressivo \
   AND t.pk_id = ind.toponimo + 0 \
   AND c.codi_fisc_luna = ind.codi_fisc_luna \
   AND IND.TODELETE ='0' \
   AND IND.SEQ = (SELECT MAX(SEQ) \
                    FROM load_cat_uiu_ind IND21 \
                   WHERE IND21.ID_IMM = IND.ID_IMM \
                     AND IND21.CODI_FISC_LUNA = IND.CODI_FISC_LUNA \
                     AND IND21.PROGRESSIVO = IND.PROGRESSIVO \
                     AND ind21.SEZIONE = ind.SEZIONE \
                     AND ind21.todelete ='0') \
   AND LID.SEQ = (SELECT MAX(SEQ) \
                    FROM load_cat_uiu_id LID2 \
                   WHERE LID2.ID_IMM = LID.ID_IMM \
                     AND LID2.CODI_FISC_LUNA = LID.CODI_FISC_LUNA \
                     AND LID2.PROGRESSIVO = LID.PROGRESSIVO \
                     AND LID2.SEZIONE = LID.SEZIONE \
                     AND lid2.foglio = lid.foglio \
                     AND lid2.mappale = lid.mappale \
                     AND lid2.sub = lid.sub) \
   AND IND.PROGRESSIVO = (SELECT MAX(PROGRESSIVO) \
                            FROM load_cat_uiu_ind IND22 \
                           WHERE IND22.ID_IMM = IND.ID_IMM \
                             AND IND22.CODI_FISC_LUNA = IND.CODI_FISC_LUNA \
                              AND ind22.SEZIONE = ind.SEZIONE \
                             AND ind22.todelete ='0') \
                    AND NOT EXISTS (SELECT 1 \
                     FROM sit_civico_totale \
                    WHERE id_dwh = LID.ID_IMM || '|' || LID.PROGRESSIVO || '|' || LID.SEQ || '|' || LID.CODI_FISC_LUNA || '|' || LID.SEZIONE \
                      AND fk_ente_sorgente = ? \
                      AND prog_es = ?) \
                      AND LTRIM(RTRIM(TRANSLATE(ind.ind, '0123456789', '          '))) IS NOT NULL
                     
SQL_CIV_LOCAZIONI=select * from (SELECT UFFICIO||'|'||ANNO||'|'||SERIE||'|'||NUMERO||'|'||SOTTONUMERO||'|'||PROG_NEGOZIO AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, INDIRIZZO, NULL CODICE_VIA \
				, UFFICIO FIELD1 \
				, ANNO FIELD2 \
				, SERIE FIELD3 \
				,NUMERO FIELD4 \
				,to_char(DATA_FINE, 'dd/MM/yyyy') FIELD5 \
        		,to_char(DATA_STIPULA,'dd/MM/yyyy') FIELD6 \
				,IMPORTO_CANONE FIELD7 \
				,OGGETTO_LOCAZIONE FIELD8 \
                  FROM  locazioni_a ) l \
                  WHERE NOT exists \
                   (select 1 from sit_civico_totale ct where ct.id_dwh = l.id_dwh and ct.fk_ente_sorgente =? and ct.prog_es=?)
				          
SQL_CIV_LOCAZIONI2=SELECT b.UFFICIO||'|'||b.ANNO||'|'||b.SERIE||'|'||b.NUMERO||'|'||b.SOTTONUMERO||'|'||b.PROG_NEGOZIO||'|'||b.PROG_SOGGETTO AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, CIVICO_RESIDENZA AS CIVICO \
					, b.UFFICIO FIELD1 \
					, b.ANNO FIELD2 \
					, b.SERIE FIELD3 \
					, b.NUMERO FIELD4 \
					, PROG_SOGGETTO FIELD5 \
					,to_char(DATA_FINE, 'dd/MM/yyyy') FIELD6 \
         			,to_char(DATA_STIPULA,'dd/MM/yyyy') FIELD7 \
					, IMPORTO_CANONE FIELD8 \
					, OGGETTO_LOCAZIONE FIELD9 \
					,a.INDIRIZZO FIELD10 \
                  FROM LOCAZIONI_B b , SIT_ENTE E  , locazioni_a a \
                   WHERE E.CODENT = ? \
                   AND UPPER(TRIM(CITTA_RESIDENZA))=E.DESCRIZIONE \
                   AND a.ufficio = b.ufficio \
                   AND a.anno = b.anno \
                   and a.serie =  b.serie \
                   and a.numero =  b.numero \
                   AND NOT exists \
                   (select 1 from sit_civico_totale where id_dwh = b.UFFICIO||'|'||b.ANNO||'|'||b.SERIE||'|'||b.NUMERO||'|'||b.SOTTONUMERO||'|'||b.PROG_NEGOZIO||'|'||b.PROG_SOGGETTO and fk_ente_sorgente =? and prog_es=?)
				   
SQL_CIV_LOCAZIONI3=SELECT b.UFFICIO||'|'||b.ANNO||'|'||b.SERIE||'|'||b.NUMERO||'|'||b.SOTTONUMERO||'|'||b.PROG_NEGOZIO||'|'||b.PROG_IMMOBILE AS ID_DWH, NULL AS ID_STORICO, NULL AS DT_FINE_VAL, \
                  b.INDIRIZZO \
                , b.UFFICIO FIELD1 \
                , b.ANNO FIELD2 \
                , b.SERIE FIELD3 \
                ,b.NUMERO FIELD4 \
                ,null FIELD5 \
                ,to_char(DATA_FINE, 'dd/MM/yyyy') FIELD6 \
                ,to_char(DATA_STIPULA,'dd/MM/yyyy') FIELD7 \
                ,IMPORTO_CANONE FIELD8 \
				,OGGETTO_LOCAZIONE FIELD9 \
				,a.INDIRIZZO FIELD10 \
                  FROM LOCAZIONI_I b, locazioni_a a \
                  WHERE (B.CODICE_CAT is null or B.codice_cat in (select codent from sit_ente) ) \
                   AND a.ufficio = b.ufficio \
                   AND a.anno = b.anno \
                   and a.serie =  b.serie \
                   and a.numero =  b.numero \
                  AND NOT exists \
                  (select 1 from sit_civico_totale where id_dwh = b.UFFICIO||'|'||b.ANNO||'|'||b.SERIE||'|'||b.NUMERO||'|'||b.SOTTONUMERO||'|'||b.PROG_NEGOZIO||'|'||b.PROG_IMMOBILE and fk_ente_sorgente =? \
                   and prog_es=?)
                   
SQL_CIVICO_TRIBUTI_ICI=SELECT DISTINCT iciv.ID || '|' || NVL(icio.NUM_CIV, '') || '|' || NVL(icio.ESP_CIV, '') AS ID_DWH, \
						iciv.ID_EXT ID_STORICO, icio.NUM_CIV AS CIV_LIV1, icio.ESP_CIV AS CIV_LIV2, NULL AS CIV_LIV3, iciv.ID AS ID_ORIG_VIA, \
						iciv.PREFISSO AS VIASEDIME, iciv.DESCRIZIONE INDIRIZZO, iciv.DT_FINE_VAL, iciv.ID_ORIG AS CODICE_CIVICO \
						FROM SIT_T_ICI_OGGETTO icio INNER JOIN SIT_T_ICI_VIA iciv ON (icio.ID_EXT_VIA = iciv.ID_EXT ) 
SQL_CIVICO_TRIBUTI_TARSU=SELECT DISTINCT iciv.ID || '|' || NVL(icio.NUM_CIV, '') || '|' || NVL(icio.ESP_CIV, '') AS ID_DWH, \
						iciv.ID_EXT ID_STORICO, icio.NUM_CIV AS CIV_LIV1, icio.ESP_CIV AS CIV_LIV2, NULL AS CIV_LIV3, iciv.ID AS ID_ORIG_VIA, \
						iciv.PREFISSO AS VIASEDIME, iciv.DESCRIZIONE INDIRIZZO, iciv.DT_FINE_VAL, iciv.ID_ORIG AS CODICE_CIVICO \
						FROM SIT_T_TAR_OGGETTO icio INNER JOIN SIT_T_TAR_VIA iciv ON (icio.ID_EXT_VIA = iciv.ID_EXT ) 
						
SQL_CIVICO_CONCESSIONI_PRATICA=SELECT c.ID AS id_dwh, c.id_ext id_storico, ci.sedime AS viasedime, \
							       ci.indirizzo AS indirizzo, c.dt_fine_val, codice_via AS codice_via, \
							       civ_liv1, null civ_liv2, null civ_liv3 , c.id AS ID_ORIG_VIA, \
							       c.concessione_numero field1, c.protocollo_numero field2, \
							       to_char(c.protocollo_data, 'dd/MM/yyyy') field3, tipo_intervento field4, oggetto field5, \
							       to_char(data_rilascio, 'dd/MM/yyyy') field6, to_char(data_inizio_lavori, 'dd/MM/yyyy') field7, \
							       to_char(data_fine_lavori, 'dd/MM/yyyy') field8 \
							  FROM sit_c_conc_indirizzi ci ,  sit_c_concessioni c \
							 WHERE ci.id_ext_c_concessioni = c.id_ext

SQL_CIV_SUCCESSIONI_OGGETTO=SELECT  UFFICIO || '|' || ANNO || '|' || VOLUME || '|' || NUMERO || '|' || SOTTONUMERO || '|' || COMUNE || '|' || PROGRESSIVO || '|' || PROGRESSIVO_IMMOBILE || '|' || FORNITURA AS ID_DWH, \
							NULL AS ID_STORICO,NULL AS VIASEDIME, INDIRIZZO_IMMOBILE AS INDIRIZZO,NULL AS CIV_LIV1,NULL AS CIV_LIV2, NULL AS CIV_LIV3, \
							UFFICIO || '|' || ANNO || '|' || VOLUME || '|' || NUMERO || '|' || SOTTONUMERO || '|' || COMUNE || '|' || PROGRESSIVO || '|' || PROGRESSIVO_IMMOBILE || '|' || FORNITURA AS ID_ORIG_VIA, \
							NULL AS DT_FINE_VAL, \
							FOGLIO AS FIELD1, PARTICELLA1 AS FIELD2, SUBALTERNO1 AS FIELD3, NATURA AS FIELD4, UFFICIO AS FIELD5, ANNO AS FIELD6, \
							VOLUME AS FIELD7, NUMERO AS FIELD8, SOTTONUMERO AS FIELD9, COMUNE AS FIELD10, PROGRESSIVO AS FIELD11 \
							FROM SUCCESSIONI_C WHERE COMUNE = ? \
							AND  NOT exists \
							(select 1 from sit_civico_totale where id_dwh = UFFICIO || '|' || ANNO || '|' || VOLUME || '|' || NUMERO || '|' || SOTTONUMERO || '|' || COMUNE || '|' || PROGRESSIVO || '|' || PROGRESSIVO_IMMOBILE || '|' || FORNITURA and fk_ente_sorgente =? and prog_es=?)
                 
SQL_CIVICO_LIC_COMM=SELECT DISTINCT lcc.ID AS ID_DWH, lcc.ID_EXT AS ID_STORICO, lcc.CIVICO AS CIV_LIV1, lcc.CIVICO2 AS CIV_LIV2, lcc.CIVICO3 AS CIV_LIV3, lcv.ID AS ID_ORIG_VIA, \
                    lcv.SEDIME AS VIASEDIME, lcv.INDIRIZZO AS INDIRIZZO, lcc.DT_FINE_VAL, lcc.ID_ORIG AS CODICE_CIVICO, \
                    lcc.NUMERO as FIELD1, lcc.RAG_SOC as FIELD2, lcc.TIPOLOGIA as FIELD3, lcc.CIVICO as FIELD4, to_char(lcc.DATA_VALIDITA, 'dd/MM/yyyy') as FIELD5, to_char(lcc.DATA_RILASCIO, 'dd/MM/yyyy') as FIELD6 \
                    FROM SIT_LICENZE_COMMERCIO lcc INNER JOIN SIT_LICENZE_COMMERCIO_VIE lcv \
                    ON (lcc.ID_EXT_VIE = lcv.ID_EXT)					
				
SQL_CIVICO_REDDITI_DICHIARANTE=SELECT red_dat_ana.IDE_TELEMATICO || '|' || red_dat_ana.CODICE_FISCALE_DIC  AS ID_DWH, NULL AS ID_STORICO, NULL AS VIASEDIME, INDIRIZZO_ATTUALE AS INDIRIZZO, NULL AS CIV_LIV1,NULL AS CIV_LIV2, NULL AS CIV_LIV3 \
					, RED_DAT_ANA.IDE_TELEMATICO || '|' || RED_DAT_ANA.CODICE_FISCALE_DIC AS ID_ORIG_VIA, NULL AS DT_FINE_VAL \
					, red_dat_ana.CODICE_FISCALE_DIC FIELD1 \
					, COGNOME FIELD2 \
					, RED_DAT_ANA.NOME FIELD3 \
					, C.NOME FIELD4 \
					, DENOMINAZIONE FIELD5 \
					, to_char(TO_DATE(DATA_NASCITA,'YYYYMMDD'),'dd/mm/yyyy' ) FIELD6 \
					, RED_DAT_ANA.ANNO_IMPOSTA FIELD7 \
                   FROM red_dati_anagrafici RED_DAT_ANA, red_domicilio_fiscale RED_DOM_FISC, SITICOMU C \
                    WHERE RED_DAT_ANA.IDE_TELEMATICO = RED_DOM_FISC.IDE_TELEMATICO \
                    AND RED_DAT_ANA.CODICE_FISCALE_DIC = RED_DOM_FISC.CODICE_FISCALE_DIC \
                    AND RED_DAT_ANA.ANNO_IMPOSTA = RED_DOM_FISC.ANNO_IMPOSTA \
                    AND COMUNE_NASCITA = C.COD_NAZIONALE (+) \
                    AND  NOT exists \
					(select 1 from sit_civico_totale where ID_DWH = red_dat_ana.IDE_TELEMATICO || '|' || red_dat_ana.CODICE_FISCALE_DIC and fk_ente_sorgente =? and prog_es=?)
				   
SQL_CIVICO_DOCFA=SELECT PROTOCOLLO_REG || '|'|| TO_CHAR(FORNITURA,'YYYYMMDD') || '|' || NR_PROG AS ID_DWH, NULL ID_STORICO, NULL AS VIASEDIME, INDIR_TOPONIMO AS INDIRIZZO, INDIR_NCIV_UNO AS CIV_LIV1,  INDIR_NCIV_DUE AS CIV_LIV2,  INDIR_NCIV_TRE AS CIV_LIV3, \
				 NULL DT_FINE_VAL, TO_CHAR(FORNITURA,'YYYYMMDD') || '|' || PROTOCOLLO_REG || '|'|| NR_PROG AS ID_ORIG_VIA, NULL AS CODICE_CIVICO, \
				 FOGLIO AS FIELD1, NUMERO AS FIELD2, SUBALTERNO AS FIELD3, PROTOCOLLO_REG AS FIELD4, TO_CHAR(FORNITURA,'dd/MM/yyyy') AS FIELD5 \
				 FROM DOCFA_UIU \
				 WHERE INDIR_TOPONIMO  is not null AND  INDIR_NCIV_UNO is not null \
				 AND NOT EXISTS (SELECT 1 FROM sit_civico_totale WHERE id_dwh = PROTOCOLLO_REG || '|'|| TO_CHAR(FORNITURA,'YYYYMMDD') || '|' || NR_PROG AND fk_ente_sorgente =? AND prog_es =?)
        
SQL_CIV_COMPRAV_SOGG=SELECT  IID AS ID_DWH, NULL ID_STORICO, NULL AS VIASEDIME, INDIRIZZO AS INDIRIZZO, NULL AS CIV_LIV1,  NULL AS CIV_LIV2,  NULL AS CIV_LIV3, NULL DT_FINE_VAL, IID AS ID_ORIG_VIA, NULL AS CODICE_CIVICO, \
					COMUNE as FIELD1, PROVINCIA as FIELD2, CAP as FIELD3 \
					FROM MUI_INDIRIZZI_SOG WHERE NOT EXISTS (SELECT 1 FROM sit_civico_totale WHERE id_dwh = IID AND fk_ente_sorgente =? AND prog_es =?)
					
SQL_CIV_COMPRAV_OGG=SELECT FABB.IID AS ID_DWH , NULL ID_STORICO, NULL AS DT_FINE_VAL, T.DESCR VIASEDIME , C_INDIRIZZO INDIRIZZO, C_CIVICO1 AS CIV_LIV1,  NULL AS CIV_LIV2,  NULL AS CIV_LIV3, NULL DT_FINE_VAL, FABB.IID AS ID_ORIG_VIA, \
					FABB.FOGLIO as FIELD1, FABB.NUMERO as FIELD2, FABB.SUBALTERNO as FIELD3	\
					FROM mui_fabbricati_identifica FABB , mui_fabbricati_info fabinfo, CAT_D_TOPONIMI T WHERE fabinfo.IID_FORNITURA = fabb.IID_FORNITURA AND  fabinfo.iId_nota = fabb.iId_nota AND fabinfo.id_immobile = fabb.id_immobile \
				    AND T.PK_ID = fabinfo.C_TOPONIMO (+)  AND NOT EXISTS (SELECT 1 FROM sit_civico_totale WHERE id_dwh = FABB.IID AND fk_ente_sorgente =? AND prog_es =?)

SQL_CIV_COSAP_CONTRIB=SELECT DISTINCT ID AS id_dwh, \
	                  id_ext id_storico, civico AS civ_liv1, \
	                  null AS civ_liv2, NULL AS civ_liv3, \
	                  ID AS id_orig_via, sedime AS viasedime, \
	                  indirizzo, dt_fine_val, \
	                  id_orig AS codice_civico \
	           		  FROM sit_t_cosap_contrib
	           		  
SQL_CIV_COSAP_TASSA=SELECT ID AS id_dwh, id_ext id_storico, sedime AS viasedime, \
                       indirizzo, civico AS civ_liv1, NULL AS civ_liv2, \
                       NULL AS civ_liv3, dt_fine_val, ID AS id_orig_via, \
                       id_orig AS codice_civico, \
                       cod_univoco_canone as FIELD1, numero_documento as FIELD2, \
                       anno_documento as FIELD3, tipo_occupazione as FIELD4, \
                       codice_immobile as FIELD5, codice_via as FIELD6, \
                       foglio as FIELD7, particella as FIELD8, \
                       subalterno as FIELD9, quantita as FIELD10, \
                       importo_canone as FIELD11 \
                       FROM sit_t_cosap_tassa

SQL_CIV_PUBBLICITA_DETTAGLIO=SELECT ID AS id_dwh, id_ext id_storico, NULL AS viasedime, \
                       via AS INDIRIZZO, civico AS civ_liv1, NULL AS civ_liv2, NULL AS civ_liv3, \
                       dt_fine_val, ID AS id_orig_via, id_orig AS codice_civico, tipo_pratica AS FIELD1, \
                       num_pratica AS FIELD2, anno_pratica AS FIELD3, desc_cls AS FIELD4, desc_oggetto AS FIELD5, \
                       TO_CHAR(dt_inizio, 'dd/MM/yyyy') AS FIELD6,TO_CHAR(dt_fine, 'dd/MM/yyyy') AS FIELD7,\
                       indirizzo  AS FIELD8, giorni_occupazione AS FIELD9,\
                       cod_zona_cespite AS FIELD10, cod_caratteristica  AS FIELD11 \
                       FROM sit_pubblicita_prat_dettaglio  
                       
SQL_CIV_PORTALESERVIZI=SELECT ID AS id_dwh, NULL id_storico, NULL AS viasedime, \
                      via_residenza AS INDIRIZZO, civico_residenza AS civ_liv1, NULL AS civ_liv2, NULL AS civ_liv3, \
                      NULL dt_fine_val, ID AS id_orig_via, null AS codice_civico \
					  FROM PS_ANAGRAFICA_VIEW \
					  WHERE NOT EXISTS \
				          (SELECT 1 FROM sit_civico_totale WHERE id_dwh = id AND fk_ente_sorgente = ? AND prog_es = ?)
				          
SQL_CIV_ACQUA_UTENTE=SELECT ID AS id_dwh, id_ext id_storico, NULL AS viasedime, via_residenza AS indirizzo, \
				       civico_residenza AS civ_liv1, NULL AS civ_liv2, NULL AS civ_liv3, dt_fine_val, \
				       ID AS id_orig_via, id_orig AS codice_civico, cognome AS field1, \
				       nome AS field2, cod_fiscale AS field3, denominazione AS field4, \
				       part_iva AS field5, cap_residenza AS field6, telefono AS field7, \
				       fax_email AS field8 \
				  FROM SIT_ACQUA_UTENTE
			
SQL_CIV_ACQUA_UTENZE=SELECT ID AS id_dwh, id_ext id_storico, NULL AS viasedime, via_ubicazione AS indirizzo, \
				       civico_ubicazione AS civ_liv1, NULL AS civ_liv2, NULL AS civ_liv3, dt_fine_val, \
				       ID AS id_orig_via, id_orig AS codice_civico, rag_soc_ubicazione AS field1, \
				       cap_ubicazione AS field2, consumo_medio AS field3, stacco AS field4, \
				       giro AS field5 \
				  FROM SIT_ACQUA_UTENZE
                       
SQL_CIV_ECOGRAFICO=SELECT V.ID AS ID_ORIG_VIA, C.ID AS ID_DWH, NULL AS ID_STORICO, DATA_FINE_VAL AS DT_FINE_VAL, C.NUMERO AS CIV_LIV1, C.ESP1 AS CIV_LIV2, C.ESP2 AS CIV_LIV3,C.DESCRIZIONE_CIVICO AS FIELD1, C.FOGLIO_CT AS FIELD2, C.PARTICELLA_CT AS FIELD3, C.DESCR_STRADA AS FIELD4, C.TIPO_CIVICO AS FIELD5, C.TIPO_ACCESSO AS FIELD6, C.LATO_STRADA AS FIELD7, C.ACCESSIBILITA AS FIELD8, C.DESCR_DEST_USO AS FIELD9 FROM EC_TOP_CIVICI C INNER JOIN EC_TOP_STRADE V ON C.FK_STRADE = V.UK_STRADA  WHERE NOT exists (select 1 from sit_civico_totale where id_dwh = c.id and fk_ente_sorgente =? and prog_es =?) 
	           		
SQL_CIV_REDD_ANALITICI=SELECT ID AS ID_DWH, ID_EXT AS ID_STORICO, DT_FINE_VAL AS DT_FINE_VAL, NULL AS VIASEDIME \
                    , INDIRIZZO_RESIDENZA AS INDIRIZZO \
                    , NULL AS CIV_LIV1,NULL AS CIV_LIV2, NULL AS CIV_LIV3 \
                    , ID as ID_ORIG_VIA \
                    , CODICE_FISCALE FIELD1 \
                    , COGNOME FIELD2 \
                    , NOME FIELD3 \
                    , DENOMINAZIONE FIELD4 \
                    , to_char(DATA_NASCITA,'dd/mm/yyyy' ) FIELD5 \
					, ANNO_IMPOSTA FIELD6 \
                   FROM red_an_dati_anagrafici \
                   WHERE INDIRIZZO_residenza is not null
                   
SQL_CIV_CONCEDI_VISURE=SELECT inxdoc||'|'||tipo_atto AS ID_DWH, \
					inxdoc||'|'||tipo_atto AS ID_STORICO,\
                    TPV||' '||NOME_VIA AS INDIRIZZO,\
                    CIVICO AS CIV_LIV1, CIVICO_SUB  AS CIV_LIV2, ALTRICIV AS CIV_LIV3, \
                    inxdoc||'|'||tipo_atto as ID_ORIG_VIA, \
                    NUM_PROT_GEN   AS FIELD1,  ANNO_PROT_GEN AS FIELD2, NUM_PROT_SETT  AS FIELD3,\
                    TIPO_ATTO AS FIELD4, NUMERO_ATTO AS FIELD5, DATA_DOC AS FIELD6,  INXDOC AS FIELD7, TPV||' '||NOME_VIA AS FIELD8 \
                    FROM MI_CONC_EDILIZIE_VISURE \
                    WHERE NOT exists (SELECT 1 FROM sit_civico_totale WHERE id_dwh = inxdoc||'|'||tipo_atto AND fk_ente_sorgente =? AND prog_es=?)
                    
SQL_CIV_R_TARSU_CONTRIB=select DISTINCT v.ID AS ID_DWH,\
                ID_EXT AS ID_STORICO,\
                V.DT_FINE_VAL AS DT_FINE_VAL,\
                replace(V.INDIRIZZO,'','.') AS INDIRIZZO,\
                v.ANNO AS FIELD1,\
                v.TIPO AS FIELD2,\
                V.TOT_NETTO AS FIELD3,\
                v.TOTALE AS FIELD4,\
                null as FIELD5,\
                v.comune AS FIELD6,\
                v.prov AS FIELD7, \
                v.estero AS FIELD8,\
                V.NOMINATIVO_CONTRIB AS FIELD9,\
                V.CODFISC AS FIELD10 \
                from sit_ruolo_tarsu v \
                where v.indirizzo is not null and estero is null and replace(v.COMUNE,'''', '`' )=(select descrizione from sit_ente)         

SQL_CIV_R_TARES_CONTRIB=select DISTINCT v.ID AS ID_DWH,\
                ID_EXT AS ID_STORICO,\
                V.DT_FINE_VAL AS DT_FINE_VAL,\
                replace(V.INDIRIZZO,'','.') AS INDIRIZZO,\
                v.ANNO AS FIELD1,\
                v.TIPO AS FIELD2,\
                V.TOT_NETTO AS FIELD3,\
                v.TOTALE AS FIELD4,\
                v.nimm as FIELD5,\
                v.comune AS FIELD6,\
                v.prov AS FIELD7, \
                v.estero AS FIELD8,\
                V.NOMINATIVO_CONTRIB AS FIELD9,\
                V.CODFISC AS FIELD10 \
                from sit_ruolo_tares v \
                where v.indirizzo is not null and estero is null and replace(v.COMUNE,'''', '`' )=(select descrizione from sit_ente)   
                
SQL_CIV_R_TARSU_IMM=select DISTINCT i.ID AS ID_DWH,\
                i.ID_EXT AS ID_STORICO,\
                i.DT_FINE_VAL AS DT_FINE_VAL,\
                i.INDIRIZZO AS INDIRIZZO,\
                i.PROCESSID,\
                i.DT_INIZIO_DATO,\
                i.DT_FINE_DATO,\
                i.DT_EXP_DATO,\
                i.DT_INIZIO_VAL,\
                v.ANNO AS FIELD1,\
                v.TIPO AS FIELD2,\
                i.importo AS FIELD3,\
                i.cod_tributo AS FIELD4,\
                i.mq as FIELD5,\
                I.DES_CAT as FIELD6,\
                V.ID AS FIELD7,\
                V.NOMINATIVO_CONTRIB AS FIELD8, \
                V.CODFISC AS FIELD9 \
                from sit_ruolo_tarsu_imm i , sit_ruolo_tarsu v \
                where I.id_ext_ruolo=V.ID_EXT and i.indirizzo is not null
                
SQL_CIV_R_TARES_IMM=select DISTINCT i.ID AS ID_DWH,\
                i.ID_EXT AS ID_STORICO,\
                i.DT_FINE_VAL AS DT_FINE_VAL,\
                i.INDIRIZZO AS INDIRIZZO,\
                i.PROCESSID,\
                i.DT_INIZIO_DATO,\
                i.DT_FINE_DATO,\
                i.DT_EXP_DATO,\
                i.DT_INIZIO_VAL,\
                v.ANNO AS FIELD1,\
                v.TIPO AS FIELD2,\
                i.importo AS FIELD3,\
                i.cod_tributo AS FIELD4,\
                i.mq as FIELD5,\
                I.DES_CAT as FIELD6,\
                V.ID AS FIELD7,\
                V.NOMINATIVO_CONTRIB AS FIELD8, \
                V.CODFISC AS FIELD9 \
                from sit_ruolo_tares_imm i , sit_ruolo_tares v \
                where I.id_ext_ruolo=V.ID_EXT and i.indirizzo is not null

SQL_CIV_DEMANIO=select DISTINCT i.ID AS ID_DWH, \
                i.descr_via as indirizzo,\
                i.civico as CIV_LIV1,\
                i.DT_FINE_VAL AS DT_FINE_VAL,\
                i.dm_b_bene_id AS FIELD1,\
                i.tipo as FIELD2,\
                i.des_comune AS FIELD3,\
                i.prov AS FIELD4,\
                i.flg_principale AS FIELD5 \
                from dm_b_indirizzo i \
                WHERE NOT exists (SELECT 1 FROM sit_civico_totale WHERE id_dwh = id AND fk_ente_sorgente =? AND prog_es=?) \
                AND cod_comune = (select codent from sit_ente) AND i.civico is not null
                
SQL_CIV_CENED=SELECT b.ID AS ID_DWH, \
       b.INDIRIZZO, \
       b.CODICE_IDENTIFICATIVO_PRATICA FIELD1, \
       b.SEZIONE FIELD2, \
       b.FOGLIO FIELD3, \
       b.PARTICELLA FIELD4, \
       B.SUB_TUTTI FIELD5, \
       to_char(DATA_PROT, 'dd/MM/yyyy') FIELD6, \
       B.NUM_PROT FIELD7, \
       B.CLASSE_ENERGETICA FIELD8, \
       B.DESTINAZIONE_DI_USO FIELD9, \
       B.MOTIVAZIONE_ACE FIELD10 \
       FROM DATI_TEC_FABBR_CERT_ENER B \
       WHERE (B.BELFIORE in (select codent from sit_ente) ) \
       AND NOT exists ( select 1 from sit_civico_totale where id_dwh = b.ID and fk_ente_sorgente =? and prog_es =? )
       /*  
        * -- fk_ente_sorgente = 45 PER CENED
        * -- prog_es = AM_FONTE_TIPOINFO 1= CERTIFICAZIONE, 2= PROPRIETARIO, 3= CERTIFICATORE
        * */
                    
       /*
        * CORRISPONDENZA CON IL NOME CAMPI DI SIT_CIVICO_TOTALE
        */
SQL_CIV_BOLLI_VEICOLI=select DISTINCT i.ID AS ID_DWH, \
                i.indirizzo as indirizzo,\
                i.numerocivico as CIV_LIV1,\
                i.targa AS FIELD1,\
                i.uso as FIELD2,\
                i.destinazione AS FIELD3,\
                to_char(i.dt_prima_immatricolazione, 'dd/MM/yyyy') AS FIELD4,\
                i.cilindrata AS FIELD5 \
                from BOLLI_VEICOLI i \
                WHERE NOT exists (SELECT 1 FROM sit_civico_totale WHERE id_dwh = id AND fk_ente_sorgente =? AND prog_es=?) \
                and i.ENTE = (select codent from sit_ente) AND i.numerocivico is not null
                
       
/*#############################################################################################################################################################################################################*/
/*########################################      Query FABBRICATI      #############################################################################################################################################*/
/*#############################################################################################################################################################################################################*/
				  
SQL_FABB_LOCAZIONI=SELECT b.UFFICIO||'|'||b.ANNO||'|'||b.SERIE||'|'||b.NUMERO||'|'||b.SOTTONUMERO||'|'||b.PROG_NEGOZIO||'|'||b.PROG_IMMOBILE ID_DWH, NULL ID_STORICO, b.SEZ_URBANA AS SEZIONE, b.FOGLIO, b.PARTICELLA,b.SUBALTERNO, NULL dt_inizio_val, NULL DT_FINE_VAL, \
					NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, \
					NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, NULL AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
					NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO \
					, b.UFFICIO FIELD1 \
                	, b.ANNO FIELD2 \
                	, b.SERIE FIELD3 \
                	,b.NUMERO FIELD4 \
                	,null FIELD5 \
                	,to_char(DATA_FINE, 'dd/MM/yyyy') FIELD6 \
                	,to_char(DATA_STIPULA,'dd/MM/yyyy') FIELD7 \
                	,IMPORTO_CANONE FIELD8 \
					,OGGETTO_LOCAZIONE FIELD9 \
					,a.INDIRIZZO FIELD10 \
                  	FROM LOCAZIONI_I b, locazioni_a a \
                  	WHERE (B.CODICE_CAT is null or B.codice_cat in (select codent from sit_ente) ) \
                    AND a.ufficio = b.ufficio \
                   	AND a.anno = b.anno \
                   	and a.serie =  b.serie \
                   	and a.numero =  b.numero \
					and b.PARTICELLA IS NOT NULL AND NOT exists (select 1 from sit_fabbricato_totale where id_dwh = b.UFFICIO||'|'||b.ANNO||'|'||b.SERIE||'|'||b.NUMERO||'|'||b.SOTTONUMERO||'|'||b.PROG_NEGOZIO||'|'||b.PROG_IMMOBILE and fk_ente_sorgente =? and prog_es=?)
                   
SQL_FABB_FORNITURE_ELETTRICHE=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZIONE, FOGLIO, PARTICELLA, SUBALTERNO, DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL, \
							 PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, DT_EXP_DATO AS DT_EXP_DATO, NULL AS PROVENIENZA, \
							 NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, NULL AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
							 NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO, \
							 ANNO_RIFERIMENTO_DATI AS FIELD1, to_char(DATA_PRIMA_ATTIVAZIONE, 'dd/MM/yyyy') AS FIELD2, TIPO_UTENZA AS FIELD3, COMUNE_AMM_UBICAZIONE AS FIELD4, PROVINCIA_AMM_UBICAZIONE AS FIELD5, \
							 CAP_UBICAZIONE AS FIELD6, COMUNE_CATASTALE AS FIELD7, CODICE_COMUNE_CATASTALE AS FIELD8, INDIRIZZO_UBICAZIONE AS FIELD9, TIPO_UNITA AS FIELD10, \
							 ESTENSIONE_PARTICELLA AS FIELD11, TIPO_PARTICELLA AS FIELD12, CODICE_ASSENZA_CATASTO AS FIELD13, MESI_FATTURAZIONE AS FIELD14, KWH_FATTURATI AS FIELD15, \
							 SEGNO_IMPORTO AS FIELD16, SPESA_ANNUA AS FIELD17, TIPOLOGIA_FORNITURA AS FIELD18, ID_EXT_ENEL_UTENTE AS FIELD19 \
							 FROM sit_enel_utenza

SQL_FABB_SUCCESSIONI=SELECT UFFICIO || '|' || ANNO || '|' || VOLUME || '|' || NUMERO || '|' || SOTTONUMERO || '|' || COMUNE || '|' || PROGRESSIVO || '|' || PROGRESSIVO_IMMOBILE || '|' || FORNITURA AS ID_DWH, \
					NULL AS ID_STORICO, SEZIONE, FOGLIO, PARTICELLA1, PARTICELLA2, SUBALTERNO1, SUBALTERNO2, NULL AS DT_INIZIO_VAL, NULL AS DT_FINE_VAL, \
					NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, \
					NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, SUPERFICIE_MQ AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
					NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO, \
					NUMERATORE_QUOTA_DEF AS FIELD1, DENOMINATORE_QUOTA_DEF AS FIELD2, DIRITTO AS FIELD3, NATURA AS FIELD4, SUPERFICIE_ETTARI AS FIELD5, \
					VANI AS FIELD6, INDIRIZZO_IMMOBILE AS FIELD7 \
					FROM SUCCESSIONI_C c \
					WHERE COMUNE = ? \
					AND NOT exists  \
					(SELECT 1 FROM sit_fabbricato_totale WHERE id_dwh=(c.UFFICIO || '|' || c.ANNO || '|' || c.VOLUME || '|' || c.NUMERO || '|' || c.SOTTONUMERO || '|' || c.COMUNE || '|' || c.PROGRESSIVO || '|' || c.PROGRESSIVO_IMMOBILE || '|' || c.FORNITURA) and fk_ente_sorgente =? AND prog_es=?)

SQL_FABB_CONCESSIONI=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZIONE, FOGLIO, PARTICELLA, SUBALTERNO, DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL, \
					PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, DT_EXP_DATO AS DT_EXP_DATO, PROVENIENZA AS PROVENIENZA, \
					NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, NULL AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
					NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO, \
					CODICE_FABBRICATO AS FIELD1, DESCRIZIONE AS FIELD2, ID_EXT_C_CONC_INDIRIZZI AS FIELD3, ID_EXT_C_CONCESSIONI AS FIELD4 \
					FROM SIT_C_CONCESSIONI_CATASTO

SQL_FABB_CATASTO=SELECT PKID_UIU ID_DWH, NULL ID_STORICO, id_sezc AS SEZIONE, FOGLIO, PARTICELLA, UNIMM AS SUBALTERNO, DATA_INIZIO_VAL dt_inizio_val, DATA_FINE_VAL AS DT_FINE_VAL, \
				NULL AS PROCESSID, DATA_INIZIO_VAL AS DT_INIZIO_DATO, DATA_FINE_VAL AS DT_FINE_DATO, NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, \
				DATA_LAV AS DATA_REGISTRAZIONE, CATEGORIA AS CATEGORIA, CLASSE AS CLASSE, RENDITA AS RENDITA, SUP_CAT AS SUPERFICIE, ZONA AS ZONA, FOGLIO_URBA AS FOGLIO_URBANO, \
				SCALA AS SCALA, INTERNO AS INTERNO, PIANO AS PIANO, \
				CONSISTENZA AS FIELD1, MICROZONA AS FIELD2, IDE_IMMO AS FIELD3, IDE_MUTA_INI AS FIELD4, IDE_MUTA_FINE AS FIELD5, \
				PARTITA AS FIELD6, ATTO_INI AS FIELD7, ATTO_FIN AS FIELD8, EDIFICIO AS FIELD9 \
				FROM SITICOMU, SITIUIU WHERE siticomu.COD_NAZIONALE = sitiuiu.COD_NAZIONALE \
				AND sitiuiu.COD_NAZIONALE = ? \
				AND NOT exists (SELECT 1 FROM sit_fabbricato_totale WHERE id_dwh=PKID_UIU and fk_ente_sorgente = ? and prog_es= ?)

SQL_FABB_TRIBUTI_ICI=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZ AS SEZIONE, FOGLIO, NUMERO AS PARTICELLA, SUB AS SUBALTERNO, DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL, \
					PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, DT_EXP_DATO AS DT_EXP_DATO, PROVENIENZA AS PROVENIENZA, \
					NULL AS DATA_REGISTRAZIONE, CAT AS CATEGORIA, CLS AS CLASSE, NULL AS RENDITA, NULL AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
					SCALA AS SCALA, INTERNO AS INTERNO, PIANO AS PIANO, \
					YEA_DEN AS FIELD1, NUM_DEN AS FIELD2, YEA_RIF AS FIELD3, TIP_DEN AS FIELD4, DESC_TIP_DEN AS FIELD5, \
					TIP_VAL AS FIELD6, DESC_TIP_VAL AS FIELD7, VAL_IMM AS FIELD8, PRC_POSS AS FIELD9, CAR_IMM AS FIELD10, \
					DTR_ABI_PRI AS FIELD11, NUM_MOD AS FIELD12, NUM_RIGA AS FIELD13, SUF_RIGA AS FIELD14, FLG_IMM_STO AS FIELD15, \
					MESI_POS AS FIELD16, MESI_ESE AS FIELD17, MESI_RID AS FIELD18, FLG_POS3112 AS FIELD19, FLG_ESE3112 AS FIELD20, \
					FLG_RID3112 AS FIELD21, FLG_ABI_PRI3112 AS FIELD22, FLG_ACQ AS FIELD23, FLG_CSS AS FIELD24, YEA_PRO AS FIELD25, \
					NUM_PRO AS FIELD26, FLG_TRF AS FIELD27, DES_IND AS FIELD28, ID_EXT_VIA AS FIELD29, NUM_CIV AS FIELD30, ESP_CIV AS FIELD31 \
					FROM SIT_T_ICI_OGGETTO

SQL_FABB_TRIBUTI_TARSU=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZ AS SEZIONE, FOGLIO, NUMERO AS PARTICELLA, SUB AS SUBALTERNO, DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL, \
					  PROCESSID AS PROCESSID, DAT_INI AS DT_INIZIO_DATO, DAT_FIN AS DT_FINE_DATO, DT_EXP_DATO AS DT_EXP_DATO, PROVENIENZA AS PROVENIENZA, \
					  NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, SUP_TOT AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
					  SCALA AS SCALA, INTERNO AS INTERNO, PIANO AS PIANO, \
					  DES_CLS_RSU AS FIELD1, TIP_OGG AS FIELD2, DES_TIP_OGG AS FIELD3, DES_IND AS FIELD4, ID_EXT_VIA AS FIELD5, \
					  NUM_CIV AS FIELD6, ESP_CIV AS FIELD7 \
					  FROM SIT_T_TAR_OGGETTO
		  
SQL_FABB_DOCFA=SELECT PROTOCOLLO_REG ||'|'|| TO_CHAR(FORNITURA,'YYYYMMDD')||'|'|| TO_CHAR(NR_PROG) AS ID_DWH, NULL ID_STORICO, SEZIONE AS SEZIONE, FOGLIO, NUMERO AS PARTICELLA, SUBALTERNO, NULL dt_inizio_val, NULL AS DT_FINE_VAL, \
			  NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, \
			  NULL AS DATA_REGISTRAZIONE, PROP_CATEGORIA AS CATEGORIA, PROP_CLASSE AS CLASSE, PROP_RENDITA_EURO_CATA AS RENDITA, PROP_SUPERFICIE_CATA AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
			  SCALA AS SCALA, INTERNO AS INTERNO, NULL AS PIANO, \
			  TIPO_OPERAZIONE AS FIELD1, INDIR_FLAG AS FIELD2, INDIR_CODICE AS FIELD3, INDIR_TOPONIMO AS FIELD4, INDIR_NCIV_UNO AS FIELD5, \
			  INDIR_NCIV_DUE AS FIELD6, INDIR_NCIV_TRE AS FIELD7, RIF_MOD_1N AS FIELD8, PROP_ZONA_CENSUARIA AS FIELD9, PROP_CONSISTENZA AS FIELD10, \
			  ID_PLANIMETRIA AS FIELD11, FLAG_UIU_RECUPERATA AS FIELD12 \
			  FROM DOCFA_UIU WHERE NOT exists (SELECT 1 FROM sit_fabbricato_totale WHERE id_dwh = PROTOCOLLO_REG || '|'|| TO_CHAR(FORNITURA,'YYYYMMDD') || '|' || TO_CHAR(NR_PROG) AND fk_ente_sorgente =? AND prog_es=?)
			  
SQL_FABB_COMPRAVENDITE=SELECT FABB.IID  AS ID_DWH, NULL ID_STORICO, FABB.SEZIONE_URBANA AS SEZIONE, FABB.FOGLIO, FABB.NUMERO AS PARTICELLA, FABB.SUBALTERNO, FABINFO.CATEGORIA, FABINFO.CLASSE, RENDITA_EURO RENDITA, \
					  FABINFO.ZONA, NULL FOGLIO_URBANO, FABINFO.SUPERFICIE, T_SCALA SCALA, T_INTERNO1 INTERNO, T_PIANO1 PIANO, NULL dt_inizio_val, NULL AS DT_FINE_VAL, \
					  NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, \
					  NULL AS DATA_REGISTRAZIONE, CATEGORIA AS CATEGORIA, CLASSE AS CLASSE, RENDITA_EURO AS RENDITA, SUPERFICIE AS SUPERFICIE, ZONA AS ZONA, NULL AS FOGLIO_URBANO, \
					  NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO, \
					  FABB.TIPO_DENUNCIA AS FIELD1, FABB.NUMERO_PROTOCOLLO AS FIELD2, FABB.ANNO AS FIELD3, T_LOTTO AS FIELD4, T_EDIFICIO AS FIELD5, \
					  T_SCALA AS FIELD6, T_INTERNO1 AS FIELD7, T_INTERNO2 AS FIELD8, T_PIANO1 AS FIELD9, T_PIANO2 AS FIELD10, \
					  T_PIANO3 AS FIELD11, T_PIANO4 AS FIELD12, T_TOPONIMO AS FIELD13, T_INDIRIZZO AS FIELD14, T_CIVICO1 AS FIELD15, \
					  T_CIVICO2 AS FIELD16, T_CIVICO3 AS FIELD17, C_LOTTO AS FIELD18, C_EDIFICIO AS FIELD19, C_SCALA AS FIELD20, \
					  C_INTERNO1 AS FIELD21, C_INTERNO2 AS FIELD22, C_PIANO1 AS FIELD23, C_PIANO2 AS FIELD24, C_PIANO3 AS FIELD25, \
					  C_PIANO4 AS FIELD26, C_TOPONIMO AS FIELD27, C_INDIRIZZO AS FIELD28, C_CIVICO1 AS FIELD29, C_CIVICO2 AS FIELD30, C_CIVICO3 AS FIELD31 \
					  FROM mui_fabbricati_identifica FABB , \
					  mui_fabbricati_info fabinfo WHERE fabinfo.IID_FORNITURA = fabb.IID_FORNITURA AND  fabinfo.iId_nota = fabb.iId_nota AND fabinfo.id_immobile = fabb.id_immobile \
					  AND FABB.NUMERO is not null and NOT exists (SELECT 1 FROM sit_fabbricato_totale WHERE id_dwh = FABB.IID AND fk_ente_sorgente =? AND prog_es=?)  
				    			
SQL_FABB_COSAP_TASSA=SELECT ID ID_DWH, ID_EXT ID_STORICO, NULL AS SEZIONE, FOGLIO, PARTICELLA, SUBALTERNO, DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL, \
                    PROCESSID AS PROCESSID, DT_INIZIO_DATO AS DT_INIZIO_DATO, DT_FINE_DATO AS DT_FINE_DATO, DT_EXP_DATO AS DT_EXP_DATO, PROVENIENZA AS PROVENIENZA, \
                    NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, NULL AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
                    NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO, NOTE, \
                    COD_UNIVOCO_CANONE AS FIELD1, ID_EXT_CONTRIB AS FIELD2, TIPO_DOCUMENTO AS FIELD3, NUMERO_DOCUMENTO AS FIELD4, \
                    ANNO_DOCUMENTO AS FIELD5, STATO_DOCUMENTO AS FIELD6, NUMERO_PROTOCOLLO AS FIELD7, ANNO_CONTABILE_DOCUMENTO AS FIELD8, \
                    DT_PROTOCOLLO AS FIELD9, DT_INI_VALIDITA AS FIELD10, DT_FIN_VALIDITA AS FIELD11, DT_RICHIESTA AS FIELD12, \
                    TIPO_OCCUPAZIONE AS FIELD13, CODICE_IMMOBILE AS FIELD14, SUBALTERNO AS FIELD15, QUANTITA AS FIELD16, \
                    UNITA_MISURA_QUANTITA AS FIELD17, TARIFFA_PER_UNITA AS FIELD18, IMPORTO_CANONE AS FIELD19, \
                    DT_INI_VALIDITA_TARIFFA AS FIELD20, DT_FIN_VALIDITA_TARIFFA AS FIELD21, DESCRIZIONE AS FIELD22, \
                    CODICE_ESENZIONE AS FIELD23, SCONTO_ASSOLUTO AS FIELD24, PERCENTUALE_SCONTO AS FIELD25, \
                    DT_INI_SCONTO AS FIELD26, DT_FIN_SCONTO AS FIELD27, PROVENIENZA AS FIELD28, ZONA AS FIELD29  \
                    FROM SIT_T_COSAP_TASSA
                    
SQL_FABB_ACQUA=SELECT ID ID_DWH, ID_EXT ID_STORICO, SEZIONE, FOGLIO, PARTICELLA, SUBALTERNO, DT_INIZIO_VAL dt_inizio_val, DT_FINE_VAL AS DT_FINE_VAL, \
              PROCESSID AS PROCESSID, DT_INIZIO_DATO, DT_FINE_DATO, DT_EXP_DATO, NULL AS PROVENIENZA, \
              NULL AS DATA_REGISTRAZIONE, NULL AS CATEGORIA, NULL AS CLASSE, NULL AS RENDITA, NULL AS SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, \
              NULL AS SCALA, NULL AS INTERNO, NULL AS PIANO, \
              ESTENSIONE_PART AS FIELD1, TIPOLOGIA_PART AS FIELD2 \
              FROM SIT_ACQUA_CATASTO
                    
SQL_FABB_ECOGRAFICO=select ID AS ID_DWH, NULL ID_STORICO, SEZIONE_CT AS SEZIONE, FOGLIO_CT AS FOGLIO, PARTICELLA_CT AS PARTICELLA, NULL AS SUBALTERNO, NULL dt_inizio_val, NULL AS DT_FINE_VAL,NULL AS PROCESSID, NULL AS DT_INIZIO_DATO, NULL AS DT_FINE_DATO, NULL AS DT_EXP_DATO, NULL AS PROVENIENZA, NULL AS DATA_REGISTRAZIONE, null AS CATEGORIA, null AS CLASSE, null AS RENDITA, SUPERFICIE, NULL AS ZONA, NULL AS FOGLIO_URBANO, null AS SCALA, null AS INTERNO, NULL AS PIANO, UK_CODI_FABBRICATO AS FIELD1, CODICE_ECOGRAFICO AS FIELD2, STATO_ACCATASTAMENTO AS FIELD3, ALTEZZA AS FIELD4, VOLUME AS FIELD5, N_PIANI_FT AS FIELD6, N_PIANI_ET AS FIELD7, DESTINAZIONE_USO AS FIELD8, STATO_COSTRUITO AS FIELD9, STATO_CONSERVAZIONE AS FIELD10, ANNO_COSTRUZIONE AS FIELD11, ORIGINE AS FIELD12 from ec_fab_fabbricati  WHERE NOT exists (select 1 from sit_fabbricato_totale where id_dwh = id and fk_ente_sorgente =? and prog_es =?)

SQL_FABB_R_TARES=select distinct \
                i.id as id_dwh, i.id_ext ID_STORICO,\
                i.sez AS SEZIONE, i.foglio, i.particella,i.sub AS SUBALTERNO,I.CAT AS CATEGORIA,\
                i.PROCESSID,\
                i.DT_INIZIO_DATO,\
                i.DT_FINE_DATO,\
                i.DT_EXP_DATO,\
                i.DT_INIZIO_VAL,\
                i.DT_FINE_VAL AS DT_FINE_VAL,\
                v.ANNO AS FIELD1,\
                v.TIPO AS FIELD2,\
                i.importo AS FIELD3,\
                i.cod_tributo AS FIELD4,\
                i.mq as FIELD5,\
                I.DES_CAT as FIELD6,\
                V.ID AS FIELD7,\
                V.NOMINATIVO_CONTRIB AS FIELD8,\
                V.CODFISC AS FIELD9 \
                from sit_ruolo_tares_imm i , sit_ruolo_tares v \
                where I.id_ext_ruolo=V.ID_EXT and (i.foglio is not null or I.PARTICELLA is not null)
                
SQL_FABB_DEMANIO=select DISTINCT i.ID AS ID_DWH,\
                i.sezione, i.foglio, i.mappale as particella,\
                i.dt_inizio_dato,i.dt_fine_dato, i.DT_INIZIO_VAL,i.DT_FINE_VAL AS DT_FINE_VAL,i.dt_elab as dt_exp_dato,\
                i.provenienza,\
                i.dm_b_bene_id AS FIELD1,\
                i.tipo as FIELD2 \
                from dm_b_mappale i \
                WHERE NOT exists (SELECT 1 FROM sit_fabbricato_totale WHERE id_dwh = id AND fk_ente_sorgente =? AND prog_es=?) \
                AND cod_comune = (select codent from sit_ente) 
                
SQL_FABB_CENED=SELECT B.ID AS ID_DWH, \
	       B.SEZIONE, \
	       B.FOGLIO, \
	       B.PARTICELLA, \
	       B.SUB_TUTTI FIELD1, \
	       B.INDIRIZZO FIELD2, \
	       B.DENOM_PROPRIETARIO FIELD3, \
	       B.DENOM_CERTIFICATORE FIELD4, \
	       to_char(B.DATA_PROT, 'dd/MM/yyyy') FIELD5, \
	       B.CODICE_IDENTIFICATIVO_PRATICA FIELD6, \
	       B.CLASSE_ENERGETICA FIELD7, \
	       B.DESTINAZIONE_DI_USO FIELD8, \
	       B.MOTIVAZIONE_ACE FIELD9 \
	       FROM DATI_TEC_FABBR_CERT_ENER B \
	       WHERE (B.BELFIORE in (select codent from sit_ente) ) \
	       AND NOT exists ( select 1 from sit_fabbricato_totale where id_dwh = b.ID and fk_ente_sorgente =? and prog_es =? )
	       