#------------------------------------------------------------
# File di config della regola
#------------------------------------------------------------
rengine.rule.class=it.webred.rulengine.brick.core.EseguiCaricamentoDWHDocfa
rengine.rule.cc=C_DOCFA2_1
rengine.rule.number.params.in=0
rengine.rule.number.params.out=0
#------------------------------------------------------------
# parametri di input
#------------------------------------------------------------
#
#------------------------------------------------------------
# parametri di output
#------------------------------------------------------------
#
#------------------------------------------------------------
# Definizioni costanti o proprietà aggiuntive della regola
#------------------------------------------------------------	
rengine.rule.sql.1.value=INSERT INTO docfa_dati_generali             (fornitura, protocollo_reg, data_variazione, causale_nota_vax,              numero_mappale, data_mappale, flag_commi_fin2005, flag_div,              flag_frz, flag_fus, flag_amp, flag_det, flag_dep, flag_vsi,              flag_r57, flag_frf, flag_vto, flag_ufu, flag_vde, flag_var,              flag_vrp, flag_nc, flag_edi, flag_eds, flag_vmi, altre_causali,              u_deriv_dest_ordinaria, u_deriv_dest_speciale,              u_deriv_beni_com_no_cens, uiu_in_soppressione, uiu_in_variazione,              uiu_in_costituzione, nr_ditta, nr_totale_ditte,              nr_intestati_ditta, nr_mod_uno_n_parte_uno,              nr_mod_uno_n_parte_due, nr_mod_due_n_parte_uno,              nr_mod_due_n_parte_due, nr_planimetrie, nr_elab_planim,              desc_variaz_da, desc_variaz_a, desc_variaz_altre, annotazioni,              uiu_affe_sezione, uiu_affe_foglio, uiu_affe_numero,              uiu_affe_denominatore, flag_riferimento, id_fab_comune,              id_fab_sezione, id_fab_foglio, id_fab_numero,              id_fab_denominatore, id_fab_subalterno, id_ter_comune,              id_ter_foglio, id_ter_numero, id_ter_denominatore,              id_ter_subalterno, nr_doc_ripresentati, elab_pl_sezione,              elab_pl_foglio, elab_pl_numero, elab_pl_denominatore)    SELECT DATA AS fornitura,           LTRIM (RTRIM (protocollo)) AS protocollo_reg,           (CASE               WHEN SUBSTR (riga_dettaglio, 18, 2) \= '00'                  THEN NULL               ELSE TO_DATE (LTRIM (RTRIM (SUBSTR (riga_dettaglio, 18, 8))),                             'DDMMYYYY'                            )            END           ) AS data_variazione,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 26, 3))) AS causale_nota_vax,           to_number_all (SUBSTR (riga_dettaglio, 26, 3)) AS numero_mappale,           (CASE               WHEN SUBSTR (riga_dettaglio, 37, 2) \= '00'                  THEN NULL               ELSE TO_DATE (LTRIM (RTRIM (SUBSTR (riga_dettaglio, 37, 8))),                             'DDMMYYYY'                            )            END           ) AS data_mappale,           to_number_all (SUBSTR (riga_dettaglio, 45, 1)) AS flag_commi_fin2005,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 57, 1))) AS flag_div,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 58, 1))) AS flag_frz,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 59, 1))) AS flag_fus,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 60, 1))) AS flag_amp,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 61, 1))) AS flag_det,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 62, 1))) AS flag_dep,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 63, 1))) AS flag_vsi,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 64, 1))) AS flag_r57,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 65, 1))) AS flag_frf,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 66, 1))) AS flag_vto,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 67, 1))) AS flag_ufu,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 68, 1))) AS flag_vde,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 69, 1))) AS flag_var,   \t\tLTRIM (RTRIM (SUBSTR(RIGA_DETTAGLIO,70,1))) AS FLAG_VRP,          LTRIM (RTRIM (SUBSTR (riga_dettaglio, 71, 1))) AS flag_nc,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 72, 1))) AS flag_edi,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 73, 1))) AS flag_eds,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 74, 1))) AS flag_vmi,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 75, 1))) AS altre_causali,           to_number_all (SUBSTR (riga_dettaglio, 77, 3)) AS u_deriv_dest_ordinaria,           to_number_all (SUBSTR (riga_dettaglio, 80, 3)) AS u_deriv_dest_speciale,           to_number_all (SUBSTR (riga_dettaglio, 83, 3)) AS u_deriv_beni_com_no_cens,           to_number_all (SUBSTR (riga_dettaglio, 86, 3)) AS uiu_in_soppressione,           to_number_all (SUBSTR (riga_dettaglio, 89, 3)) AS uiu_in_variazione,           to_number_all (SUBSTR (riga_dettaglio, 92, 3)) AS uiu_in_costituzione,           to_number_all (SUBSTR (riga_dettaglio, 95, 3)) AS nr_ditta,           to_number_all (SUBSTR (riga_dettaglio, 98, 3)) AS nr_totale_ditte,           to_number_all (SUBSTR (riga_dettaglio, 101, 3)) AS nr_intestati_ditta,           to_number_all (SUBSTR (riga_dettaglio, 104, 4)) AS nr_mod_uno_n_parte_uno,           to_number_all (SUBSTR (riga_dettaglio, 108, 4)) AS nr_mod_uno_n_parte_due,           to_number_all (SUBSTR (riga_dettaglio, 112, 4)) AS nr_mod_due_n_parte_uno,           to_number_all (SUBSTR (riga_dettaglio, 116, 4)) AS nr_mod_due_n_parte_due,           to_number_all (SUBSTR (riga_dettaglio, 120, 4)) AS nr_planimetrie,           to_number_all (SUBSTR (riga_dettaglio, 124, 4)) AS nr_elab_planim,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 128, 35))) AS desc_variaz_da,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 163, 35))) AS desc_variaz_a,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 198, 35))) AS desc_variaz_altre,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 233, 40))) AS annotazioni,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 233, 3))) AS uiu_affe_sezione,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 236, 4))) AS uiu_affe_foglio,           to_number_all (SUBSTR (riga_dettaglio, 240, 5)) AS uiu_affe_numero,           to_number_all (SUBSTR (riga_dettaglio, 245, 4)) AS uiu_affe_denominatore,           to_number_all (SUBSTR (riga_dettaglio, 249, 1)) AS flag_riferimento,           (CASE               WHEN SUBSTR (riga_dettaglio, 249, 1) \= '2'                  THEN LTRIM (RTRIM (SUBSTR (riga_dettaglio, 250, 5)))               ELSE NULL            END           ) AS id_fab_comune,           (CASE               WHEN SUBSTR (riga_dettaglio, 249, 1) \= '2'                  THEN LTRIM (RTRIM (SUBSTR (riga_dettaglio, 255, 3)))               ELSE NULL            END           ) AS id_fab_sezione,           (CASE               WHEN SUBSTR (riga_dettaglio, 249, 1) \= '2'                  THEN LTRIM (RTRIM (SUBSTR (riga_dettaglio, 258, 4)))               ELSE NULL            END           ) AS id_fab_foglio,           (CASE               WHEN SUBSTR (riga_dettaglio, 249, 1) \= '2'                  THEN to_number_all (SUBSTR (riga_dettaglio, 262, 5))               ELSE NULL            END           ) AS id_fab_numero,           (CASE               WHEN SUBSTR (riga_dettaglio, 249, 1) \= '2'                  THEN to_number_all (SUBSTR (riga_dettaglio, 267, 4))               ELSE NULL            END           ) AS id_fab_denominatore,           (CASE               WHEN SUBSTR (riga_dettaglio, 249, 1) \= '2'                  THEN LTRIM (RTRIM (SUBSTR (riga_dettaglio, 271, 4)))               ELSE NULL            END           ) AS id_fab_subalterno,           (CASE               WHEN SUBSTR (riga_dettaglio, 249, 1) \= '1'                  THEN LTRIM (RTRIM (SUBSTR (riga_dettaglio, 250, 5)))               ELSE NULL            END           ) AS id_ter_comune,           (CASE               WHEN SUBSTR (riga_dettaglio, 249, 1) \= '1'                  THEN LTRIM (RTRIM (SUBSTR (riga_dettaglio, 255, 5)))               ELSE NULL            END           ) AS id_ter_foglio,           (CASE               WHEN SUBSTR (riga_dettaglio, 249, 1) \= '1'                  THEN to_number_all (SUBSTR (riga_dettaglio, 260, 5))               ELSE NULL            END           ) AS id_ter_numero,           (CASE               WHEN SUBSTR (riga_dettaglio, 249, 1) \= '1'                  THEN to_number_all (SUBSTR (riga_dettaglio, 265, 4))               ELSE NULL            END           ) AS id_ter_denominatore,           (CASE               WHEN SUBSTR (riga_dettaglio, 249, 1) \= '1'                  THEN LTRIM (RTRIM (SUBSTR (riga_dettaglio, 269, 4)))               ELSE NULL            END           ) AS id_ter_subalterno,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 286, 3)) ) AS nr_doc_ripresentati,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 289, 3))) AS elab_pl_sezione,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 292, 4))) AS elab_pl_foglio,           to_number_all (SUBSTR (riga_dettaglio, 296, 5)) AS elab_pl_numero,           to_number_all (SUBSTR (riga_dettaglio, 301, 5)) AS elab_pl_denominatore      FROM doc_docfa_1_0 doc     WHERE SUBSTR (doc.riga_dettaglio, 8, 1) \= 'A'           AND re_flag_elaborato \= 0 
rengine.rule.sql.2.value=INSERT INTO  DOCFA_INTESTATI   (FORNITURA,  PROTOCOLLO_REG,  NR_PROG,   COGNOME,  NOME,  DENOMINAZIONE,  SEDE,   COMUNE_NASCITA,  DATA_NASCITA,  SESSO,   CODICE_FISCALE,  PARTITA_IVA,  REGIME,   NR_ORDINE_INTESTATO,  SPECIFICA_DIRITTO,   NUMERO_POSSESSO,  DENOMINATORE_POSSESSO,  NUOVI_TITOLI )    SELECT   DATA AS FORNITURA,   RTRIM(LTRIM(PROTOCOLLO)) AS PROTOCOLLO_REG,   To_Number_All(SUBSTR(RIGA_DETTAGLIO,9,3)) AS NR_PROG,   (CASE   WHEN To_Number_All(SUBSTR(RIGA_DETTAGLIO,152,2)) > 1    THEN RTRIM(LTRIM(SUBSTR(RIGA_DETTAGLIO,25,50)))    ELSE NULL   END) AS COGNOME,   (CASE      WHEN To_Number_All(SUBSTR(RIGA_DETTAGLIO,152,2)) > 1 \t      THEN RTRIM(LTRIM(SUBSTR(RIGA_DETTAGLIO,75,50)))  \t\t  ELSE NULL   END) AS NOME,   (CASE      WHEN To_Number_All(SUBSTR(RIGA_DETTAGLIO,152,2)) > 1 \t      THEN NULL \t\t  ELSE RTRIM(LTRIM(SUBSTR(RIGA_DETTAGLIO,25,100)))    END) AS DENOMINAZIONE,   (CASE      WHEN To_Number_All(SUBSTR(RIGA_DETTAGLIO,152,2)) > 1 \t      THEN NULL \t\t  ELSE RTRIM(LTRIM(SUBSTR(RIGA_DETTAGLIO,125,25)))    END) AS SEDE,   (CASE      WHEN To_Number_All(SUBSTR(RIGA_DETTAGLIO,152,2)) > 1 \t      THEN RTRIM(LTRIM(SUBSTR(RIGA_DETTAGLIO,125,25))) \t\t  ELSE NULL    END) AS COMUNE_NASCITA,   (CASE      WHEN To_Number_All(SUBSTR(RIGA_DETTAGLIO,152,2)) > 1 \t      THEN RTRIM(LTRIM(SUBSTR(RIGA_DETTAGLIO,152,8)))  \t\t  ELSE NULL   END) AS DATA_NASCITA,    RTRIM(LTRIM(SUBSTR(RIGA_DETTAGLIO,160,1))) AS  SESSO,   (CASE      WHEN To_Number_All(SUBSTR(RIGA_DETTAGLIO,152,2)) > 1 \t      THEN RTRIM(LTRIM(SUBSTR(RIGA_DETTAGLIO,161,16)))  \t\t  ELSE NULL   END) AS CODICE_FISCALE,   (CASE       WHEN To_Number_All(SUBSTR(RIGA_DETTAGLIO,152,2)) > 1  \t  THEN NULL   \t\t  ELSE RTRIM(LTRIM(SUBSTR(RIGA_DETTAGLIO,161,16)))    END) AS PARTITA_IVA,     RTRIM(LTRIM(SUBSTR(RIGA_DETTAGLIO,179,1))) AS   REGIME,    To_Number_All(SUBSTR(RIGA_DETTAGLIO,180,3))  AS NR_ORDINE_INTESTATO,    RTRIM(LTRIM(SUBSTR(RIGA_DETTAGLIO,183,50))) AS SPECIFICA_DIRITTO,    To_Number_All(SUBSTR(RIGA_DETTAGLIO,233,9))  AS  NUMERO_POSSESSO,          To_Number_All(SUBSTR(RIGA_DETTAGLIO,242,6))  AS  DENOMINATORE_POSSESSO,    RTRIM(LTRIM(SUBSTR(RIGA_DETTAGLIO,248,2)))  AS  NUOVI_TITOLI  FROM DOC_DOCFA_1_0 DOC    WHERE SUBSTR(DOC.RIGA_DETTAGLIO,8,1) \= 'B'      AND re_FLAG_ELABORATO \= 0 
rengine.rule.sql.3.value=INSERT INTO docfa_uiu             (fornitura, protocollo_reg, nr_prog, partita_speciale,              tipo_operazione, sezione, foglio, numero, denominatore,              subalterno, indir_flag, indir_codice, indir_toponimo,              indir_nciv_uno, indir_nciv_due, indir_nciv_tre,              indir_nrpiano_uno, indir_nrpiano_due, indir_nrpiano_tre, scala,              interno, lotto, edificio, co_tipi_operazione, co_sezione,              co_foglio, co_numero, co_denominatore, co_subalterno, rif_mod_1n,              prop_zona_censuaria, prop_categoria, prop_classe,              prop_consistenza, prop_superficie_cata, prop_rendita_euro_cata,              id_planimetria, flag_uiu_recuperata)    SELECT DATA AS fornitura,           LTRIM (RTRIM (protocollo)) AS protocollo_reg,           to_number_all (SUBSTR (riga_dettaglio, 9, 3)) AS nr_prog,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 18, 7))) AS partita_speciale,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 25, 1))) AS tipo_operazione,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 26, 3))) AS sezione,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 29, 4))) AS foglio,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 33, 5))) AS numero,           to_number_all (SUBSTR (riga_dettaglio, 38, 4)) AS denominatore,           SUBSTR (riga_dettaglio, 42, 4) AS subalterno,           (CASE               WHEN SUBSTR (riga_dettaglio, 46, 1) \= '*'                  THEN LTRIM (RTRIM (SUBSTR (riga_dettaglio, 46, 1)))               ELSE NULL            END           ) AS indir_flag,           (CASE               WHEN SUBSTR (riga_dettaglio, 46, 1) \= '*'                  THEN LTRIM (RTRIM (SUBSTR (riga_dettaglio, 47, 5)))               ELSE NULL            END           ) AS indir_codice,           (CASE               WHEN SUBSTR (riga_dettaglio, 46, 1) \= '*'                  THEN LTRIM (RTRIM (SUBSTR (riga_dettaglio, 52, 44)))               ELSE LTRIM (RTRIM (SUBSTR (riga_dettaglio, 46, 50)))            END           ) AS indir_toponimo,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 96, 6))) AS indir_nciv_uno,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 102, 6))) AS indir_nciv_due,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 108, 6))) AS indir_nciv_tre,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 114, 4))) AS indir_nrpiano_uno,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 118, 4))) AS indir_nrpiano_due,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 122, 4))) AS indir_nrpiano_tre,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 126, 2))) AS scala,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 128, 3))) AS interno,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 131, 2))) AS lotto,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 133, 2))) AS edificio,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 135, 1))) AS co_tipi_operazione,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 136, 3))) AS co_sezione,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 139, 4))) AS co_foglio,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 143, 5))) AS co_numero,           to_number_all (SUBSTR (riga_dettaglio, 148, 4)) AS co_denominatore,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 152, 4))) AS co_subalterno,           to_number_all (SUBSTR (riga_dettaglio, 156, 4)) AS rif_mod_1n,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 160, 3))) AS prop_zona_censuaria,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 163, 3))) AS prop_categoria,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 166, 2))) AS prop_classe,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 168, 7))) AS prop_consistenza,           to_number_all (SUBSTR (riga_dettaglio, 175, 5)) AS prop_superficie_cata,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 180, 10))) AS prop_rendita_euro_cata,           to_number_all (SUBSTR (riga_dettaglio, 221, 7)) AS id_planimetria,           to_number_all (SUBSTR (riga_dettaglio, 228, 1)) AS flag_uiu_recuperata      FROM doc_docfa_1_0 doc     WHERE SUBSTR (doc.riga_dettaglio, 8, 1) \= 'C'       AND SUBSTR (doc.riga_dettaglio, 17, 1) \= '3'       AND re_flag_elaborato \= 0 
rengine.rule.sql.4.value=INSERT INTO  DOCFA_UIU_ID_CATA  ( FORNITURA,  PROTOCOLLO_REG,  NR_PROG,  SEZIONE_01,  FOGLIO_01,  NUMERO_01,  DENOMINATORE_01,  SUBALTERNO_01,  SEZIONE_02,  FOGLIO_02,  NUMERO_02,  DENOMINATORE_02,  SUBALTERNO_02,  SEZIONE_03,  FOGLIO_03,  NUMERO_03,  DENOMINATORE_03,  SUBALTERNO_03,  SEZIONE_04,  FOGLIO_04,  NUMERO_04,  DENOMINATORE_04,  SUBALTERNO_04,  SEZIONE_05,  FOGLIO_05,  NUMERO_05,  DENOMINATORE_05,  SUBALTERNO_05,  SEZIONE_06,  FOGLIO_06,  NUMERO_06,  DENOMINATORE_06,  SUBALTERNO_06,   SEZIONE_07,  FOGLIO_07,  NUMERO_07,  DENOMINATORE_07,  SUBALTERNO_07,  SEZIONE_08,  FOGLIO_08,  NUMERO_08,  DENOMINATORE_08,  SUBALTERNO_08,  SEZIONE_09,  FOGLIO_09,  NUMERO_09,  DENOMINATORE_09,  SUBALTERNO_09,  SEZIONE_10,  FOGLIO_10,  NUMERO_10,  DENOMINATORE_10,  SUBALTERNO_10)  SELECT DATA AS FORNITURA,  LTRIM(RTRIM(PROTOCOLLO)) AS PROTOCOLLO_REG,  To_Number_All(SUBSTR(RIGA_DETTAGLIO,9,3)) AS NR_PROG,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,18,3)))     AS SEZIONE_01,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,21,4)))     AS FOGLIO_01,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,25,5)))     AS NUMERO_01,    To_Number_All(SUBSTR(RIGA_DETTAGLIO,30,4))  AS DENOMINATORE_01,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,34,4)))     AS SUBALTERNO_01,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,38,3)))     AS SEZIONE_02,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,41,4)))     AS FOGLIO_02,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,45,5)))     AS NUMERO_02,    To_Number_All(SUBSTR(RIGA_DETTAGLIO,50,4))  AS DENOMINATORE_02,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,54,4)))     AS SUBALTERNO_02,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,58,3)))     AS SEZIONE_03,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,61,4)))     AS FOGLIO_03,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,65,5)))     AS NUMERO_03,    To_Number_All(SUBSTR(RIGA_DETTAGLIO,70,4))  AS DENOMINATORE_03,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,74,4)))     AS SUBALTERNO_03,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,78,3)))     AS SEZIONE_04,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,81,4)))     AS FOGLIO_04,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,85,5)))     AS NUMERO_04,    To_Number_All(SUBSTR(RIGA_DETTAGLIO,90,4))  AS DENOMINATORE_04,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,94,4)))     AS SUBALTERNO_04,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,98,3)))     AS SEZIONE_05,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,101,4)))     AS FOGLIO_05,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,105,5)))     AS NUMERO_05,    To_Number_All(SUBSTR(RIGA_DETTAGLIO,110,4))  AS DENOMINATORE_05,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,114,4)))     AS SUBALTERNO_05,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,118,3)))     AS SEZIONE_06,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,121,4)))     AS FOGLIO_06,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,125,5)))     AS NUMERO_06,    To_Number_All(SUBSTR(RIGA_DETTAGLIO,130,4))  AS DENOMINATORE_06,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,134,4)))     AS SUBALTERNO_06,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,138,3)))     AS SEZIONE_07,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,141,4)))     AS FOGLIO_07,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,145,5)))     AS NUMERO_07,    To_Number_All(SUBSTR(RIGA_DETTAGLIO,150,4))  AS DENOMINATORE_07,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,154,4)))     AS SUBALTERNO_07,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,158,3)))     AS SEZIONE_08,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,161,4)))     AS FOGLIO_08,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,165,5)))     AS NUMERO_08,    To_Number_All(SUBSTR(RIGA_DETTAGLIO,170,4))  AS DENOMINATORE_08,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,174,4)))     AS SUBALTERNO_08,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,178,3)))     AS SEZIONE_09,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,181,4)))     AS FOGLIO_09,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,185,5)))     AS NUMERO_09,    To_Number_All(SUBSTR(RIGA_DETTAGLIO,190,4))  AS DENOMINATORE_09,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,194,4)))     AS SUBALTERNO_09,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,198,3)))     AS SEZIONE_10,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,201,4)))     AS FOGLIO_10,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,205,5)))     AS NUMERO_10,    To_Number_All(SUBSTR(RIGA_DETTAGLIO,210,4))  AS DENOMINATORE_10,    LTRIM(RTRIM(SUBSTR(RIGA_DETTAGLIO,214,4)))     AS SUBALTERNO_10  FROM DOC_DOCFA_1_0 DOC     WHERE SUBSTR(DOC.RIGA_DETTAGLIO,8,1) \= 'C'\t      AND SUBSTR(DOC.RIGA_DETTAGLIO,17,1) \= '4'      AND re_FLAG_ELABORATO \= 0 
rengine.rule.sql.5.value=INSERT INTO docfa_beni_non_cens             (fornitura, protocollo_reg, sezione_01, foglio_01, numero_01,              denominatore_01, subalterno_01, nr_piano_uno_01, nr_piano_due_01,              nr_piano_tre_01, sezione_02, foglio_02, numero_02,              denominatore_02, subalterno_02, nr_piano_uno_02, nr_piano_due_02,              nr_piano_tre_02, sezione_03, foglio_03, numero_03,              denominatore_03, subalterno_03, nr_piano_uno_03, nr_piano_due_03,              nr_piano_tre_03, sezione_04, foglio_04, numero_04,              denominatore_04, subalterno_04, nr_piano_uno_04, nr_piano_due_04,              nr_piano_tre_04, sezione_05, foglio_05, numero_05,              denominatore_05, subalterno_05, nr_piano_uno_05, nr_piano_due_05,              nr_piano_tre_05, sezione_06, foglio_06, numero_06,              denominatore_06, subalterno_06, nr_piano_uno_06, nr_piano_due_06,              nr_piano_tre_06, sezione_07, foglio_07, numero_07,              denominatore_07, subalterno_07, nr_piano_uno_07, nr_piano_due_07,              nr_piano_tre_07)    SELECT DATA AS fornitura,           LTRIM (RTRIM (protocollo)) AS protocollo_reg,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 18, 3))) AS sezione_01,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 21, 4))) AS foglio_01,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 25, 5))) AS numero_01,           to_number_all (SUBSTR (riga_dettaglio, 30, 4)) AS denominatore_01,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 34, 4))) AS subalterno_01,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 38, 4))) AS nr_piano_uno_01,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 42, 4))) AS nr_piano_due_01,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 46, 4))) AS nr_piano_tre_01,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 50, 3))) AS sezione_02,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 53, 4))) AS foglio_02,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 57, 5))) AS numero_02,           to_number_all (SUBSTR (riga_dettaglio, 62, 4)) AS denominatore_02,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 66, 4))) AS subalterno_02,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 70, 4))) AS nr_piano_uno_02,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 74, 4))) AS nr_piano_due_02,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 78, 4))) AS nr_piano_tre_02,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 82, 3))) AS sezione_03,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 85, 4))) AS foglio_03,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 89, 5))) AS numero_03,           to_number_all (SUBSTR (riga_dettaglio, 94, 4)) AS denominatore_03,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 98, 4))) AS subalterno_03,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 102, 4))) AS nr_piano_uno_03,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 106, 4))) AS nr_piano_due_03,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 110, 4))) AS nr_piano_tre_03,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 114, 3))) AS sezione_04,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 117, 4))) AS foglio_04,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 121, 5))) AS numero_04,           to_number_all (SUBSTR (riga_dettaglio, 126, 4)) AS denominatore_04,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 130, 4))) AS subalterno_04,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 134, 4))) AS nr_piano_uno_04,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 138, 4))) AS nr_piano_due_04,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 142, 4))) AS nr_piano_tre_04,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 146, 3))) AS sezione_05,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 149, 4))) AS foglio_05,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 153, 5))) AS numero_05,           to_number_all (SUBSTR (riga_dettaglio, 158, 4)) AS denominatore_05,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 162, 4))) AS subalterno_05,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 166, 4))) AS nr_piano_uno_05,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 170, 4))) AS nr_piano_due_05,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 174, 4))) AS nr_piano_tre_05,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 178, 3))) AS sezione_06,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 181, 4))) AS foglio_06,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 185, 5))) AS numero_06,           to_number_all (SUBSTR (riga_dettaglio, 190, 4)) AS denominatore_06,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 194, 4))) AS subalterno_06,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 198, 4))) AS nr_piano_uno_06,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 202, 4))) AS nr_piano_due_06,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 206, 4))) AS nr_piano_tre_06,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 210, 3))) AS sezione_07,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 213, 4))) AS foglio_07,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 217, 5))) AS numero_07,           to_number_all (SUBSTR (riga_dettaglio, 222, 4)) AS denominatore_07,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 226, 4))) AS subalterno_07,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 230, 4))) AS nr_piano_uno_07,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 234, 4))) AS nr_piano_due_07,           LTRIM (RTRIM (SUBSTR (riga_dettaglio, 238, 4))) AS nr_piano_tre_07      FROM doc_docfa_1_0 doc     WHERE SUBSTR (doc.riga_dettaglio, 8, 1) \= 'H'           AND re_flag_elaborato \= 0 
rengine.rule.sql.6.value=INSERT INTO DOCFA_ANNOTAZIONI    (FORNITURA,  PROTOCOLLO_REG,  PROG_TRASC,  ANNOTAZIONI,  PROG_UIU_DA,  PROG_UIU_A,  ROGANTE,  SEDE,  PROVINCIA,  REPERTORIO,  CAUSALE,  DATA_ANNOTA,  VOLUME,  DATA_REGISTRAZIONE,  ESTREMI_ATTO_02,  ESTREMI_ATTO_03,  PRESENZA_ESTREMI )  SELECT DATA AS FORNITURA,  LTRIM(RTRIM(PROTOCOLLO)) AS PROTOCOLLO_REG,     LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,9,9)))      AS PROG_TRASC,    (CASE       WHEN LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,12,6))) \= '000009'  \t      THEN LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,18,68)))   \t\t  ELSE LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,18,203)))    END) AS ANNOTAZIONI,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,86,3)))      AS PROG_UIU_DA,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,89,3)))      AS PROG_UIU_A,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,92,18)))     AS ROGANTE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,86,3)))      AS SEDE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,116,2)))     AS PROVINCIA,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,117,7)))     AS REPERTORIO,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,124,3)))     AS CAUSALE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,127,6)))     AS DATA_ANNOTA,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,133,6)))     AS VOLUME,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,139,6)))     AS DATA_REGISTRAZIONE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,145,57)))    AS ESTREMI_ATTO_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,204,57)))    AS ESTREMI_ATTO_03,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,269,1)) AS PRESENZA_ESTREMI  FROM DOC_DOCFA_1_0 DOC    WHERE SUBSTR(DOC.RIGA_DETTAGLIO,8,1) \= 'L'      AND re_FLAG_ELABORATO \= 0 
rengine.rule.sql.7.value=INSERT INTO docfa_dichiaranti             (fornitura, protocollo_reg, dic_cognome, dic_nome, dic_res_com,              dic_res_prov, dic_res_indir, dic_res_numciv, dic_res_cap,              tec_cognome, tec_nome, tec_codfisc, tec_isc_albo, tec_isc_numord,              tec_isc_prov, flag_doc_telem)    SELECT DATA AS fornitura,           LTRIM (RTRIM (protocollo)) AS protocollo_reg,           LTRIM (RTRIM (SUBSTR (doc.riga_dettaglio, 18, 24))) AS dic_cognome,           LTRIM (RTRIM (SUBSTR (doc.riga_dettaglio, 42, 20))) AS dic_nome,           LTRIM (RTRIM (SUBSTR (doc.riga_dettaglio, 62, 25))) AS dic_res_com,           LTRIM (RTRIM (SUBSTR (doc.riga_dettaglio, 87, 2))) AS dic_res_prov,           LTRIM (RTRIM (SUBSTR (doc.riga_dettaglio, 89, 35))) AS dic_res_indir,           LTRIM (RTRIM (SUBSTR (doc.riga_dettaglio, 124, 5))) AS dic_res_numciv,           LTRIM (RTRIM (SUBSTR (doc.riga_dettaglio, 129, 5))) AS dic_res_cap,           LTRIM (RTRIM (SUBSTR (doc.riga_dettaglio, 134, 24))) AS tec_cognome,           LTRIM (RTRIM (SUBSTR (doc.riga_dettaglio, 158, 20))) AS tec_nome,           LTRIM (RTRIM (SUBSTR (doc.riga_dettaglio, 178, 16))) AS tec_codfisc,           to_number_all (SUBSTR (doc.riga_dettaglio, 194, 2)) AS tec_isc_albo,           to_number_all (SUBSTR (doc.riga_dettaglio, 196, 5)                         ) AS tec_isc_numord,           LTRIM (RTRIM (SUBSTR (doc.riga_dettaglio, 201, 2))) AS tec_isc_prov,           to_number_all (SUBSTR (doc.riga_dettaglio, 328, 1)                         ) AS flag_doc_telem      FROM doc_docfa_1_0 doc     WHERE SUBSTR (doc.riga_dettaglio, 8, 1) \= 'M'       AND SUBSTR (doc.riga_dettaglio, 17, 1) \= 'A'       AND re_flag_elaborato \= 0 
rengine.rule.sql.8.value=INSERT INTO DOCFA_IN_PARTE_UNO  (FORNITURA, PROTOCOLLO_REG, NR_PROG, CT_SEZIONE, CT_FOGLIO,  CT_NUMERO, CT_DENOMINATORE_01, CT_NUMERO_01,CT_DENOMINATORE_02,  CU_SEZIONE,  CU_FOGLIO, CU_NUMERO, CU_DENOMINATORE_01,  CU_NUMERO_01,  CU_DENOMINATORE_02, ANNO_COSTRU, ANNO_RISTRU, POSIZIONE_FABB, COMPLESSO_IMM,  NR_EDIFICI, NR_ABITAZ, NR_NEGOZI, NR_MAGAZZ,  NR_LABORA,  NR_UFFICI,  NR_BOX,  NR_AUTORIM,  NR_IMP_SPO,  NR_UIU_CTB, CORTILE_INTERNO, NR_SCALE,  TIPO_ACCES,  DIM_P_FUORI_TER, DIM_P_FUORI_TER_MIN, DIM_P_FUORI_TER_MAX, DIM_P_ENTRO_TER,  DIM_P_ENTRO_TER_MIN, DIM_P_ENTRO_TER_MAX,DNS_F_FUORI_TER_INT, DNS_F_FUORI_TER_DEC,  DNS_F_ENTRO_TER_INT, DNS_F_ENTRO_TER_DEC, CORPI_ACC_FUO_TE_01, CORPI_ACC_ENT_TE_01,  CORPI_ACC_FUO_TE_02, CORPI_ACC_ENT_TE_02, CORPI_ACC_FUO_TE_03, CORPI_ACC_ENT_TE_03,  CORPI_ACC_FUO_TE_04, CORPI_ACC_ENT_TE_04, SPZ_COP_GUARDIOLA, SPZ_COP_ALLOG_CUS,SPZ_COP_SALA_RIUN,  SPZ_COP_ATRIO, SPZ_COP_PORTICATO, SPZ_COP_LAVATOIO, SPZ_COP_PISCINA, SPZ_COP_ALTRA_DES,  SUPMQ_SALA_RIUNIONI, SUPMQ_ATRIO, SUPMQ_PORTICATO, SUPMQ_LAVATOIO, SUPMQ_PISCINA_COPE,  SUPMQ_COP_ALTRA_DES, SPZ_SCO_TERRAZZA, SPZ_SCO_CORTILE, SPZ_SCO_VERDE, SPZ_SCO_PARCHEGGIO,  SPZ_SCO_TENNIS, SPZ_SCO_PISCINE, SPZ_SCO_ALTRE_DES, SUPMQ_TERRAZZA, SUPMQ_CORTILE,  SUPMQ_VERDE, NR_POSTI_AUTO, NR_CAMPI_TENNIS, SUPMQ_PISCINA_SCO, SUPMQ_SCO_ALTRA_DES,  AF_STR_OLTRE_10M_01, AF_STR_FINO_10M_01, AF_PIAZZA_01, AF_FABB_ABIT_01, AF_FABB_USO_DIV_01,  AF_VERDE_PUBB_01, AF_VERDE_PRIV_01, AF_ALTRO_01, AF_FACCIATA_ADER_01,AF_STR_OLTRE_10M_02,  AF_STR_FINO_10M_02,AF_PIAZZA_02, AF_FABB_ABIT_02, AF_FABB_USO_DIV_02,  AF_VERDE_PUBB_02,  AF_VERDE_PRIV_02, AF_ALTRO_02, AF_FACCIATA_ADER_02, AF_STR_OLTRE_10M_03,AF_STR_FINO_10M_03,  AF_PIAZZA_03,AF_FABB_ABIT_03, AF_FABB_USO_DIV_03, AF_VERDE_PUBB_03,AF_VERDE_PRIV_03, AF_ALTRO_03,  AF_FACCIATA_ADER_03, AF_STR_OLTRE_10M_04, AF_STR_FINO_10M_04,AF_PIAZZA_04,  AF_FABB_ABIT_04,  AF_FABB_USO_DIV_04, AF_VERDE_PUBB_04, AF_VERDE_PRIV_04, AF_ALTRO_04, AF_FACCIATA_ADER_04, AF_DESC_ALTRO_TIPO )    SELECT DATA AS FORNITURA,  \tLTRIM(RTRIM(PROTOCOLLO)) AS PROTOCOLLO_REG,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,9,3))) AS NR_PROG,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,18,3))) AS CT_SEZIONE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,21,4))) AS CT_FOGLIO,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,25,5))) AS CT_NUMERO,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,30,4))) AS CT_DENOMINATORE_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,34,5))) AS CT_NUMERO_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,39,4))) AS CT_DENOMINATORE_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,43,3))) AS CU_SEZIONE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,46,4))) AS CU_FOGLIO,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,50,5))) AS CU_NUMERO,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,55,4))) AS CU_DENOMINATORE_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,59,5))) AS CU_NUMERO_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,64,4))) AS CU_DENOMINATORE_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,68,4))) AS ANNO_COSTRU,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,72,4))) AS ANNO_RISTRU,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,76,1))) AS POSIZIONE_FABB,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,77,1))) AS COMPLESSO_IMM,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,78,4))) AS NR_EDIFICI,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,82,3))) AS NR_ABITAZ,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,85,2))) AS NR_NEGOZI,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,87,3))) AS NR_MAGAZZ,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,90,2))) AS NR_LABORA,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,92,2))) AS NR_UFFICI,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,94,3))) AS NR_BOX,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,97,2))) AS NR_AUTORIM,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,99,2))) AS NR_IMP_SPO,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,101,2))) AS NR_UIU_CTB,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,103,1))) AS FLG_CORTE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,104,3))) AS NR_SCALE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,107,1))) AS TIPO_ACCES,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,108,3))) AS DIM_P_FUORI_TER,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,111,3))) AS DIM_P_FUORI_TER_MIN,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,114,3))) AS DIM_P_FUORI_TER_MAX,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,117,3))) AS DIM_P_ENTRO_TER,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,120,3))) AS DIM_P_ENTRO_TER_MIN,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,123,3))) AS DIM_P_ENTRO_TER_MAX,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,126,2))) AS DNS_F_FUORI_TER_INT,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,128,2))) AS DNS_F_FUORI_TER_DEC,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,130,2))) AS DNS_F_ENTRO_TER_INT,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,132,2))) AS DNS_F_ENTRO_TER_DEC,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,134,2))) AS CORPI_ACC_FUO_TE_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,136,2))) AS CORPI_ACC_ENT_TE_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,138,2))) AS CORPI_ACC_FUO_TE_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,140,2))) AS CORPI_ACC_ENT_TE_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,142,2))) AS CORPI_ACC_FUO_TE_03,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,144,2))) AS CORPI_ACC_ENT_TE_03,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,146,2))) AS CORPI_ACC_FUO_TE_04,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,148,2))) AS CORPI_ACC_ENT_TE_04,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,150,1))) AS SPZ_COP_GUARDIOLA,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,151,1))) AS SPZ_COP_ALLOG_CUS,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,152,1))) AS SPZ_COP_SALA_RIUN,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,153,1))) AS SPZ_COP_ATRIO,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,154,1))) AS SPZ_COP_PORTICATO,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,155,1))) AS SPZ_COP_LAVATOIO,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,156,1))) AS SPZ_COP_PISCINA,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,157,1))) AS SPZ_COP_ALTRA_DES,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,158,4))) AS SUPMQ_SALA_RIUNIONI,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,162,3))) AS SUPMQ_ATRIO,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,165,4)) AS SUPMQ_PORTICATO,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,169,4)) AS SUPMQ_LAVATOIO,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,173,4))) AS SUPMQ_PISCINA_COPE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,177,10))) AS SUPMQ_COP_ALTRA_DES,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,187,1))) AS SPZ_SCO_TERRAZZA,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,188,1))) AS SPZ_SCO_CORTILE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,189,1))) AS SPZ_SCO_VERDE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,190,1))) AS SPZ_SCO_PARCHEGGIO,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,191,1))) AS SPZ_SCO_TENNIS,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,192,1))) AS SPZ_SCO_PISCINE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,193,1))) AS SPZ_SCO_ALTRE_DES,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,194,4))) AS SUPMQ_TERRAZZA,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,198,4))) AS SUPMQ_CORTILE,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,202,4))) AS SUPMQ_VERDE,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,206,4)) AS NR_POSTI_AUTO,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,210,4)) AS NR_CAMPI_TENNIS,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,214,4))) AS SUPMQ_PISCINA_SCO,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,218,10))) AS SUPMQ_SCO_ALTRA_DES,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,228,1))) AS AF_STR_OLTRE_10M_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,229,1))) AS AF_STR_FINO_10M_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,230,1))) AS AF_PIAZZA_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,231,1))) AS AF_FABB_ABIT_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,232,1))) AS AF_FABB_USO_DIV_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,233,1))) AS AF_VERDE_PUBB_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,234,1))) AS AF_VERDE_PRIV_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,235,1))) AS AF_ALTRO_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,236,1))) AS AF_FACCIATA_ADER_01,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,237,1))) AS AF_STR_OLTRE_10M_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,238,1))) AS AF_STR_FINO_10M_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,239,1))) AS AF_PIAZZA_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,240,1))) AS AF_FABB_ABIT_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,241,1))) AS AF_FABB_USO_DIV_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,242,1))) AS AF_VERDE_PUBB_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,243,1))) AS AF_VERDE_PRIV_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,244,1))) AS AF_ALTRO_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,245,1))) AS AF_FACCIATA_ADER_02,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,246,1))) AS AF_STR_OLTRE_10M_03,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,247,1))) AS AF_STR_FINO_10M_03,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,248,1))) AS AF_PIAZZA_03,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,249,1))) AS AF_FABB_ABIT_03,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,250,1))) AS AF_FABB_USO_DIV_03,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,251,1))) AS AF_VERDE_PUBB_03,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,252,1)) AS AF_VERDE_PRIV_03,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,253,1)) AS AF_ALTRO_03,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,254,1)) AS AF_FACCIATA_ADER_03,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,255,1)) AS AF_STR_OLTRE_10M_04,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,256,1)) AS AF_STR_FINO_10M_04,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,257,1)) AS AF_PIAZZA_04,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,258,1)) AS AF_FABB_ABIT_04,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,259,1)) AS AF_FABB_USO_DIV_04,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,260,1)) AS AF_VERDE_PUBB_04,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,261,1)) AS AF_VERDE_PRIV_04,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,262,1)) AS AF_ALTRO_04,    To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,263,1)) AS AF_FACCIATA_ADER_04,    LTRIM(RTRIM(SUBSTR(DOC.RIGA_DETTAGLIO,264,18))) AS AF_DESC_ALTRO_TIPO   FROM DOC_DOCFA_1_0 DOC     WHERE SUBSTR(DOC.RIGA_DETTAGLIO,8,1) \= 'N'      AND SUBSTR(DOC.RIGA_DETTAGLIO,17,1) \= 'B'      AND re_FLAG_ELABORATO \= 0    ORDER BY SUBSTR(DOC.RIGA_DETTAGLIO,9,3) 
rengine.rule.sql.9.value=INSERT INTO docfa_dati_censuari             (fornitura, codice_amminstrativo, sezione,              identificativo_immobile, protocollo_registrazione,              data_registrazione, zona, categoria, classe, consistenza,              superficie, rendita_euro, partita_speciale, lotto, edificio,              scala, interno_1, interno_2, piano_1, piano_2, piano_3, piano_4,              sezione_urbana, foglio, numero, denominatore, subalterno,              edificabilita, presenza_graffati, toponimo, indirizzo, civico_1,              civico_2, civico_3, ulteriori_indirizzi)    SELECT DATA AS fornitura,           LTRIM (RTRIM (codice_ente)) AS codice_amministrativo,           LTRIM (RTRIM (sezione)),           LTRIM (RTRIM (identificativo_immo)) AS identificativo_immobile,           LTRIM (RTRIM (protocollo_reg)) AS protocollo_registrazione,           TO_CHAR (data_reg, 'YYYYMMDD') AS data_registrazione,           LTRIM (RTRIM (zona)), LTRIM (RTRIM (categoria)),           LTRIM (RTRIM (classe)), LTRIM (RTRIM (consistenza)),           LTRIM (RTRIM (superficie)), LTRIM (RTRIM (rendita_euro)),           LTRIM (RTRIM (partita_speciale)), LTRIM (RTRIM (lotto)),           LTRIM (RTRIM (edificio)), LTRIM (RTRIM (scala)),           LTRIM (RTRIM (interno_uno)) AS interno_1,           LTRIM (RTRIM (interno_due)) AS interno_2,           LTRIM (RTRIM (piano_uno)) AS piano_1, piano_due AS piano_2,           LTRIM (RTRIM (piano_tre)) AS piano_3,           LTRIM (RTRIM (piano_quatro)) AS piano_4,           LTRIM (RTRIM (sezione_urbana)), LTRIM (RTRIM (foglio)),           LTRIM (RTRIM (numero)), LTRIM (RTRIM (denominatore)),           LTRIM (RTRIM (subalterno)), LTRIM (RTRIM (edificabilita)),           LTRIM (RTRIM (presenza_graffati)), LTRIM (RTRIM (toponimo)),           LTRIM (RTRIM (indirizzo)), LTRIM (RTRIM (civico_uno)) as_civico_1,           LTRIM (RTRIM (civico_due)) as_civico_2,           LTRIM (RTRIM (civico_tre)) as_civico_3,           LTRIM (RTRIM (ulteriori_indirizzi))      FROM dc_docfa_1_0 doc     WHERE re_flag_elaborato \= 0 
rengine.rule.sql.10.value=INSERT INTO DOCFA_DATI_METRICI  ( FORNITURA, CODICE_AMMINISTRATIVO, SEZIONE,IDENTIFICATIVO_IMMOBILE,  PROTOCOLLO_REGISTRAZIONE, DATA_REGISTRAZIONE, PROG_POLIGONO,  SUPERFICIE, AMBIENTE, ALTEZZA, ALTEZZA_MAX)   SELECT DATA  \t\t\t\t\tAS FORNITURA,    LTRIM(RTRIM(COD_ENTE))                  AS CODICE_AMMINISTRATIVO,     LTRIM(RTRIM(SEZIONE)),             IDENTIFICATIVO_IMMO       AS IDENTIFICATIVO_IMMOBILE,     LTRIM(RTRIM(PROTOCOLLO_REG))            AS PROTOCOLLO_REGISTRAZIONE,     TO_CHAR(DATA_REG,'YYYYMMDD')                  AS DATA_REGISTRAZIONE,     PROGRESSIVO_POL           AS PORG_POLIGONO,     SUPERFICIE,     LTRIM(RTRIM(AMBIENTE)),     ALTEZZA,     ALTEZZA_MAX   FROM DM_DOCFA_1_0 DOC      WHERE re_FLAG_ELABORATO \= 0 
rengine.rule.sql.11.value=INSERT INTO docfa_planimetrie             (fornitura, protocollo, data_registrazione, nome_plan,              progressivo, formato, scala, identificativo_immo)    SELECT DATA, LTRIM (RTRIM (protocollo_reg)), data_reg,           LTRIM (RTRIM (nome_plan)), progressivo, formato, scala,           identificativo_immo      FROM pl_docfa_1_0     WHERE re_flag_elaborato \= 0 
rengine.rule.sql.12.value=UPDATE DM_DOCFA_1_0 SET re_flag_elaborato = 1 where re_flag_elaborato = 0
rengine.rule.sql.13.value=UPDATE PL_DOCFA_1_0 SET re_flag_elaborato = 1 where re_flag_elaborato = 0
rengine.rule.sql.14.value=UPDATE DC_DOCFA_1_0 SET re_flag_elaborato = 1 where re_flag_elaborato = 0
rengine.rule.sql.15.value=UPDATE DOC_DOCFA_1_0 SET re_flag_elaborato = 1 where re_flag_elaborato = 0
rengine.rule.sql.16.value=insert into docfa_in_parte_due_h ( fornitura,   protocollo_reg,   nr_prog,   ct_sezione_01,   ct_foglio_01,   ct_numero_01,   ct_denominatore_01,   ct_subalterno_01,   ct_sezione_02,   ct_foglio_02,   ct_numero_02,   ct_denominatore_02,   ct_subalterno_02,   ct_sezione_03,   ct_foglio_03,   ct_numero_03,   ct_denominatore_03,   ct_subalterno_03,   ct_sezione_04,   ct_foglio_04,   ct_numero_04,   ct_denominatore_04,   ct_subalterno_04,   anno_costruzione,   anno_ristrut,   tipo_categ_immo,   ab_vani_princ_nr,   ab_vani_princ_superf_uti,   ab_accessori_dir_01_nr,   ab_accessori_dir_01_superf_uti,   ab_accessori_dir_02_nr,   ab_accessori_dir_02_superf_uti,   ab_vprinc_vacc_dir_superf_lor,   ab_accessori_indir_nr,   ab_accessori_indir_superf_lor,   ab_dip_uso_escl_01_superf_lor,   ab_dip_uso_escl_02_superf_lor,   ab_pert_uso_escl_01_superf_lor,   ab_pert_uso_escl_02_descr,   ab_pert_uso_escl_02_superf_lor,   ab_pert_uso_tot_superf_lor,   ab_park_nr_posti,   ab_altezza_media_uiu,   ab_sup_vprinc_vacc_inf_230cm,   ab_piani_fuori_terra_nr,   ab_piani_fuori_terra_mc,   ab_piani_entro_terra_nr,   ab_piani_entro_terra_mc,   c_loc_princ_pian0_01,    c_loc_princ_sup_lor_01,   c_loc_princ_sup_uti_01,   c_loc_princ_pian0_02,     c_loc_princ_sup_lor_02,   c_loc_princ_sup_uti_02,   c_loc_acc_dir_pian0_01,   c_loc_acc_dir_sup_lor_01,   c_loc_acc_dir_sup_uti_01,   c_loc_acc_dir_pian0_02,     c_loc_acc_dir_sup_lor_02,   c_loc_acc_dir_sup_uti_02,   c_loc_acc_indir_pian0_01,   c_loc_acc_indir_sup_lor_01,   c_loc_acc_indir_sup_uti_01,   c_loc_acc_indir_pian0_02,   c_loc_acc_indir_sup_lor_02,   c_loc_acc_indir_sup_uti_02,   c_dipend_uso_escl_sup_lor_01,   c_dipend_uso_escl_sup_lor_02,   c_pert_uso_escl_superf,   c_pert_sco_usoesc_postiauto_nr,   c_flag_accesso_carrabile,   c_altezz_med_loc_princ,   c_sup_vprinc_vacc_inf_230cm,   c_flag_posto_auto_scoperto,   categoria_catastale,   riscaldamento,      acqua_calda,        condizionamento,    citofonico,         video_citofonico,          ascensore_uso_escl,        ascensore,                 ascensore_di_servi,        montacarichi,              ascensori_nr,              altre_dotaz,               camere_pav_marmo,          camere_pav_ceramica,       camere_pav_scag_marmo,     camere_pav_moquet,         camere_pav_gomme,          camere_pav_parquet,             camere_pav_altro,               cuc_ba_pav_marmo,               cuc_ba_pav_ceramica,   cuc_ba_pav_scag_marmo,   cuc_ba_pav_moquet,   cuc_ba_pav_gomme,   cuc_ba_pav_parquet,   cuc_ba_pav_altro,   altri_pav_marmo,   altri_pav_ceramica,   altri_pav_scag_marmo,   altri_pav_moquet,   altri_pav_gomme,   altri_pav_parquet,   altri_pav_altro,   descr_altra_pavim,   categoria_alfab )  select    data as fornitura,     protocollo as protocollo_reg,   to_number_all(substr(doc.riga_dettaglio,9,3)) as nr_prog,   substr(doc.riga_dettaglio,18,3) as ct_sezione_01,   substr(doc.riga_dettaglio,21,4) as ct_foglio_01,   substr(doc.riga_dettaglio,25,5) as ct_numero_01,   to_number_all(substr(doc.riga_dettaglio,30,4)) as ct_denominatore_01,   substr(doc.riga_dettaglio,34,4) as ct_subalterno_01,   substr(doc.riga_dettaglio,38,3) as ct_sezione_02,   substr(doc.riga_dettaglio,41,4) as ct_foglio_02,   substr(doc.riga_dettaglio,45,5) as ct_numero_02,   to_number_all(substr(doc.riga_dettaglio,50,4)) as ct_denominatore_02,   substr(doc.riga_dettaglio,54,4) as ct_subalterno_02,   substr(doc.riga_dettaglio,58,3) as ct_sezione_03,   substr(doc.riga_dettaglio,61,4) as ct_foglio_03,   substr(doc.riga_dettaglio,65,5) as ct_numero_03,   to_number_all(substr(doc.riga_dettaglio,70,4)) as ct_denominatore_03,   substr(doc.riga_dettaglio,74,4) as ct_subalterno_03,   substr(doc.riga_dettaglio,78,3) as ct_sezione_04,   substr(doc.riga_dettaglio,81,4) as ct_foglio_04,   substr(doc.riga_dettaglio,85,5) as ct_numero_04,   to_number_all(substr(doc.riga_dettaglio,90,4)) as ct_denominatore_04,   substr(doc.riga_dettaglio,94,4) as ct_subalterno_04,   to_number_all(substr(doc.riga_dettaglio,98,4))  as anno_costruzione,   to_number_all(substr(doc.riga_dettaglio,102,4)) as anno_ristrut,   to_number_all(substr(doc.riga_dettaglio,106,1)) as tipo_categ_immo,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,107,5))            else null   end) as ab_vani_princ_nr,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,112,5))            else null   end) as ab_vani_princ_superf_uti,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,117,2))            else null   end) as ab_accessori_dir_01_nr,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,119,5))            else null   end) as ab_accessori_dir_01_superf_uti,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,124,2))            else null   end) as ab_accessori_dir_02_nr,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,126,5))            else null   end) as ab_accessori_dir_02_superf_uti,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,131,5))            else null   end) as ab_vprinc_vacc_dir_superf_lor,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,136,4))            else null   end) as ab_accessori_indir_nr,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,140,5))            else null   end) as ab_accessori_indir_superf_lor,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,145,5))            else null   end) as ab_dip_uso_escl_01_superf_lor,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,150,5))            else null   end) as ab_dip_uso_escl_02_superf_lor,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,155,5))            else null   end) as ab_pert_uso_escl_01_superf_lor,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then substr(riga_dettaglio,160,15)            else null   end) as ab_pert_uso_escl_02_descr,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,175,5))            else null   end) as ab_pert_uso_escl_02_superf_lor,   (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,180,6))            else null   end) as ab_pert_uso_tot_superf_lor,    (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,186,4))            else null   end) as ab_park_nr_posti,  (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,190,3))            else null   end) as ab_altezza_media_uiu,  (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,193,5))            else null   end) as ab_sup_vprinc_vacc_inf_230cm,  (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,202,2))            else null   end) as ab_piani_fuori_terra_nr,  (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,204,6))            else null   end) as ab_piani_fuori_terra_mc,  (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,210,2))            else null   end) as ab_piani_entro_terra_nr,  (case      when ( substr(doc.riga_dettaglio,106,1) \= '1' or substr(doc.riga_dettaglio,106,1) \= '0')            then to_number_all(substr(riga_dettaglio,212,6))            else null   end) as ab_piani_entro_terra_mc,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,106,3))            else null   end) as c_loc_princ_piano_01,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,109,5))            else null   end) as c_loc_princ_sup_lor_01,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,114,5))            else null   end) as c_loc_princ_sup_uti_01,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,119,3))            else null   end) as c_loc_princ_pian0_02,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,122,5))            else null   end) as c_loc_princ_sup_lor_02,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,127,5))            else null   end) as c_loc_princ_sup_uti_02,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,132,3))            else null   end) as c_loc_acc_dir_piano_01,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,135,5))            else null   end) as c_loc_acc_dir_sup_lor_01,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,140,5))            else null   end) as c_loc_acc_dir_sup_uti_01,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,145,3))            else null   end) as c_loc_acc_dir_pian0_02,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,148,5))            else null   end) as c_loc_acc_dir_sup_lor_02,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,153,5))            else null   end) as c_loc_acc_dir_sup_uti_02,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then substr(riga_dettaglio,158,3)            else null   end) as c_loc_acc_indir_pian0_01,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then substr(riga_dettaglio,161,5)            else null   end) as c_loc_acc_indir_sup_lor_01,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,166,5))            else null   end) as c_loc_acc_indir_sup_uti_01,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then substr(riga_dettaglio,171,3)            else null   end) as c_loc_acc_indir_pian0_02,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then substr(riga_dettaglio,174,5)            else null   end) as c_loc_acc_indir_sup_lor_02,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then substr(riga_dettaglio,179,5)            else null   end) as c_loc_acc_indir_sup_uti_02,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then substr(riga_dettaglio,184,5)            else null   end) as c_dipend_uso_escl_sup_lor_01,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then substr(riga_dettaglio,189,5)            else null   end) as c_dipend_uso_escl_sup_lor_02,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,214,5))            else null   end) as c_pert_uso_escl_superf,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,219,4))            else null   end) as c_pert_sco_usoesc_postiauto_nr,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,229,1))            else null   end) as c_flag_accesso_carrabile,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,231,3))            else null   end) as c_altezz_med_loc_princ,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then substr(riga_dettaglio,234,5)            else null   end) as c_sup_vprinc_vacc_inf_230cm,  (case      when ( substr(doc.riga_dettaglio,106,1) <> '1' and substr(doc.riga_dettaglio,106,1) <> '0')            then to_number_all(substr(riga_dettaglio,244,1))            else null   end) as c_flag_posto_auto_scoperto,   substr(riga_dettaglio,247,3) as categoria_catastale,    to_number_all(substr(riga_dettaglio,250,1)) as riscaldamento,    to_number_all(substr(riga_dettaglio,251,1)) as acqua_calda,    to_number_all(substr(riga_dettaglio,252,1)) as condizionamento,    to_number_all(substr(riga_dettaglio,253,1)) as citofonico,    to_number_all(substr(riga_dettaglio,254,1)) as video_citofonico,    to_number_all(substr(riga_dettaglio,255,1)) as ascensore_uso_escl,    to_number_all(substr(riga_dettaglio,256,1)) as ascensore,    to_number_all(substr(riga_dettaglio,257,1)) as ascensore_di_servi,    to_number_all(substr(riga_dettaglio,258,1)) as montacarichi,    to_number_all(substr(riga_dettaglio,259,3)) as ascensori_nr,    to_number_all(substr(riga_dettaglio,262,15)) as altre_dotaz,    to_number_all(substr(riga_dettaglio,296,1)) as camere_pav_marmo,    to_number_all(substr(riga_dettaglio,297,1)) as camere_pav_ceramica,    to_number_all(substr(riga_dettaglio,298,1)) as camere_pav_scag_marmo,    to_number_all(substr(riga_dettaglio,299,1)) as camere_pav_moquet,    to_number_all(substr(riga_dettaglio,300,1)) as camere_pav_gomme,    to_number_all(substr(riga_dettaglio,301,1)) as camere_pav_parquet,    to_number_all(substr(riga_dettaglio,302,1)) as camere_pav_altro,    to_number_all(substr(riga_dettaglio,303,1)) as cuc_ba_pav_marmo,    to_number_all(substr(riga_dettaglio,304,1)) as cuc_ba_pav_ceramica,    to_number_all(substr(riga_dettaglio,305,1)) as cuc_ba_pav_scag_marmo,    to_number_all(substr(riga_dettaglio,306,1)) as cuc_ba_pav_moquet,    to_number_all(substr(riga_dettaglio,307,1)) as cuc_ba_pav_gomme,    to_number_all(substr(riga_dettaglio,308,1)) as cuc_ba_pav_parquet,    to_number_all(substr(riga_dettaglio,309,1)) as cuc_ba_pav_altro,    to_number_all(substr(riga_dettaglio,310,1)) as altri_pav_marmo,    to_number_all(substr(riga_dettaglio,311,1)) as altri_pav_ceramica,    to_number_all(substr(riga_dettaglio,312,1)) as altri_pav_scag_marmo,    to_number_all(substr(riga_dettaglio,313,1)) as altri_pav_moquet,    to_number_all(substr(riga_dettaglio,314,1)) as altri_pav_gomme,    to_number_all(substr(riga_dettaglio,315,1)) as altri_pav_parquet,    to_number_all(substr(riga_dettaglio,316,1)) as altri_pav_altro,    substr(riga_dettaglio,317,15)as descr_altra_pavim,    substr(riga_dettaglio,332,1)as categoria_alfab   from doc_docfa_1_0 doc   where substr(doc.riga_dettaglio,8,1) \= 'U'         and substr(doc.riga_dettaglio,17,1) \= 'H'    and re_flag_elaborato \= 0   
rengine.rule.sql.17.value=INSERT INTO DOCFA_IN_PARTE_DUE_I ( FORNITURA,   PROTOCOLLO_REG,   NR_PROG,   INFIS_INT_PORTE_ING_LEGNO,   INFIS_INT_PORTE_ING_LEGNO_TAMB,   INFIS_INT_PORTE_ING_METALLO,   INFIS_INT_PORTE_ING_ALTRO,   INFIS_INT_PORTE_INT_LEGNO,   INFIS_INT_PORTE_INT_LEGNO_TAMB,   INFIS_INT_PORTE_INT_METALLO,   INFIS_INT_PORTE_INT_ALTRO,   INFIS_INT_ALTRI_DESC,     DESTINAZIONE_USO,    CATEGORIA_APPARTENENZA ) SELECT    DATA AS FORNITURA,     PROTOCOLLO AS PROTOCOLLO_REG,   SUBSTR(DOC.RIGA_DETTAGLIO,9,3) AS NR_PROG,   To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,45,1))  AS INFIS_INT_PORTE_ING_LEGNO,   To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,46,1))  AS INFIS_INT_PORTE_ING_LEGNO_TAMB,   To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,47,1))  AS INFIS_INT_PORTE_ING_METALLO,   To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,48,1))  AS INFIS_INT_PORTE_ING_ALTRO,   To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,49,1))  AS INFIS_INT_PORTE_INT_LEGNO,   To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,50,1))  AS INFIS_INT_PORTE_INT_LEGNO_TAMB,   To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,51,1))  AS INFIS_INT_PORTE_INT_METALLO,   To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,52,1))  AS INFIS_INT_PORTE_INT_ALTRO,   To_Number_All(SUBSTR(DOC.RIGA_DETTAGLIO,53,15)) AS INFIS_INT_ALTRI_DESC,   SUBSTR(DOC.RIGA_DETTAGLIO,199,50) AS DESTINAZIONE_USO,   SUBSTR(DOC.RIGA_DETTAGLIO,260,1)  AS CATEGORIA_APPARTENENZA  FROM DOC_DOCFA_1_0 DOC   WHERE SUBSTR(DOC.RIGA_DETTAGLIO,8,1) \= 'U'         AND SUBSTR(DOC.RIGA_DETTAGLIO,17,1) \= 'I' AND re_FLAG_ELABORATO \= 0
#
rengine.rule.dwh.tab=DOC_DOCFA_1_0,DM_DOCFA_1_0,DC_DOCFA_1_0,PL_DOCFA_1_0
#
rengine.rule.sql.semaforo.check=select NOME_TAB, FLAG_SEMAFORO from semaforo where FLAG_SEMAFORO = 1 AND ($CONTROLLO_SEMAFORO)
rengine.rule.sql.semaforo.on=UPDATE semaforo set FLAG_SEMAFORO = 1 WHERE $CONTROLLO_SEMAFORO
rengine.rule.sql.semaforo.off=UPDATE semaforo set FLAG_SEMAFORO = 0 WHERE $CONTROLLO_SEMAFORO
