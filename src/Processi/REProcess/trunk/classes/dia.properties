# PARAMETRIZZAZIONE DIAGNOSTICHE

dia.1=select distinct id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana from sit_d_persona WHERE codfisc IS NULL AND dt_fine_val IS NULL order by cognome, nome
		
dia.2=SELECT distinct id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM sit_d_persona p WHERE codfisc \= '0000000000000000' AND dt_fine_val IS NULL order by cognome, nome

dia.3=SELECT distinct id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM sit_d_persona p WHERE codfisc like '%CFX%' AND dt_fine_val IS NULL order by cognome, nome

dia.4=SELECT DISTINCT id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM sit_d_persona WHERE posiz_ana not in ('R','D','E','X','I','A', 'CANCELLATO DALL''A.P.R.','ISCRITTO NELL''A.I.R.E.','CANCELLATO DALL''A.I.R.E.','MAI RESIDENTE','ISCRITTO NELL''A.P.R.') AND dt_fine_val IS NULL order by cognome, nome

dia.5=SELECT DISTINCT id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM sit_d_persona where cognome IS NULL AND dt_fine_val IS NULL order by cognome, nome
		
dia.6=SELECT DISTINCT id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM sit_d_persona WHERE nome IS NULL AND dt_fine_val IS NULL order by cognome, nome

dia.7=SELECT DISTINCT id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM sit_d_persona WHERE data_nascita IS NULL AND dt_fine_val IS NULL order by cognome, nome

dia.8=SELECT DISTINCT id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM sit_d_persona WHERE (id_ext_comune_nascita \= '0000000    1' OR id_ext_comune_nascita \= '000001    1') AND dt_fine_val IS NULL order by cognome, nome

dia.9=SELECT DISTINCT id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM sit_d_persona WHERE data_inizio_residenza IS NULL AND posiz_ana not in ('X','MAI RESIDENTE') AND dt_fine_val IS NULL order by cognome, nome

dia.10=SELECT DISTINCT id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM sit_d_persona WHERE data_emi IS NULL AND posiz_ana in ('E','CANCELLATO DALL''A.P.R.') AND data_mor IS NULL AND dt_fine_val IS NULL order by cognome, nome

dia.11=SELECT DISTINCT id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM sit_d_persona WHERE (id_ext_comune_emi \= '0000000    1' OR id_ext_comune_emi \= '000001    1' or id_ext_comune_emi is null) AND posiz_ana in ('E','CANCELLATO DALL''A.P.R.') AND data_mor IS NULL AND dt_fine_val IS NULL order by cognome, nome

dia.12=SELECT DISTINCT id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM sit_d_persona WHERE data_mor IS NULL AND posiz_ana \= 'D' AND dt_fine_val IS NULL order by cognome, nome

dia.13=select distinct id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana from sit_d_persona where codfisc in (SELECT codfisc FROM sit_d_persona WHERE codfisc IS NOT NULL AND dt_fine_val IS NULL GROUP BY codfisc HAVING COUNT (*) > 1) order by codfisc, cognome, nome

dia.14=SELECT distinct id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM sit_d_persona p WHERE p.posiz_ana in ('A', 'ISCRITTO NELL''A.P.R.') AND p.dt_fine_val IS NULL AND NOT EXISTS (SELECT 1 FROM sit_d_pers_fam f WHERE p.id_ext \= f.id_ext_d_persona AND f.dt_fine_val IS NULL) order by cognome, nome

dia.15=SELECT distinct id_orig_persona as id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM persona_civici_v where civ_liv1 \= '000' and posiz_ana in ('A', 'ISCRITTO NELL''A.P.R.') and dt_fine_val is null order by cognome, nome

dia.16=SELECT DATI.* FROM (SELECT id_ext_d_famiglia FROM (SELECT DISTINCT id_ext_d_famiglia, id_ext_d_civico FROM (SELECT fam.id_ext_d_famiglia, id_ext_d_civico FROM sit_d_pers_fam fam, sit_d_persona pers, sit_d_persona_civico pc, sit_d_civico c,  sit_d_via v WHERE fam.id_ext_d_persona \= pers.id_ext AND pers.id_ext \= pc.id_ext_d_persona AND pc.id_ext_d_civico \= c.id_ext AND c.id_ext_d_via \= v.id_ext AND pers.posiz_ana in ('A', 'ISCRITTO NELL''A.P.R.') AND PERS.DT_FINE_VAL IS NULL AND FAM.DT_FINE_VAL IS NULL AND PC.DT_FINE_VAL IS NULL AND C.DT_FINE_VAL IS NULL AND V.DT_FINE_VAL IS NULL))GROUP BY id_ext_d_famiglia HAVING COUNT (*) > 1) nfam, (SELECT fam.id_ext_d_famiglia AS NR_FAMIGLIA, fam.id_orig AS Matricola, pers.cognome, pers.nome, pers.codfisc AS CODICE_FISCALE, v.id_orig COD_VIA, v.viasedime || ' ' || v.descrizione AS DESCRIZIONE_INDIR, EXTRACT (civico_composto, '/civicocomposto/att[@tipo\="numero"]/@valore' ).getstringval () AS CIVICO FROM sit_d_pers_fam fam, sit_d_persona pers, sit_d_persona_civico pc, sit_d_civico c, sit_d_via v WHERE fam.id_ext_d_persona \= pers.id_ext AND pers.id_ext \= pc.id_ext_d_persona AND pc.id_ext_d_civico \= c.id_ext AND c.id_ext_d_via \= v.id_ext AND pers.posiz_ana in ('A', 'ISCRITTO NELL''A.P.R.') AND PERS.DT_FINE_VAL IS NULL AND FAM.DT_FINE_VAL IS NULL AND PC.DT_FINE_VAL IS NULL AND C.DT_FINE_VAL IS NULL AND V.DT_FINE_VAL IS NULL) dati WHERE nfam.id_ext_d_famiglia \= dati.NR_FAMIGLIA ORDER BY NR_FAMIGLIA
	
dia.17=SELECT p.id_orig, cognome, nome, data_nascita, sesso, codfisc, posiz_ana FROM SIT_D_PERS_FAM F, SIT_D_PERSONA P  WHERE F.RELAZ_PAR IS NULL AND P.ID_ext \= F.id_ext_D_PERSONA AND F.DT_FINE_VAL IS NULL AND P.DT_FINE_VAL IS NULL  \t\t  

dia.18=SELECT P.id_orig , cognome, nome, data_nascita, sesso, codfisc, posiz_ana, DATA_MOR AS DATA_DECESSO FROM SIT_D_PERSONA P, SIT_D_PERS_FAM F WHERE P.ID_ext \= F.id_ext_D_PERSONA AND (P.POSIZ_ANA \= 'D' OR (P.POSIZ_ANA \= 'CANCELLATO DALL''A.P.R.' AND data_mor IS NOT NULL)) AND F.DT_INIZIO_DATO IS NULL AND P.DATA_INIZIO_RESIDENZA IS NULL AND P.DT_FINE_VAL IS NULL AND F.DT_FINE_VAL IS NULL

dia.19=SELECT P.id_orig , cognome, nome, data_nascita, sesso, codfisc, posiz_ana, DATA_EMI AS DATA_EMIGRAZIONE FROM SIT_D_PERSONA P, SIT_D_PERS_FAM F WHERE P.ID_ext \= F.id_ext_D_PERSONA AND P.POSIZ_ANA in ('E','CANCELLATO DALL''A.P.R.') AND data_mor IS NULL AND F.DT_INIZIO_DATO IS NULL AND P.DATA_INIZIO_RESIDENZA IS NULL AND P.DT_FINE_VAL IS NULL AND F.DT_FINE_VAL IS NULL     

dia.20=SELECT P.id_orig , cognome, nome, data_nascita, sesso, codfisc, posiz_ana, DATA_EMI AS DATA_EMIGRAZIONE FROM SIT_D_PERSONA P, SIT_D_PERS_FAM F WHERE P.ID_ext \= F.id_ext_D_PERSONA AND P.POSIZ_ANA in ('R','ISCRITTO NELL''A.I.R.E.') AND F.DT_INIZIO_DATO IS NULL AND P.DATA_INIZIO_RESIDENZA IS NULL AND P.DT_FINE_VAL IS NULL AND F.DT_FINE_VAL IS NULL

dia.21=SELECT P.id_orig , cognome, nome, data_nascita, sesso, codfisc, posiz_ana, DATA_MOR AS DATA_DECESSO FROM SIT_D_PERSONA P, SIT_D_PERSONA_CIVICO C WHERE P.ID_ext \= C.id_ext_D_PERSONA AND (P.POSIZ_ANA \= 'D' OR (P.POSIZ_ANA \= 'CANCELLATO DALL''A.P.R.' AND data_mor IS NOT NULL)) AND C.DT_INIZIO_DATO IS NULL AND P.DATA_INIZIO_RESIDENZA IS NULL AND P.DT_FINE_VAL IS NULL AND C.DT_FINE_VAL IS NULL 

dia.22=SELECT P.id_orig , cognome, nome, data_nascita, sesso, codfisc, posiz_ana, DATA_EMI AS DATA_EMIGRAZIONE FROM SIT_D_PERSONA P, SIT_D_PERSONA_CIVICO C WHERE P.ID_ext \= C.id_ext_D_PERSONA AND P.POSIZ_ANA in ('R','ISCRITTO NELL''A.I.R.E.') AND C.DT_INIZIO_DATO IS NULL AND P.DATA_INIZIO_RESIDENZA IS NULL AND P.DT_FINE_VAL IS NULL AND C.DT_FINE_VAL IS NULL 

dia.23=SELECT P.id_orig , cognome, nome, data_nascita, sesso, codfisc, posiz_ana, DATA_EMI AS DATA_EMIGRAZIONE FROM SIT_D_PERSONA P WHERE P.POSIZ_ANA in ('E','CANCELLATO DALL''A.P.R.') AND data_mor IS NULL AND P.DT_FINE_VAL IS NULL AND NOT EXISTS (SELECT 1 FROM SIT_D_PERS_FAM F WHERE P.ID_ext \= F.id_ext_D_PERSONA AND F.DT_FINE_VAL IS NULL) 

dia.24=SELECT COUNT(*) NUMERO_RECORD, POSIZ_ANA AS POSIZIONE_ANAGRAFICA FROM SIT_D_PERSONA WHERE DT_FINE_VAL IS NULL GROUP BY POSIZ_ANA UNION SELECT COUNT(*), 'TOTALE record' FROM SIT_D_PERSONA WHERE DT_FINE_VAL IS NULL 

dia.101=select distinct ninc, codfisc, partitaiva, cognome, nome, sesso, nasdata, luogonascita, denominazione from sit_t_contribuenti where codfisc is null and partitaiva is null order by cognome, nome

dia.102=select distinct ninc, codfisc, partitaiva, cognome, nome, sesso, nasdata, luogonascita, denominazione from sit_t_contribuenti where cognome is null and nome is null and denominazione is null order by codfisc

dia.103=select distinct ninc, codfisc, partitaiva, cognome, nome, sesso, nasdata, luogonascita, denominazione from sit_t_contribuenti where fk_t_civici is null and indirizzoesterno is null order by cognome, nome

dia.103.I921=select distinct ninc, codfisc, partitaiva, cognome, nome, sesso, nasdata, luogonascita, denominazione from sit_t_contribuenti where (fk_t_civici is null or fk_t_civici \= 0) and indirizzoesterno is null and luogoesterno is null order by cognome, nome

dia.104=select codfisc, partitaiva, cognome, nome, sesso, nasdata, luogonascita, denominazione, count(*) as occorrenze from sit_t_contribuenti group by codfisc, partitaiva, cognome, nome, sesso, nasdata, luogonascita, denominazione having count(*) > 1 order by denominazione, cognome, nome, nasdata

dia.105=SELECT DISTINCT c.codfisc cf_contr, i.codfisc cf_ici FROM sit_t_contribuenti c, sit_t_oggetti_ici i WHERE i.ninc \= c.ninc AND i.codfisc <> c.codfisc and i.ninc <> 0 and c.ninc <> 0

dia.106=SELECT DISTINCT codfisc FROM sit_t_oggetti_ici i WHERE NOT EXISTS (SELECT 1 FROM sit_t_contribuenti c WHERE i.ninc \= c.ninc and i.ninc <> 0 and c.ninc <> 0)

dia.107=select distinct ninc, foglio, particella, subalterno, categoria, classe, rendita, codfisc, partitaiva, quota_poss, indirizzo, den_numero, den_anno from sit_t_oggetti_ici where foglio is null and particella is null and subalterno is null

dia.108=select distinct ninc, foglio, particella, subalterno, categoria, classe, rendita, codfisc, partitaiva, quota_poss, indirizzo, den_numero, den_anno from sit_t_oggetti_ici where foglio is not null and particella is not null and subalterno is null order by foglio, particella, den_anno
   		
dia.109=select distinct ninc, foglio, particella, subalterno, categoria, classe, rendita, codfisc, partitaiva, quota_poss, indirizzo, den_numero, den_anno from sit_t_oggetti_ici where (foglio is not null and translate(foglio, 'A0123456789', 'A') is not null) or (particella is not null and translate(particella, 'A0123456789', 'A') is not null) or (subalterno is not null and translate (subalterno, 'A0123456789', 'A') is not null) order by foglio, particella, den_anno
   		
dia.110=select distinct ninc, foglio, particella, subalterno, categoria, classe, rendita, codfisc, partitaiva, quota_poss, indirizzo, den_numero, den_anno from sit_t_oggetti_ici where categoria is null or rendita is null order by foglio, particella, den_anno

dia.111=select distinct ninc, foglio, particella, subalterno, categoria, classe, rendita, codfisc, partitaiva, quota_poss, indirizzo, den_numero, den_anno from sit_t_oggetti_ici where fk_t_civici is null order by foglio, particella, den_anno
		
dia.112=select ninc, foglio, particella, subalterno, categoria, classe, rendita, codfisc, partitaiva, quota_poss, indirizzo, den_numero, den_anno from sit_t_oggetti_ici where foglio||'_'||particella||'_'||subalterno in (select distinct foglio||'_'||particella||'_'||subalterno from(SELECT distinct foglio, particella, subalterno, count(*) FROM (SELECT DISTINCT i.foglio, i.particella, i.subalterno, i.categoria FROM sit_t_oggetti_ici i WHERE foglio IS NOT NULL AND particella IS NOT NULL GROUP BY i.foglio, i.particella, i.subalterno, i.categoria) GROUP BY foglio, particella, subalterno HAVING COUNT (*) > 1)) order by foglio, particella, subalterno, den_anno

dia.113=select distinct ogg.ninc, ogg.ogge, ogg.foglio, ogg.particella, ogg.subalterno, ogg.descr_classe, ogg.superfice_totale, contr.codfisc, contr.cognome, contr.nome, contr.denominazione, contr.sesso, contr.luogonascita, contr.nasdata, vie.viasedime, vie.viades, civi.numero, civi.lettera, contr.indirizzoesterno, contr.luogoesterno from sit_t_oggetti_tarsu ogg left join sit_t_contribuenti contr on ogg.ninc \= contr.ninc left join sit_t_civici civi on contr.fk_t_civici \= civi.pk_civico left join sit_t_vie vie on civi.fk_vi_cod \= vie.pk_viacod where ogg.data_fine_ogge is null and ogg.data_fine_situaz is null and ogg.foglio is null and ogg.particella is null and ogg.subalterno is null and ogg.ninc <> 0 and contr.ninc <> 0 order by cognome, nome

dia.114=select distinct ninc, ogge, foglio, particella, subalterno, descr_classe, superfice_totale, codfisc from sit_t_oggetti_tarsu where data_fine_ogge is null and data_fine_situaz is null and (foglio is not null and translate(foglio, 'A0123456789', 'A') is not null) or (particella is not null and translate(particella, 'A0123456789', 'A') is not null) or (subalterno is not null and translate(subalterno, 'A0123456789', 'A') is not null)

dia.115=select distinct ninc, ogge, foglio, particella, subalterno, descr_classe, superfice_totale, codfisc from sit_t_oggetti_tarsu where data_fine_ogge is null and data_fine_situaz is null and fk_t_civici is null

dia.116=select distinct ninc, codfisc, partitaiva, cognome, nome, sesso, nasdata, luogonascita, denominazione from sit_t_contribuenti where length(codfisc) <> 16 order by cognome, nome

dia.117=select distinct ninc, codfisc, partitaiva, cognome, nome, sesso, nasdata, luogonascita, denominazione from sit_t_contribuenti where length(codfisc) <> 16 and length(partitaiva) <> 11 order by cognome, nome

dia.118=select distinct ninc, codfisc, partitaiva, cognome, nome, sesso, nasdata, luogonascita, denominazione from sit_t_contribuenti where ninc is null or ninc \= 0 order by cognome, nome

# tabella uiu_cond nn esiste - forse è una diagnostica relativa ad un solo ente	
dia.201=select distinct uiu_cond.* , null as civ1, null as civ2, null as civ3, cf AS codifisc, d_nascita AS data_nascita, null AS indirizzo, part as particella, perc_poss as perc_possesso, allegato as subalterno, sub as unimm from uiu_cond where foglio||'_'||part||'_'||allegato||'_'||sub in (select foglio||'_'||part||'_'||allegato||'_'||sub from (select foglio, part, allegato, sub, sum(perc_poss) somma_poss from uiu_cond where tipo_titolo\='Propriet\u00E0' group by foglio, part, allegato, sub) where round(somma_poss) > 100) order by foglio, part, sub

# tabella uiu_cond nn esiste - forse è una diagnostica relativa ad un solo ente	
dia.202=select distinct uiu_cond.* , null as civ1, null as civ2, null as civ3, cf AS codifisc, d_nascita AS data_nascita, null AS indirizzo, part as particella, perc_poss as perc_possesso, allegato as subalterno, sub as unimm from uiu_cond where denominazione like '%INTESTATO%' order by foglio, part, sub
	
# tabella uiu_cond nn esiste - forse è una diagnostica relativa ad un solo ente			
dia.203=select uiu_cond.* , null as civ1, null as civ2, null as civ3, cf AS codifisc, d_nascita AS data_nascita, null AS indirizzo, part as particella, perc_poss as perc_possesso, allegato as subalterno, sub as unimm from uiu_cond where CF like (select codent from sit_ente) || '%'

dia.301=SELECT DISTINCT i.ninc, i.foglio, i.particella, i.subalterno, i.categoria, i.classe, i.rendita, i.codfisc, i.partitaiva, i.indirizzo FROM sit_t_oggetti_ici i WHERE foglio IS NOT NULL AND particella IS NOT NULL AND subalterno IS NOT NULL AND NOT EXISTS (SELECT 1 FROM sitiuiu u WHERE LPAD (TO_CHAR (u.foglio), 5, '0') \= LPAD (i.foglio, 5, '0') AND u.particella \= LPAD (ltrim(i.particella), 5, '0') AND NVL (LPAD (TO_CHAR (u.unimm), 5, '0'), '99*99') \= NVL (LPAD (ltrim(i.subalterno), 5, '0'), '99*99'))

dia.302=SELECT DISTINCT u.foglio, u.particella, u.unimm, categoria, classe, rendita FROM sitiuiu u WHERE u.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy') AND NOT EXISTS (SELECT 1 FROM sit_t_oggetti_ici i WHERE LPAD (TRIM (i.foglio), 5, '0') \= LPAD (TO_CHAR (u.foglio), 5, '0') AND LPAD (TRIM (i.particella), 5, '0') \= u.particella AND NVL (LPAD (TRIM (i.subalterno), 5, '0'), '99*99') \= NVL (LPAD (TO_CHAR (u.unimm), 5, '0'), '99*99') AND i.foglio IS NOT NULL AND i.particella IS NOT NULL AND i.subalterno IS NOT NULL)

dia.303=SELECT DISTINCT denominazione, cognome, nome, cod_fiscale, part_iva, cuaa FROM (SELECT DISTINCT a.denominazione, a.cognome, a.nome, a.cod_fiscale, a.part_iva, c.cuaa, c.foglio, c.particella, c.unimm FROM siticonduz_imm_all c, anag_soggetti a WHERE a.cod_soggetto \= c.pk_cuaa AND a.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy') AND c.data_fine \= TO_DATE ('31/12/9999', 'dd/mm/yyyy') AND NOT EXISTS (SELECT 1 FROM sit_t_oggetti_ici i WHERE i.codfisc \= a.cod_fiscale) AND NOT EXISTS (SELECT 1 FROM sit_t_oggetti_ici i WHERE i.partitaiva \= a.part_iva))

dia.304=SELECT DISTINCT i.codfisc, i.partitaiva, c.cognome, c.nome FROM sit_t_oggetti_ici i, sit_t_contribuenti c WHERE c.ninc \= i.ninc and c.ninc <> 0 and i.ninc <> 0 AND NOT EXISTS (SELECT 1 FROM anag_soggetti a WHERE a.cod_fiscale \= i.codfisc AND a.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy')) AND NOT EXISTS (SELECT 1 FROM anag_soggetti a WHERE a.part_iva \= i.partitaiva AND a.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy')) AND NOT EXISTS (SELECT 1 FROM anag_soggetti a WHERE a.cognome \= c.cognome AND a.nome \= c.nome AND a.d_nascita \= fchar_to_date (c.nasdata, 'dd/mm/yyyy') AND a.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy')) AND NOT EXISTS (SELECT 1 FROM anag_soggetti a WHERE a.denominazione \= c.cognome || ' ' || c.nome AND a.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy'))

dia.401=select 1 from dual

dia.402=select 1 from dual

dia.403=select 1 from dual

dia.404=select 1 from dual

dia.405=select 1 from dual

dia.501=select su.foglio, su.particella as part, su.sub, su.unimm, su.categoria, su.classe, su.consistenza, su.rendita, su.sup_cat, su.piano, t.descr||ui.ind as indirizzo, ui.civ1, ui.civ2, ui.civ3, sc.cuaa as cf, ans.denominazione, ans.nome, ans.sesso, ans.d_nascita, sc.perc_poss, decode(sc.tipo_titolo,1,'Propriet\u00E0',9,'Altro') as tipo_titolo from sitiuiu su left join load_cat_uiu_id i on lpad(su.foglio,4,'0') \= i.foglio and su.particella \= i.mappale and lpad(su.unimm,4,'0') \= decode(i.sub,' ','0000',i.sub) left join load_cat_uiu_ind ui on i.progressivo \= ui.progressivo and i.id_imm \= ui.id_imm left join cat_d_toponimi t on ui.toponimo \= t.pk_id left join siticonduz_imm_all sc on su.cod_nazionale \= sc.cod_nazionale and su.foglio \= sc.foglio and su.particella \= sc.particella and su.sub \= sc.sub and su.unimm \= sc.unimm and su.data_fine_val \= sc.data_fine left join anag_soggetti ans on sc.pk_cuaa \= ans.cod_soggetto and sc.data_fine \= ans.data_fine_val where su.cod_nazionale \= (select uk_belfiore from ewg_tab_comuni) and su.data_fine_val \= to_date ('99991231', 'yyyymmdd') and su.categoria \= 'A06' and i.codi_fisc_luna \= (select uk_belfiore from ewg_tab_comuni) and i.sez \= ' ' and ui.progressivo \= 1 and ui.sezione \= ' ' and ui.seq \= 0 order by foglio, part, unimm

# tabella siti_I921.siticond_all nn esiste - forse è una diagnostica relativa ad un solo ente
dia.502=select distinct st.foglio, st.particella, st.sub, st.qual_cat as qual_cat_cod, d.desc_qual as qual_cat, st.classe_terreno, st.area_part, st.partita, st.valida, st.annotazioni, st.reddito_dominicale, st.reddito_agrario,sca.cuaa as cf, ans.denominazione, ans.nome, ans.sesso, ans.d_nascita, sca.perc_poss, DECODE(sca.tipo_titolo,1,'Propriet\u00E0',9,'Altro') AS tipo_titolo from sititrkc st left join siticods_qual d on st.qual_cat \= d.codi_qual left join siti_I921.siticond_all sca on st.cod_nazionale \= sca.cod_nazionale and st.foglio \= sca.foglio and st.particella \= sca.particella and st.sub \= sca.sub and st.data_fine \= sca.data_fine left join anag_soggetti ans on sca.pk_cuaa \= ans.cod_soggetto where st.qual_cat in (271,277,278,279,280,281,283,284,285,286,287,288,290) and st.data_fine \= to_date('99991231','yyyymmdd') order by foglio, particella, sub

# query in errore a causa dei campi della order by che nn sempre sono numerici !!		
dia.601=select distinct ogg.ninc, ogg.ogge, ogg.foglio, ogg.particella, ogg.subalterno, ogg.descr_classe, ogg.superfice_totale, contr.codfisc, contr.cognome, contr.nome, contr.denominazione, contr.sesso, contr.luogonascita, contr.nasdata, vie.viasedime, vie.viades, civi.numero, civi.lettera, contr.indirizzoesterno, contr.luogoesterno from sit_t_oggetti_tarsu ogg left join sit_t_contribuenti contr on ogg.ninc \= contr.ninc left join sit_t_civici civi on contr.fk_t_civici \= civi.pk_civico left join sit_t_vie vie on civi.fk_vi_cod \= vie.pk_viacod where ogg.data_fine_ogge is null and ogg.data_fine_situaz is null and ogg.foglio is not null and ogg.ninc <> 0 and contr.ninc <> 0 order by to_number(foglio), to_number(particella), to_number(subalterno)
		
dia.701=select distinct top.numero CODICE, top.prefisso PREFISSO, top.nome NOME, dem.id_orig CODICE_DEMOGRAFIA, dem.viasedime PREFISSO_DEMOGRAFIA, dem.descrizione NOME_DEMOGRAFIA, tri.id_orig CODICE_TRIBUTI, tri.prefisso PREFISSO_TRIBUTI, tri.descrizione NOME_TRIBUTI from sitidstr top left join sit_d_via dem on to_number(top.numero) \= to_number(dem.id_orig) left join sit_t_ici_via tri on to_number(top.numero) \= to_number(tri.id_orig) where top.data_fine_val \= to_date('99991231','yyyymmdd') and dem.dt_fine_val is null and dem.dt_fine_dato is null and  tri.dt_fine_val is null and dem.dt_fine_dato is null order by to_number(top.numero)

dia.702=SELECT T.COD_NAZIONALE, T.FOGLIO, T.PARTICELLA, PARTITA, QUAL_CAT QUALITA, CLASSE_TERRENO CLASSE, T.AREA_PART HA_ARE_CA, REDDITO_DOMINICALE, REDDITO_AGRARIO, ANNOTAZIONI FROM SITITRKC T, SITIPART P WHERE T.FOGLIO \= P.FOGLIO (+) AND T.PARTICELLA \= P.PARTICELLA (+) AND T.COD_NAZIONALE \= P.COD_NAZIONALE (+) AND P.SE_ROW_ID IS NULL AND T.DATA_FINE \= TO_DATE('31129999','ddmmyyyy') AND (P.DATA_FINE_VAL IS NULL OR P.DATA_FINE_VAL \= TO_DATE('31129999','ddmmyyyy')) ORDER BY T.COD_NAZIONALE, T.FOGLIO, T.PARTICELLA
		
dia.703=SELECT DISTINCT U.COD_NAZIONALE, U.FOGLIO, U.PARTICELLA FROM SITIUIU U, SITIPART P WHERE U.FOGLIO \= P.FOGLIO (+) AND U.PARTICELLA \= P.PARTICELLA (+) AND U.COD_NAZIONALE \= P.COD_NAZIONALE (+) AND P.SE_ROW_ID IS NULL AND U.DATA_FINE_VAL \= TO_DATE('31129999','ddmmyyyy') AND (P.DATA_FINE_VAL IS NULL OR P.DATA_FINE_VAL \= TO_DATE('31129999','ddmmyyyy')) ORDER BY U.COD_NAZIONALE, U.FOGLIO, U.PARTICELLA

dia.1101=select distinct tributo, cod_fisc, part_iva, cog_denom, nome, sesso, dt_nsc, des_com_nsc from sit_t_sogg where cod_fisc is null and (part_iva is null or lpad(part_iva, 11, '0') \= '00000000000') order by cog_denom, nome

dia.1102=select distinct tributo, cod_fisc, part_iva, cog_denom, nome, sesso, dt_nsc, des_com_nsc from sit_t_sogg where cog_denom is null and nome is null order by cod_fisc

dia.1103=select distinct tributo, cod_fisc, part_iva, cog_denom, nome, sesso, dt_nsc, des_com_nsc from sit_t_sogg where (des_ind_res is null and id_ext_via_res is null and ind_res_ext is null) or (num_civ_res is null and num_civ_ext is null) order by cog_denom, nome

dia.1104=select tributo, cod_fisc, part_iva, cog_denom, nome, sesso, dt_nsc, des_com_nsc, count(*) as occorrenze from sit_t_sogg group by tributo, cod_fisc, part_iva, cog_denom, nome, sesso, dt_nsc, des_com_nsc having count(*) > 1 order by cog_denom, nome, dt_nsc

dia.1105=select 1 from dual

dia.1106=select 1 from dual

dia.1107=select distinct foglio, numero, sub, cat, cls, val_imm, prc_poss, nvl(sit_t_ici_via.descrizione, sit_t_ici_oggetto.des_ind) || decode(num_civ, null, '', ' ' || num_civ) || decode(esp_civ, null, '', '/' || esp_civ) as indirizzo, num_den, yea_den from sit_t_ici_oggetto, sit_t_ici_via where foglio is null and numero is null and sub is null and sit_t_ici_oggetto.id_ext_via \= sit_t_ici_via.id_ext(+)

dia.1108=select distinct foglio, numero, sub, cat, cls, val_imm, prc_poss, nvl(sit_t_ici_via.descrizione, sit_t_ici_oggetto.des_ind) || decode(num_civ, null, '', ' ' || num_civ) || decode(esp_civ, null, '', '/' || esp_civ) as indirizzo, num_den, yea_den from sit_t_ici_oggetto, sit_t_ici_via where foglio is not null and numero is not null and sub is null and sit_t_ici_oggetto.id_ext_via \= sit_t_ici_via.id_ext(+) order by foglio, numero, yea_den

dia.1109=select distinct foglio, numero, sub, cat, cls, val_imm, prc_poss, nvl(sit_t_ici_via.descrizione, sit_t_ici_oggetto.des_ind) || decode(num_civ, null, '', ' ' || num_civ) || decode(esp_civ, null, '', '/' || esp_civ) as indirizzo, num_den, yea_den from sit_t_ici_oggetto, sit_t_ici_via where ((foglio is not null and translate(foglio, 'A0123456789', 'A') is not null) or (numero is not null and translate(numero, 'A0123456789', 'A') is not null) or (sub is not null and translate (sub, 'A0123456789', 'A') is not null)) and sit_t_ici_oggetto.id_ext_via \= sit_t_ici_via.id_ext(+) order by foglio, numero, yea_den

dia.1110=select distinct foglio, numero, sub, cat, cls, val_imm, prc_poss, nvl(sit_t_ici_via.descrizione, sit_t_ici_oggetto.des_ind) || decode(num_civ, null, '', ' ' || num_civ) || decode(esp_civ, null, '', '/' || esp_civ) as indirizzo, num_den, yea_den from sit_t_ici_oggetto, sit_t_ici_via where (cat is null or val_imm is null) and sit_t_ici_oggetto.id_ext_via \= sit_t_ici_via.id_ext(+) order by foglio, numero, yea_den

dia.1111=select distinct foglio, numero, sub, cat, cls, val_imm, prc_poss, nvl(sit_t_ici_via.descrizione, sit_t_ici_oggetto.des_ind) || decode(num_civ, null, '', ' ' || num_civ) || decode(esp_civ, null, '', '/' || esp_civ) as indirizzo, num_den, yea_den from sit_t_ici_oggetto, sit_t_ici_via where (id_ext_via is null and des_ind is null and num_civ is null) and sit_t_ici_oggetto.id_ext_via \= sit_t_ici_via.id_ext(+) order by foglio, numero, yea_den

dia.1112=select foglio, numero, sub, cat, cls, val_imm, prc_poss, nvl(sit_t_ici_via.descrizione, sit_t_ici_oggetto.des_ind) || decode(num_civ, null, '', ' ' || num_civ) || decode(esp_civ, null, '', '/' || esp_civ) as indirizzo, num_den, yea_den from sit_t_ici_oggetto, sit_t_ici_via where foglio||'_'||numero||'_'||sub in (select distinct foglio||'_'||numero||'_'||sub from(select distinct foglio, numero, sub, count(*) from (select distinct i.foglio, i.numero, i.sub, i.cat FROM sit_t_ici_oggetto i WHERE foglio IS NOT NULL AND numero IS NOT NULL GROUP BY i.foglio, i.numero, i.sub, i.cat) GROUP BY foglio, numero, sub HAVING COUNT (*) > 1)) and sit_t_ici_oggetto.id_ext_via = sit_t_ici_via.id_ext(+) order by foglio, numero, sub, yea_den

dia.1113=select * from (select distinct sit_t_tar_oggetto.foglio, sit_t_tar_oggetto.numero, sit_t_tar_oggetto.sub, sit_t_tar_oggetto.des_cls_rsu, sit_t_tar_oggetto.sup_tot, 'Contribuente' as titolo, sit_t_tar_sogg.cod_fisc, sit_t_tar_sogg.cog_denom, sit_t_tar_sogg.nome, sit_t_tar_sogg.sesso, sit_t_tar_sogg.des_com_nsc, sit_t_tar_sogg.dt_nsc, nvl(sit_t_tar_via.descrizione, sit_t_tar_oggetto.des_ind) || decode(num_civ, null, '', ' ' || num_civ) || decode(esp_civ, null, '', '/' || esp_civ) as indirizzo, sit_t_tar_sogg.ind_res_ext, sit_t_tar_sogg.num_civ_ext \
from sit_t_tar_oggetto, sit_t_tar_sogg, sit_t_tar_contrib, sit_t_tar_via \
where sit_t_tar_contrib.id_ext_ogg_rsu \= sit_t_tar_oggetto.id_ext \
and sit_t_tar_sogg.id_ext \= sit_t_tar_contrib.id_ext_sogg \
and sit_t_tar_oggetto.id_ext_via \= sit_t_tar_via.id_ext(+) \
union all \
select distinct sit_t_tar_oggetto.foglio, sit_t_tar_oggetto.numero, sit_t_tar_oggetto.sub, sit_t_tar_oggetto.des_cls_rsu, sit_t_tar_oggetto.sup_tot, 'Dichiarante' as titolo, sit_t_tar_sogg.cod_fisc, sit_t_tar_sogg.cog_denom, sit_t_tar_sogg.nome, sit_t_tar_sogg.sesso, sit_t_tar_sogg.des_com_nsc, sit_t_tar_sogg.dt_nsc, nvl(sit_t_tar_via.descrizione, sit_t_tar_oggetto.des_ind) || decode(num_civ, null, '', ' ' || num_civ) || decode(esp_civ, null, '', '/' || esp_civ) as indirizzo, sit_t_tar_sogg.ind_res_ext, sit_t_tar_sogg.num_civ_ext \
from sit_t_tar_oggetto, sit_t_tar_sogg, sit_t_tar_dich, sit_t_tar_via \
where sit_t_tar_dich.id_ext_ogg_rsu \= sit_t_tar_oggetto.id_ext \
and sit_t_tar_sogg.id_ext \= sit_t_tar_dich.id_ext_sogg \
and sit_t_tar_oggetto.id_ext_via \= sit_t_tar_via.id_ext(+) \
union all \
select * from (select sit_t_tar_oggetto.foglio, sit_t_tar_oggetto.numero, sit_t_tar_oggetto.sub, sit_t_tar_oggetto.des_cls_rsu, sit_t_tar_oggetto.sup_tot, sit_t_tar_ogg_ultsogg.tit_sogg as titolo, sit_t_tar_sogg.cod_fisc, sit_t_tar_sogg.cog_denom, sit_t_tar_sogg.nome, sit_t_tar_sogg.sesso, sit_t_tar_sogg.des_com_nsc, sit_t_tar_sogg.dt_nsc, nvl(sit_t_tar_via.descrizione, sit_t_tar_oggetto.des_ind) || decode(num_civ, null, '', ' ' || num_civ) || decode(esp_civ, null, '', '/' || esp_civ) as indirizzo, sit_t_tar_sogg.ind_res_ext, sit_t_tar_sogg.num_civ_ext \
from sit_t_tar_oggetto, sit_t_tar_sogg, sit_t_tar_ult_sogg, sit_t_tar_ogg_ultsogg, sit_t_tar_via \
where sit_t_tar_ult_sogg.id_ext_ogg_rsu \= sit_t_tar_oggetto.id_ext \
and sit_t_tar_ogg_ultsogg.id_ext_tar_ult_sogg \= sit_t_tar_ult_sogg.id_ext \
and sit_t_tar_sogg.id_ext \= sit_t_tar_ult_sogg.id_ext_sogg \
and sit_t_tar_oggetto.id_ext_via \= sit_t_tar_via.id_ext(+) \
order by titolo)) \
where foglio is null and numero is null and sub is null \
order by cog_denom, nome

dia.1114=select distinct foglio, numero, sub, des_cls_rsu, sup_tot from sit_t_tar_oggetto where (foglio is not null and translate(foglio, 'A0123456789', 'A') is not null) or (numero is not null and translate(numero, 'A0123456789', 'A') is not null) or (sub is not null and translate(sub, 'A0123456789', 'A') is not null)

dia.1115=select distinct foglio, numero, sub, des_cls_rsu, sup_tot from sit_t_tar_oggetto where id_ext_via is null and des_ind is null and num_civ is null

dia.1116=select distinct cod_fisc, part_iva, cog_denom, nome, sesso, dt_nsc, des_com_nsc from sit_t_sogg where length(cod_fisc) <> 16 and length(cod_fisc) <> 11 order by cog_denom, nome

dia.1117=select distinct cod_fisc, part_iva, cog_denom, nome, sesso, dt_nsc, des_com_nsc from sit_t_sogg where length(cod_fisc) <> 16 and length(cod_fisc) <> 11 and length(part_iva) <> 11 order by cog_denom, nome

dia.1118=select 1 from dual

dia.1301=SELECT DISTINCT i.foglio, i.numero, i.sub, i.cat, i.cls, i.val_imm, nvl(v.descrizione, i.des_ind) || decode(num_civ, null, '', ' ' || num_civ) || decode(esp_civ, null, '', '/' || esp_civ) as indirizzo \
FROM sit_t_ici_oggetto i, sit_t_ici_via v WHERE (foglio IS NOT NULL AND numero IS NOT NULL AND sub IS NOT NULL AND NOT EXISTS (SELECT 1 FROM sitiuiu u WHERE LPAD (TO_CHAR (u.foglio), 5, '0') \= LPAD (i.foglio, 5, '0') AND u.particella \= LPAD (ltrim(i.numero), 5, '0') AND NVL (LPAD (TO_CHAR (u.unimm), 5, '0'), '99*99') \= NVL (LPAD (ltrim(i.sub), 5, '0'), '99*99'))) and i.id_ext_via \= v.id_ext(+)

dia.1302=SELECT DISTINCT u.foglio, \
                u.particella, \
                u.unimm, \
                categoria, \
                classe, \
                rendita \
  FROM sitiuiu u where u.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy') \
  minus \
SELECT DISTINCT u.foglio, \
                u.particella, \
                u.unimm, \
                categoria, \
                classe, \
                rendita \
  FROM sitiuiu u,  sit_t_ici_oggetto i \
 WHERE u.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy') \
       AND LPAD (TO_CHAR (u.foglio), 5, '0') \=  LPAD (TRIM (i.foglio), 5, '0') \
       AND LPAD (TRIM (i.numero), 5, '0') \= u.particella \
       AND NVL (LPAD (TRIM (i.sub), 5, '0'), '99*99') \= NVL (LPAD (TO_CHAR (u.unimm), 5, '0'), '99*99')

dia.1303=SELECT DISTINCT denominazione, cognome, nome, cod_fiscale, part_iva, cuaa FROM (SELECT DISTINCT a.denominazione, a.cognome, a.nome, a.cod_fiscale, a.part_iva, c.cuaa, c.foglio, c.particella, c.unimm \
FROM siticonduz_imm_all c, anag_soggetti a WHERE a.cod_soggetto \= c.pk_cuaa AND a.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy') AND c.data_fine \= TO_DATE ('31/12/9999', 'dd/mm/yyyy') AND NOT EXISTS (SELECT 1 FROM sit_t_ici_sogg s WHERE s.cod_fisc \= a.cod_fiscale) AND NOT EXISTS (SELECT 1 FROM sit_t_ici_sogg s WHERE s.part_iva \= a.part_iva))

dia.1304=SELECT DISTINCT c.cod_fisc, c.part_iva, c.cog_denom, c.nome FROM sit_t_ici_sogg c \
WHERE NOT EXISTS (SELECT 1 FROM anag_soggetti a WHERE a.cod_fiscale \= c.cod_fisc \
AND a.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy')) \
AND NOT EXISTS (SELECT 1 FROM anag_soggetti a WHERE a.part_iva \= c.part_iva \
AND a.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy')) \
AND NOT EXISTS (SELECT 1 FROM anag_soggetti a WHERE a.cognome \= c.cog_denom AND a.nome \= c.nome \
AND a.d_nascita \= c.dt_nsc \
AND a.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy')) \
AND NOT EXISTS (SELECT 1 FROM anag_soggetti a WHERE a.denominazione \= c.cog_denom \
AND a.data_fine_val \= TO_DATE ('31/12/9999', 'dd/mm/yyyy'))

dia.1401=select distinct foglio, particella, sub as denom, unimm as sub, to_char(data_inizio_val,'dd/mm/yyyy') as dt_ini_uiu,\
			categoria, classe, consistenza, rendita, piano, sup_cat, to_number(sup_tarsu_cat) as sup_tarsu_cat,\
			cuaa as cf, denominazione, d_nascita, perc_poss, tipo_titolo as tp_tit, data_inizio as dt_ini_tit,\
			uiu_civ, res, res_civ, prop_part, prop_uiu, tarsu, tarsu_fam, \
			tarsu_tit, f_acq, f_acq_civ, \
			f_enel, f_enel_civ, \
			f_acq_fps, f_enel_fps, \
			locatore, locatari, locatari_tarsu,\
			altri_res_civ, altri_res_tarsu \
			from  sit_rep_tarsu \
			order by foglio, particella, denom, sub

dia.1402=select distinct foglio, particella, sub as denom, unimm as sub, to_char(data_inizio_val,'dd/mm/yyyy') as dt_ini_uiu,categoria, classe, consistenza, rendita, piano, sup_cat, to_number(sup_tarsu_cat) as sup_tarsu_cat,cuaa as cf, denominazione, d_nascita, perc_poss, tipo_titolo as tp_tit, data_inizio as dt_ini_tit,uiu_civ, res, res_civ, prop_part, prop_uiu, tarsu, tarsu_fam,tarsu_tit, f_acq, f_acq_civ, f_enel, f_enel_civ,f_acq_fps, locatore, locatari, locatari_tarsu,altri_res_civ, altri_res_tarsu from  sit_rep_tarsu where res > 0 and (tarsu is null or tarsu\=0) and (tarsu_fam is null or tarsu_fam\=0) and (tarsu_tit is null or tarsu_tit\=0) order by foglio, particella, sub, unimm

dia.1403= SELECT DISTINCT * FROM (SELECT srt.foglio,srt.particella,srt.sub AS denom,srt.unimm AS sub,TO_CHAR (srt.data_inizio_val, 'dd/mm/yyyy') AS dt_ini_uiu,srt.categoria,srt.classe,srt.consistenza,srt.rendita,srt.piano,srt.sup_cat,TO_NUMBER (srt.sup_tarsu_cat) AS sup_tarsu_cat,srt.cuaa AS cf,srt.denominazione,srt.d_nascita,srt.perc_poss,srt.tipo_titolo AS tp_tit,srt.data_inizio AS dt_ini_tit, T.tip_ogg,t.des_tip_ogg,t.des_cls_rsu des_cls_tarsu, t.foglio AS foglio_tarsu,t.numero AS part_tarsu,t.sub AS sub_tarsu,t.sup_tot AS sup_tarsu,t.dat_ini AS dt_ini_ogg,t.dt_inizio_val AS dt_ini_situaz,srt.uiu_civ,srt.res,srt.res_civ,srt.prop_part,srt.prop_uiu,srt.tarsu,srt.tarsu_fam,srt.tarsu_tit,srt.f_acq,srt.f_acq_civ,srt.f_enel,srt.f_enel_civ,srt.locatore,srt.locatari,srt.locatari_tarsu,srt.altri_res_civ,srt.altri_res_tarsu FROM sit_rep_tarsu srt,j_sogg_cat_trib sct,sit_t_tar_sogg s,sit_t_tar_contrib c,sit_t_tar_oggetto t WHERE srt.res > 0 AND srt.prop_part \= 1 AND srt.tarsu > 0 AND sct.id_dwh_a \= srt.pkid AND sct.id_dwh_b \= s.id and s.id_ext \= c.id_ext_sogg AND t.id_ext \= c.id_ext_ogg_rsu AND t.dat_fin IS NULL AND t.dt_fine_val IS NULL AND srt.foglio \= t.foglio AND srt.particella \= LPAD(t.numero, 5, '0') AND srt.unimm \= t.sub UNION SELECT srt.foglio,srt.particella, srt.sub AS denom,srt.unimm AS sub,TO_CHAR (srt.data_inizio_val, 'dd/mm/yyyy') AS dt_ini_uiu,srt.categoria,srt.classe,srt.consistenza,srt.rendita,srt.piano,srt.sup_cat,TO_NUMBER (srt.sup_tarsu_cat) AS sup_tarsu_cat,srt.cuaa AS cf,srt.denominazione,srt.d_nascita,srt.perc_poss,srt.tipo_titolo AS tp_tit,srt.data_inizio AS dt_ini_tit, T.tip_ogg,t.des_tip_ogg,t.des_cls_rsu des_cls_tarsu,t.foglio AS foglio_tarsu,t.numero AS part_tarsu,t.sub AS sub_tarsu,t.sup_tot AS sup_tarsu,t.dat_ini AS dt_ini_ogg,t.dt_inizio_val AS dt_ini_situaz,srt.uiu_civ, srt.res, srt.res_civ,  srt.prop_part, srt.prop_uiu, srt.tarsu, srt.tarsu_fam, srt.tarsu_tit, srt.f_acq, srt.f_acq_civ, srt.f_enel, srt.f_enel_civ, srt.locatore, srt.locatari, srt.locatari_tarsu, srt.altri_res_civ, srt.altri_res_tarsu FROM sit_rep_tarsu srt, j_sogg_cat_trib sct, sit_t_tar_sogg s, sit_t_tar_contrib c, sit_t_tar_oggetto t WHERE   srt.res > 0 AND srt.prop_part \= 1 AND srt.tarsu > 0 AND sct.id_dwh_a \= srt.pkid AND sct.id_dwh_b \= s.id and s.id_ext \= c.id_ext_sogg AND t.id_ext \= c.id_ext_ogg_rsu AND t.dat_fin IS NULL AND t.dt_fine_val IS NULL AND NOT EXISTS (SELECT 1 FROM j_sogg_cat_trib sct, sit_t_tar_contrib c, sit_t_tar_sogg s, sit_t_tar_oggetto t WHERE sct.id_dwh_a \= srt.pkid AND sct.id_dwh_b \= s.id and s.id_ext \= c.id_ext_sogg AND c.id_ext_ogg_rsu \= t.id_ext AND t.dat_fin IS NULL AND t.dt_fine_val IS NULL AND srt.foglio \= t.foglio AND srt.particella \=LPAD(t.numero, 5, '0') AND srt.unimm \= t.sub ))ORDER BY foglio, particella, sub
 
dia.1404=select distinct foglio, particella, sub as denom, unimm as sub, to_char(data_inizio_val,'dd/mm/yyyy') as dt_ini_uiu, categoria, classe, consistenza, rendita, piano, sup_cat, to_number(sup_tarsu_cat) as sup_tarsu_cat,cuaa as cf, denominazione, d_nascita, perc_poss, tipo_titolo as tp_tit, data_inizio as dt_ini_tit,uiu_civ, res, res_civ, prop_part, prop_uiu, tarsu, tarsu_fam,tarsu_tit, f_acq, f_acq_civ, f_enel, f_enel_civ,f_acq_fps, locatore, locatari, locatari_tarsu,altri_res_civ, altri_res_tarsu from  sit_rep_tarsu where (res\=0 or res is null) and (tarsu\=0 or tarsu is null) and (tarsu\=0 or tarsu_fam is null) and (tarsu_tit\=0 or tarsu_tit is null)

dia.1409=SELECT eco_codice_via, strade.specie_strada eco_sedime, strade.nome_strada eco_indirizzo FROM (SELECT DISTINCT ECO.ID_DWH eco_id, eco.CODICE_VIA eco_codice_via, COM.ID_DWH com_id FROM (SELECT * FROM sit_via_totale WHERE FK_ENTE_SORGENTE = '29' AND prog_es = '1') eco LEFT JOIN (SELECT * FROM sit_via_totale WHERE FK_ENTE_SORGENTE = '4' AND PROG_ES = '2') com ON ECO.FK_VIA = COM.FK_VIA), ec_top_strade strade where com_id is null and strade.id = eco_id order by eco_sedime, eco_indirizzo

dia.1410=SELECT com_id, strade.prefisso com_sedime, strade.nome com_indirizzo FROM (SELECT DISTINCT ECO.codice_via eco_codice_via, COM.ID_DWH com_id FROM (SELECT * FROM sit_via_totale WHERE FK_ENTE_SORGENTE = '29' AND prog_es = '1') eco RIGHT JOIN (SELECT *  FROM sit_via_totale WHERE FK_ENTE_SORGENTE = '4' AND PROG_ES = '2') com ON ECO.FK_VIA = COM.FK_VIA), sitidstr strade  WHERE eco_codice_via IS NULL and strade.pkid_stra = com_id ORDER BY com_sedime, com_indirizzo

dia.1411=SELECT eco_stra.codice_strada eco_codice_via,res.eco_id_civico, eco_stra.specie_strada eco_sedime, eco_stra.nome_strada eco_indirizzo, res.eco_civico FROM ( select eco.fk_via fk_via, eco.id_dwh eco_id_civico, ECO.civ_liv1 eco_civico, com.id_dwh com_id_civico, COM.civ_liv1 com_civico FROM (SELECT * FROM sit_civico_totale WHERE FK_ENTE_SORGENTE = '29' AND prog_es = '1') eco LEFT JOIN (SELECT * FROM sit_civico_totale WHERE FK_ENTE_SORGENTE = '4' AND PROG_ES = '2') com ON (ECO.FK_VIA = COM.FK_VIA AND ECO.FK_CIVICO = COM.FK_CIVICO))res, sit_via_totale tot, ec_top_strade eco_stra where com_id_civico is null and eco_stra.id=tot.id_dwh and tot.fk_via = res.fk_via and tot.FK_ENTE_SORGENTE = '29' AND tot.prog_es = '1'

dia.1412=SELECT com_stra.pkid_stra eco_codice_via,res.com_id_civico, com_stra.prefisso eco_sedime, com_stra.nome eco_indirizzo, res.com_civico FROM ( select com.fk_via fk_via, eco.id_dwh eco_id_civico, ECO.civ_liv1 eco_civico, com.id_dwh com_id_civico, COM.civ_liv1 com_civico FROM (SELECT * FROM sit_civico_totale WHERE FK_ENTE_SORGENTE = '29' AND prog_es = '1') eco RIGHT JOIN (SELECT * FROM sit_civico_totale WHERE FK_ENTE_SORGENTE = '4' AND PROG_ES = '2') com ON (ECO.FK_VIA = COM.FK_VIA AND ECO.FK_CIVICO = COM.FK_CIVICO))res, sit_via_totale tot, sitidstr com_stra where eco_id_civico is null and com_stra.pkid_stra=tot.id_dwh and tot.fk_via = res.fk_via and tot.FK_ENTE_SORGENTE = '4' AND tot.prog_es = '2'

dia.1413=select c.com_id_stra, c.com_id_civico, c.com_sedime, c.com_indirizzo,c.com_civico, c.com_barrato, c.eco_id_stra, c.eco_id_civico, c.eco_sedime, c.eco_indirizzo,c.eco_civico, c.eco_barrato, c.com_descr_civico,c.eco_descr_civico,c.distanza from (SELECT indice.*,ss.pkid_stra com_id_stra, ss.prefisso com_sedime, ss.nome com_indirizzo,  es.specie_strada eco_sedime, es.codice_strada eco_id_stra, ES.NOME_STRADA eco_indirizzo, SC.CIVICO com_descr_civico, EC.DESCRIZIONE_CIVICO eco_descr_civico, SDO_GEOM.SDO_DISTANCE (ec.shape, sc.shape, 0.005) AS distanza from siticivi sc, ec_top_civici ec, sitidstr ss, ec_top_strade es, (select distinct  com.id_dwh com_id_civico, LTRIM(com.CIV_LIV1,'0') com_civico, com.CIV_LIV2 com_barrato, ECo.id_dwh eco_id_civico, LTRIM(eco.CIV_LIV1,'0') eco_civico, ECO.CIV_LIV2 eco_barrato  from  sit_civico_totale com, sit_civico_totale eco where ECO.FK_VIA = COM.FK_VIA AND ECO.FK_CIVICO = COM.FK_CIVICO AND NVL(eco.civ_liv2,'0')=NVL(com.civ_liv2,'0') AND NVL(eco.civ_liv3,'0')=NVL(com.civ_liv3,'0') AND eco.FK_ENTE_SORGENTE = '29' and eco.prog_es = '1'  AND com.FK_ENTE_SORGENTE = '4' and com.prog_es = '2'   ) indice where sc.pkid_civi = indice.com_id_civico and ec.id = indice.eco_id_civico and sc.pkid_stra = LTRIM(SUBSTR(EC.FK_STRADE,5),'0') and ss.pkid_stra = sc.pkid_stra and ES.UK_STRADA =ec.fk_strade) c, (SELECT LTRIM(SUBSTR(EC2.FK_STRADE,5),'0') eco_id_stra, indice2.eco_id_civico, EC2.DESCRIZIONE_CIVICO, min(SDO_GEOM.SDO_DISTANCE (ec2.shape, sc2.shape, 0.005)) AS min_distanza from siticivi sc2, ec_top_civici ec2, (select distinct com.id_dwh com_id_civico, LTRIM(com.CIV_LIV1,'0') com_civico, com.CIV_LIV2 com_barrato,  ECo.id_dwh eco_id_civico, LTRIM(eco.CIV_LIV1,'0') eco_civico, ECO.CIV_LIV2 eco_barrato from  sit_civico_totale com, sit_civico_totale eco where ECO.FK_VIA = COM.FK_VIA AND ECO.FK_CIVICO = COM.FK_CIVICO AND NVL(eco.civ_liv2,'0')=NVL(com.civ_liv2,'0') AND NVL(eco.civ_liv3,'0')=NVL(com.civ_liv3,'0') AND eco.FK_ENTE_SORGENTE = '29' and eco.prog_es = '1' AND com.FK_ENTE_SORGENTE = '4' and com.prog_es = '2')indice2 where sc2.pkid_civi = indice2.com_id_civico and ec2.id = indice2.eco_id_civico and sc2.pkid_stra = LTRIM(SUBSTR(EC2.FK_STRADE,5),'0') group by LTRIM(SUBSTR(EC2.FK_STRADE,5),'0'), indice2.eco_id_civico, EC2.DESCRIZIONE_CIVICO) md where md.eco_id_stra= c.eco_id_stra and md.eco_id_civico= c.eco_id_civico and c.distanza = md.min_distanza and c.distanza > 1 order by eco_id_stra, eco_descr_civico, distanza

dia.1414=select 1 from dual

dia.1416=select distinct conc.id as id_concessione, conc.protocollo_data, conc.protocollo_numero, CONC.PROGRESSIVO_NUMERO, CONC.PROGRESSIVO_ANNO, conc.tipo_intervento, conc.oggetto, cc.sezione, cc.foglio, cc.particella, ind.sedime, ind.indirizzo, IND.CIV_LIV1 as CIVICO from sit_c_concessioni conc left join sit_c_concessioni_catasto cc on (CONC.ID_EXT \= CC.ID_EXT_C_CONCESSIONI) left join sit_c_conc_indirizzi ind on (CONC.ID_EXT \= IND.ID_EXT_C_CONCESSIONI) where conc.id not in (select distinct c.id from sit_fabbricato_totale fab1, sit_fabbricato_totale fab2 , sit_c_concessioni_catasto cc, sit_c_concessioni c where FAB1.FK_ENTE_SORGENTE \= '3' and FAB1.PROG_ES\='2' and FAB2.FK_ENTE_SORGENTE\='4' and FAB2.PROG_ES\='1' and FAB1.FK_FABBRICATO\=FAB2.FK_FABBRICATO and FAB1.ID_DWH\=CC.ID and CC.ID_EXT_C_CONCESSIONI\=C.ID_EXT union  select distinct CIV1.ID_DWH from sit_civico_totale CIV1, sit_civico_totale CIV2 where CIV1.FK_ENTE_SORGENTE \= '3' and CIV1.PROG_ES\='2' and CIV2.FK_ENTE_SORGENTE\='4' and CIV2.PROG_ES\='2' and CIV1.FK_CIVICO\=CIV2.FK_CIVICO) 

dia.1417=SELECT  tar.id AS idTarsu,tar.sez AS sezione,tar.foglio,tar.numero,IND.DESCRIZIONE AS indirizzo,tar.num_civ AS civico,TAR.DES_TIP_OGG AS oggetto,tar.des_cls_rsu AS classe,tar.dat_ini,tar.dat_fin FROM sit_t_tar_oggetto tar LEFT JOIN sit_t_tar_via ind ON (ind.id_ext \= tar.id_ext_via) WHERE tar.id NOT IN (SELECT tot.id_dwh AS id FROM sit_fabbricato_totale tot, sit_fabbricato_totale totCorr WHERE     tot.FK_ENTE_SORGENTE \= '2' AND TOT.PROG_ES \= '3' AND TOTCORR.FK_ENTE_SORGENTE \= '4' AND TOTCORR.PROG_ES \= '1' AND TOT.FK_FABBRICATO \= TOTCORR.FK_FABBRICATO UNION SELECT icio.id AS id FROM SIT_T_TAR_OGGETTO icio INNER JOIN SIT_T_TAR_VIA iciv ON (icio.ID_EXT_VIA \= iciv.ID_EXT ), sit_civico_totale totCiv, sit_civico_totale totCivCorr where totciv.FK_ENTE_SORGENTE\= '2' AND TOTciv.PROG_ES\= '3' AND TOTCivCORR.FK_ENTE_SORGENTE\= '4' AND TOTCivCORR.PROG_ES\= '2' AND TOTCiv.FK_CIVICO\=TOTCivCORR.FK_CIVICO  and iciv.ID || '|' || NVL(icio.NUM_CIV, '') || '|' || NVL(icio.ESP_CIV, '')\=totCiv.ID_dwh)
# va a scrivere		
#dia.112.template=C:/TEST/DiagnosticheExport/Modelli/template.xls
#dia.3.template=C:/TEST/DiagnosticheExport/Modelli/template.xls
